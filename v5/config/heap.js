/*! For license information please see heap.js.LICENSE.txt */
!function(){var e={571:function(e,t,n){var r;e=n.nmd(e);var i=n(952);(function(){var a,o="Expected a function",u="__lodash_hash_undefined__",s="__lodash_placeholder__",c=16,f=32,l=64,d=128,v=256,p=1/0,h=9007199254740991,g=NaN,m=4294967295,y=[["ary",d],["bind",1],["bindKey",2],["curry",8],["curryRight",c],["flip",512],["partial",f],["partialRight",l],["rearg",v]],w="[object Arguments]",b="[object Array]",_="[object Boolean]",I="[object Date]",k="[object Error]",S="[object Function]",E="[object GeneratorFunction]",O="[object Map]",T="[object Number]",A="[object Object]",P="[object Promise]",N="[object RegExp]",R="[object Set]",j="[object String]",C="[object Symbol]",B="[object WeakMap]",x="[object ArrayBuffer]",D="[object DataView]",M="[object Float32Array]",L="[object Float64Array]",U="[object Int8Array]",F="[object Int16Array]",J="[object Int32Array]",q="[object Uint8Array]",V="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",K=/\b__p \+= '';/g,Q=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,G=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,$=RegExp(G.source),X=RegExp(Y.source),Z=/<%-([\s\S]+?)%>/g,ee=/<%([\s\S]+?)%>/g,te=/<%=([\s\S]+?)%>/g,ne=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,re=/^\w*$/,ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ae=/[\\^$.*+?()[\]{}|]/g,oe=RegExp(ae.source),ue=/^\s+/,se=/\s/,ce=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,fe=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,de=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ve=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ge=/\w*$/,me=/^[-+]0x[0-9a-f]+$/i,ye=/^0b[01]+$/i,we=/^\[object .+?Constructor\]$/,be=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,Ie=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ke=/($^)/,Se=/['\n\r\u2028\u2029\\]/g,Ee="\\ud800-\\udfff",Oe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Te="\\u2700-\\u27bf",Ae="a-z\\xdf-\\xf6\\xf8-\\xff",Pe="A-Z\\xc0-\\xd6\\xd8-\\xde",Ne="\\ufe0e\\ufe0f",Re="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",je="['’]",Ce="["+Ee+"]",Be="["+Re+"]",xe="["+Oe+"]",De="\\d+",Me="["+Te+"]",Le="["+Ae+"]",Ue="[^"+Ee+Re+De+Te+Ae+Pe+"]",Fe="\\ud83c[\\udffb-\\udfff]",Je="[^"+Ee+"]",qe="(?:\\ud83c[\\udde6-\\uddff]){2}",Ve="[\\ud800-\\udbff][\\udc00-\\udfff]",ze="["+Pe+"]",He="\\u200d",Ke="(?:"+Le+"|"+Ue+")",Qe="(?:"+ze+"|"+Ue+")",We="(?:['’](?:d|ll|m|re|s|t|ve))?",Ge="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ye="(?:"+xe+"|"+Fe+")"+"?",$e="["+Ne+"]?",Xe=$e+Ye+("(?:"+He+"(?:"+[Je,qe,Ve].join("|")+")"+$e+Ye+")*"),Ze="(?:"+[Me,qe,Ve].join("|")+")"+Xe,et="(?:"+[Je+xe+"?",xe,qe,Ve,Ce].join("|")+")",tt=RegExp(je,"g"),nt=RegExp(xe,"g"),rt=RegExp(Fe+"(?="+Fe+")|"+et+Xe,"g"),it=RegExp([ze+"?"+Le+"+"+We+"(?="+[Be,ze,"$"].join("|")+")",Qe+"+"+Ge+"(?="+[Be,ze+Ke,"$"].join("|")+")",ze+"?"+Ke+"+"+We,ze+"+"+Ge,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",De,Ze].join("|"),"g"),at=RegExp("["+He+Ee+Oe+Ne+"]"),ot=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ut=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],st=-1,ct={};ct[M]=ct[L]=ct[U]=ct[F]=ct[J]=ct[q]=ct[V]=ct[z]=ct[H]=!0,ct[w]=ct[b]=ct[x]=ct[_]=ct[D]=ct[I]=ct[k]=ct[S]=ct[O]=ct[T]=ct[A]=ct[N]=ct[R]=ct[j]=ct[B]=!1;var ft={};ft[w]=ft[b]=ft[x]=ft[D]=ft[_]=ft[I]=ft[M]=ft[L]=ft[U]=ft[F]=ft[J]=ft[O]=ft[T]=ft[A]=ft[N]=ft[R]=ft[j]=ft[C]=ft[q]=ft[V]=ft[z]=ft[H]=!0,ft[k]=ft[S]=ft[B]=!1;var lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},dt=parseFloat,vt=parseInt,pt="object"==(void 0===n.g?"undefined":i(n.g))&&n.g&&n.g.Object===Object&&n.g,ht="object"==("undefined"==typeof self?"undefined":i(self))&&self&&self.Object===Object&&self,gt=pt||ht||Function("return this")(),mt="object"==i(t)&&t&&!t.nodeType&&t,yt=mt&&"object"==i(e)&&e&&!e.nodeType&&e,wt=yt&&yt.exports===mt,bt=wt&&pt.process,_t=function(){try{var e=yt&&yt.require&&yt.require("util").types;return e||bt&&bt.binding&&bt.binding("util")}catch(e){}}(),It=_t&&_t.isArrayBuffer,kt=_t&&_t.isDate,St=_t&&_t.isMap,Et=_t&&_t.isRegExp,Ot=_t&&_t.isSet,Tt=_t&&_t.isTypedArray;function At(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Pt(e,t,n,r){for(var i=-1,a=null==e?0:e.length;++i<a;){var o=e[i];t(r,o,n(o),e)}return r}function Nt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Rt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function jt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Ct(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}function Bt(e,t){return!!(null==e?0:e.length)&&zt(e,t,0)>-1}function xt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Dt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Mt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Lt(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n}function Ut(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Ft(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Jt=Wt("length");function qt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Vt(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}function zt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Vt(e,Kt,n)}function Ht(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return-1}function Kt(e){return e!=e}function Qt(e,t){var n=null==e?0:e.length;return n?$t(e,t)/n:g}function Wt(e){return function(t){return null==t?a:t[e]}}function Gt(e){return function(t){return null==e?a:e[t]}}function Yt(e,t,n,r,i){return i(e,(function(e,i,a){n=r?(r=!1,e):t(n,e,i,a)})),n}function $t(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==a&&(n=n===a?o:n+o)}return n}function Xt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Zt(e){return e?e.slice(0,mn(e)+1).replace(ue,""):e}function en(e){return function(t){return e(t)}}function tn(e,t){return Dt(t,(function(t){return e[t]}))}function nn(e,t){return e.has(t)}function rn(e,t){for(var n=-1,r=e.length;++n<r&&zt(t,e[n],0)>-1;);return n}function an(e,t){for(var n=e.length;n--&&zt(t,e[n],0)>-1;);return n}var on=Gt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),un=Gt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function sn(e){return"\\"+lt[e]}function cn(e){return at.test(e)}function fn(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function dn(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n];o!==t&&o!==s||(e[n]=s,a[i++]=n)}return a}function vn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function pn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function hn(e){return cn(e)?function(e){var t=rt.lastIndex=0;for(;rt.test(e);)++t;return t}(e):Jt(e)}function gn(e){return cn(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.split("")}(e)}function mn(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}var yn=Gt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var wn=function e(t){var n,r=(t=null==t?gt:wn.defaults(gt.Object(),t,wn.pick(gt,ut))).Array,se=t.Date,Ee=t.Error,Oe=t.Function,Te=t.Math,Ae=t.Object,Pe=t.RegExp,Ne=t.String,Re=t.TypeError,je=r.prototype,Ce=Oe.prototype,Be=Ae.prototype,xe=t["__core-js_shared__"],De=Ce.toString,Me=Be.hasOwnProperty,Le=0,Ue=(n=/[^.]+$/.exec(xe&&xe.keys&&xe.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Fe=Be.toString,Je=De.call(Ae),qe=gt._,Ve=Pe("^"+De.call(Me).replace(ae,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ze=wt?t.Buffer:a,He=t.Symbol,Ke=t.Uint8Array,Qe=ze?ze.allocUnsafe:a,We=ln(Ae.getPrototypeOf,Ae),Ge=Ae.create,Ye=Be.propertyIsEnumerable,$e=je.splice,Xe=He?He.isConcatSpreadable:a,Ze=He?He.iterator:a,et=He?He.toStringTag:a,rt=function(){try{var e=va(Ae,"defineProperty");return e({},"",{}),e}catch(e){}}(),at=t.clearTimeout!==gt.clearTimeout&&t.clearTimeout,lt=se&&se.now!==gt.Date.now&&se.now,pt=t.setTimeout!==gt.setTimeout&&t.setTimeout,ht=Te.ceil,mt=Te.floor,yt=Ae.getOwnPropertySymbols,bt=ze?ze.isBuffer:a,_t=t.isFinite,Jt=je.join,Gt=ln(Ae.keys,Ae),bn=Te.max,_n=Te.min,In=se.now,kn=t.parseInt,Sn=Te.random,En=je.reverse,On=va(t,"DataView"),Tn=va(t,"Map"),An=va(t,"Promise"),Pn=va(t,"Set"),Nn=va(t,"WeakMap"),Rn=va(Ae,"create"),jn=Nn&&new Nn,Cn={},Bn=Ua(On),xn=Ua(Tn),Dn=Ua(An),Mn=Ua(Pn),Ln=Ua(Nn),Un=He?He.prototype:a,Fn=Un?Un.valueOf:a,Jn=Un?Un.toString:a;function qn(e){if(ru(e)&&!Ko(e)&&!(e instanceof Kn)){if(e instanceof Hn)return e;if(Me.call(e,"__wrapped__"))return Fa(e)}return new Hn(e)}var Vn=function(){function e(){}return function(t){if(!nu(t))return{};if(Ge)return Ge(t);e.prototype=t;var n=new e;return e.prototype=a,n}}();function zn(){}function Hn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=a}function Kn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=m,this.__views__=[]}function Qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Gn;++t<n;)this.add(e[t])}function $n(e){var t=this.__data__=new Wn(e);this.size=t.size}function Xn(e,t){var n=Ko(e),r=!n&&Ho(e),i=!n&&!r&&Yo(e),a=!n&&!r&&!i&&lu(e),o=n||r||i||a,u=o?Xt(e.length,Ne):[],s=u.length;for(var c in e)!t&&!Me.call(e,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ba(c,s))||u.push(c);return u}function Zn(e){var t=e.length;return t?e[Yr(0,t-1)]:a}function er(e,t){return Da(Ri(e),cr(t,0,e.length))}function tr(e){return Da(Ri(e))}function nr(e,t,n){(n!==a&&!qo(e[t],n)||n===a&&!(t in e))&&ur(e,t,n)}function rr(e,t,n){var r=e[t];Me.call(e,t)&&qo(r,n)&&(n!==a||t in e)||ur(e,t,n)}function ir(e,t){for(var n=e.length;n--;)if(qo(e[n][0],t))return n;return-1}function ar(e,t,n,r){return pr(e,(function(e,i,a){t(r,e,n(e),a)})),r}function or(e,t){return e&&ji(t,Cu(t),e)}function ur(e,t,n){"__proto__"==t&&rt?rt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function sr(e,t){for(var n=-1,i=t.length,o=r(i),u=null==e;++n<i;)o[n]=u?a:Au(e,t[n]);return o}function cr(e,t,n){return e==e&&(n!==a&&(e=e<=n?e:n),t!==a&&(e=e>=t?e:t)),e}function fr(e,t,n,r,i,o){var u,s=1&t,c=2&t,f=4&t;if(n&&(u=i?n(e,r,i,o):n(e)),u!==a)return u;if(!nu(e))return e;var l=Ko(e);if(l){if(u=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Me.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!s)return Ri(e,u)}else{var d=ga(e),v=d==S||d==E;if(Yo(e))return Ei(e,s);if(d==A||d==w||v&&!i){if(u=c||v?{}:ya(e),!s)return c?function(e,t){return ji(e,ha(e),t)}(e,function(e,t){return e&&ji(t,Bu(t),e)}(u,e)):function(e,t){return ji(e,pa(e),t)}(e,or(u,e))}else{if(!ft[d])return i?e:{};u=function(e,t,n){var r=e.constructor;switch(t){case x:return Oi(e);case _:case I:return new r(+e);case D:return function(e,t){var n=t?Oi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case M:case L:case U:case F:case J:case q:case V:case z:case H:return Ti(e,n);case O:return new r;case T:case j:return new r(e);case N:return function(e){var t=new e.constructor(e.source,ge.exec(e));return t.lastIndex=e.lastIndex,t}(e);case R:return new r;case C:return i=e,Fn?Ae(Fn.call(i)):{}}var i}(e,d,s)}}o||(o=new $n);var p=o.get(e);if(p)return p;o.set(e,u),su(e)?e.forEach((function(r){u.add(fr(r,t,n,r,e,o))})):iu(e)&&e.forEach((function(r,i){u.set(i,fr(r,t,n,i,e,o))}));var h=l?a:(f?c?oa:aa:c?Bu:Cu)(e);return Nt(h||e,(function(r,i){h&&(r=e[i=r]),rr(u,i,fr(r,t,n,i,e,o))})),u}function lr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Ae(e);r--;){var i=n[r],o=t[i],u=e[i];if(u===a&&!(i in e)||!o(u))return!1}return!0}function dr(e,t,n){if("function"!=typeof e)throw new Re(o);return ja((function(){e.apply(a,n)}),t)}function vr(e,t,n,r){var i=-1,a=Bt,o=!0,u=e.length,s=[],c=t.length;if(!u)return s;n&&(t=Dt(t,en(n))),r?(a=xt,o=!1):t.length>=200&&(a=nn,o=!1,t=new Yn(t));e:for(;++i<u;){var f=e[i],l=null==n?f:n(f);if(f=r||0!==f?f:0,o&&l==l){for(var d=c;d--;)if(t[d]===l)continue e;s.push(f)}else a(t,l,r)||s.push(f)}return s}qn.templateSettings={escape:Z,evaluate:ee,interpolate:te,variable:"",imports:{_:qn}},qn.prototype=zn.prototype,qn.prototype.constructor=qn,Hn.prototype=Vn(zn.prototype),Hn.prototype.constructor=Hn,Kn.prototype=Vn(zn.prototype),Kn.prototype.constructor=Kn,Qn.prototype.clear=function(){this.__data__=Rn?Rn(null):{},this.size=0},Qn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Qn.prototype.get=function(e){var t=this.__data__;if(Rn){var n=t[e];return n===u?a:n}return Me.call(t,e)?t[e]:a},Qn.prototype.has=function(e){var t=this.__data__;return Rn?t[e]!==a:Me.call(t,e)},Qn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rn&&t===a?u:t,this},Wn.prototype.clear=function(){this.__data__=[],this.size=0},Wn.prototype.delete=function(e){var t=this.__data__,n=ir(t,e);return!(n<0)&&(n==t.length-1?t.pop():$e.call(t,n,1),--this.size,!0)},Wn.prototype.get=function(e){var t=this.__data__,n=ir(t,e);return n<0?a:t[n][1]},Wn.prototype.has=function(e){return ir(this.__data__,e)>-1},Wn.prototype.set=function(e,t){var n=this.__data__,r=ir(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Gn.prototype.clear=function(){this.size=0,this.__data__={hash:new Qn,map:new(Tn||Wn),string:new Qn}},Gn.prototype.delete=function(e){var t=la(this,e).delete(e);return this.size-=t?1:0,t},Gn.prototype.get=function(e){return la(this,e).get(e)},Gn.prototype.has=function(e){return la(this,e).has(e)},Gn.prototype.set=function(e,t){var n=la(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Yn.prototype.add=Yn.prototype.push=function(e){return this.__data__.set(e,u),this},Yn.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.clear=function(){this.__data__=new Wn,this.size=0},$n.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},$n.prototype.get=function(e){return this.__data__.get(e)},$n.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Wn){var r=n.__data__;if(!Tn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Gn(r)}return n.set(e,t),this.size=n.size,this};var pr=xi(Ir),hr=xi(kr,!0);function gr(e,t){var n=!0;return pr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function mr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],u=t(o);if(null!=u&&(s===a?u==u&&!fu(u):n(u,s)))var s=u,c=o}return c}function yr(e,t){var n=[];return pr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function wr(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=wa),i||(i=[]);++a<o;){var u=e[a];t>0&&n(u)?t>1?wr(u,t-1,n,r,i):Mt(i,u):r||(i[i.length]=u)}return i}var br=Di(),_r=Di(!0);function Ir(e,t){return e&&br(e,t,Cu)}function kr(e,t){return e&&_r(e,t,Cu)}function Sr(e,t){return Ct(t,(function(t){return Zo(e[t])}))}function Er(e,t){for(var n=0,r=(t=_i(t,e)).length;null!=e&&n<r;)e=e[La(t[n++])];return n&&n==r?e:a}function Or(e,t,n){var r=t(e);return Ko(e)?r:Mt(r,n(e))}function Tr(e){return null==e?e===a?"[object Undefined]":"[object Null]":et&&et in Ae(e)?function(e){var t=Me.call(e,et),n=e[et];try{e[et]=a;var r=!0}catch(e){}var i=Fe.call(e);r&&(t?e[et]=n:delete e[et]);return i}(e):function(e){return Fe.call(e)}(e)}function Ar(e,t){return e>t}function Pr(e,t){return null!=e&&Me.call(e,t)}function Nr(e,t){return null!=e&&t in Ae(e)}function Rr(e,t,n){for(var i=n?xt:Bt,o=e[0].length,u=e.length,s=u,c=r(u),f=1/0,l=[];s--;){var d=e[s];s&&t&&(d=Dt(d,en(t))),f=_n(d.length,f),c[s]=!n&&(t||o>=120&&d.length>=120)?new Yn(s&&d):a}d=e[0];var v=-1,p=c[0];e:for(;++v<o&&l.length<f;){var h=d[v],g=t?t(h):h;if(h=n||0!==h?h:0,!(p?nn(p,g):i(l,g,n))){for(s=u;--s;){var m=c[s];if(!(m?nn(m,g):i(e[s],g,n)))continue e}p&&p.push(g),l.push(h)}}return l}function jr(e,t,n){var r=null==(e=Pa(e,t=_i(t,e)))?e:e[La($a(t))];return null==r?a:At(r,e,n)}function Cr(e){return ru(e)&&Tr(e)==w}function Br(e,t,n,r,i){return e===t||(null==e||null==t||!ru(e)&&!ru(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var u=Ko(e),s=Ko(t),c=u?b:ga(e),f=s?b:ga(t),l=(c=c==w?A:c)==A,d=(f=f==w?A:f)==A,v=c==f;if(v&&Yo(e)){if(!Yo(t))return!1;u=!0,l=!1}if(v&&!l)return o||(o=new $n),u||lu(e)?ra(e,t,n,r,i,o):function(e,t,n,r,i,a,o){switch(n){case D:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case x:return!(e.byteLength!=t.byteLength||!a(new Ke(e),new Ke(t)));case _:case I:case T:return qo(+e,+t);case k:return e.name==t.name&&e.message==t.message;case N:case j:return e==t+"";case O:var u=fn;case R:var s=1&r;if(u||(u=vn),e.size!=t.size&&!s)return!1;var c=o.get(e);if(c)return c==t;r|=2,o.set(e,t);var f=ra(u(e),u(t),r,i,a,o);return o.delete(e),f;case C:if(Fn)return Fn.call(e)==Fn.call(t)}return!1}(e,t,c,n,r,i,o);if(!(1&n)){var p=l&&Me.call(e,"__wrapped__"),h=d&&Me.call(t,"__wrapped__");if(p||h){var g=p?e.value():e,m=h?t.value():t;return o||(o=new $n),i(g,m,n,r,o)}}if(!v)return!1;return o||(o=new $n),function(e,t,n,r,i,o){var u=1&n,s=aa(e),c=s.length,f=aa(t),l=f.length;if(c!=l&&!u)return!1;var d=c;for(;d--;){var v=s[d];if(!(u?v in t:Me.call(t,v)))return!1}var p=o.get(e),h=o.get(t);if(p&&h)return p==t&&h==e;var g=!0;o.set(e,t),o.set(t,e);var m=u;for(;++d<c;){var y=e[v=s[d]],w=t[v];if(r)var b=u?r(w,y,v,t,e,o):r(y,w,v,e,t,o);if(!(b===a?y===w||i(y,w,n,r,o):b)){g=!1;break}m||(m="constructor"==v)}if(g&&!m){var _=e.constructor,I=t.constructor;_==I||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof I&&I instanceof I||(g=!1)}return o.delete(e),o.delete(t),g}(e,t,n,r,i,o)}(e,t,n,r,Br,i))}function xr(e,t,n,r){var i=n.length,o=i,u=!r;if(null==e)return!o;for(e=Ae(e);i--;){var s=n[i];if(u&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var c=(s=n[i])[0],f=e[c],l=s[1];if(u&&s[2]){if(f===a&&!(c in e))return!1}else{var d=new $n;if(r)var v=r(f,l,c,e,t,d);if(!(v===a?Br(l,f,3,r,d):v))return!1}}return!0}function Dr(e){return!(!nu(e)||(t=e,Ue&&Ue in t))&&(Zo(e)?Ve:we).test(Ua(e));var t}function Mr(e){return"function"==typeof e?e:null==e?as:"object"==i(e)?Ko(e)?Vr(e[0],e[1]):qr(e):ps(e)}function Lr(e){if(!Ea(e))return Gt(e);var t=[];for(var n in Ae(e))Me.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ur(e){if(!nu(e))return function(e){var t=[];if(null!=e)for(var n in Ae(e))t.push(n);return t}(e);var t=Ea(e),n=[];for(var r in e)("constructor"!=r||!t&&Me.call(e,r))&&n.push(r);return n}function Fr(e,t){return e<t}function Jr(e,t){var n=-1,i=Wo(e)?r(e.length):[];return pr(e,(function(e,r,a){i[++n]=t(e,r,a)})),i}function qr(e){var t=da(e);return 1==t.length&&t[0][2]?Ta(t[0][0],t[0][1]):function(n){return n===e||xr(n,e,t)}}function Vr(e,t){return Ia(e)&&Oa(t)?Ta(La(e),t):function(n){var r=Au(n,e);return r===a&&r===t?Pu(n,e):Br(t,r,3)}}function zr(e,t,n,r,i){e!==t&&br(t,(function(o,u){if(i||(i=new $n),nu(o))!function(e,t,n,r,i,o,u){var s=Na(e,n),c=Na(t,n),f=u.get(c);if(f)return void nr(e,n,f);var l=o?o(s,c,n+"",e,t,u):a,d=l===a;if(d){var v=Ko(c),p=!v&&Yo(c),h=!v&&!p&&lu(c);l=c,v||p||h?Ko(s)?l=s:Go(s)?l=Ri(s):p?(d=!1,l=Ei(c,!0)):h?(d=!1,l=Ti(c,!0)):l=[]:ou(c)||Ho(c)?(l=s,Ho(s)?l=wu(s):nu(s)&&!Zo(s)||(l=ya(c))):d=!1}d&&(u.set(c,l),i(l,c,r,o,u),u.delete(c));nr(e,n,l)}(e,t,u,n,zr,r,i);else{var s=r?r(Na(e,u),o,u+"",e,t,i):a;s===a&&(s=o),nr(e,u,s)}}),Bu)}function Hr(e,t){var n=e.length;if(n)return ba(t+=t<0?n:0,n)?e[t]:a}function Kr(e,t,n){t=t.length?Dt(t,(function(e){return Ko(e)?function(t){return Er(t,1===e.length?e[0]:e)}:e})):[as];var r=-1;t=Dt(t,en(fa()));var i=Jr(e,(function(e,n,i){var a=Dt(t,(function(t){return t(e)}));return{criteria:a,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,a=t.criteria,o=i.length,u=n.length;for(;++r<o;){var s=Ai(i[r],a[r]);if(s)return r>=u?s:s*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Qr(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],u=Er(e,o);n(u,o)&&ti(a,_i(o,e),u)}return a}function Wr(e,t,n,r){var i=r?Ht:zt,a=-1,o=t.length,u=e;for(e===t&&(t=Ri(t)),n&&(u=Dt(e,en(n)));++a<o;)for(var s=0,c=t[a],f=n?n(c):c;(s=i(u,f,s,r))>-1;)u!==e&&$e.call(u,s,1),$e.call(e,s,1);return e}function Gr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==a){var a=i;ba(i)?$e.call(e,i,1):vi(e,i)}}return e}function Yr(e,t){return e+mt(Sn()*(t-e+1))}function $r(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=mt(t/2))&&(e+=e)}while(t);return n}function Xr(e,t){return Ca(Aa(e,t,as),e+"")}function Zr(e){return Zn(qu(e))}function ei(e,t){var n=qu(e);return Da(n,cr(t,0,n.length))}function ti(e,t,n,r){if(!nu(e))return e;for(var i=-1,o=(t=_i(t,e)).length,u=o-1,s=e;null!=s&&++i<o;){var c=La(t[i]),f=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=u){var l=s[c];(f=r?r(l,c,s):a)===a&&(f=nu(l)?l:ba(t[i+1])?[]:{})}rr(s,c,f),s=s[c]}return e}var ni=jn?function(e,t){return jn.set(e,t),e}:as,ri=rt?function(e,t){return rt(e,"toString",{configurable:!0,enumerable:!1,value:ns(t),writable:!0})}:as;function ii(e){return Da(qu(e))}function ai(e,t,n){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var o=r(a);++i<a;)o[i]=e[i+t];return o}function oi(e,t){var n;return pr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ui(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var a=r+i>>>1,o=e[a];null!==o&&!fu(o)&&(n?o<=t:o<t)?r=a+1:i=a}return i}return si(e,t,as,n)}function si(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var u=(t=n(t))!=t,s=null===t,c=fu(t),f=t===a;i<o;){var l=mt((i+o)/2),d=n(e[l]),v=d!==a,p=null===d,h=d==d,g=fu(d);if(u)var m=r||h;else m=f?h&&(r||v):s?h&&v&&(r||!p):c?h&&v&&!p&&(r||!g):!p&&!g&&(r?d<=t:d<t);m?i=l+1:o=l}return _n(o,4294967294)}function ci(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n],u=t?t(o):o;if(!n||!qo(u,s)){var s=u;a[i++]=0===o?0:o}}return a}function fi(e){return"number"==typeof e?e:fu(e)?g:+e}function li(e){if("string"==typeof e)return e;if(Ko(e))return Dt(e,li)+"";if(fu(e))return Jn?Jn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function di(e,t,n){var r=-1,i=Bt,a=e.length,o=!0,u=[],s=u;if(n)o=!1,i=xt;else if(a>=200){var c=t?null:$i(e);if(c)return vn(c);o=!1,i=nn,s=new Yn}else s=t?[]:u;e:for(;++r<a;){var f=e[r],l=t?t(f):f;if(f=n||0!==f?f:0,o&&l==l){for(var d=s.length;d--;)if(s[d]===l)continue e;t&&s.push(l),u.push(f)}else i(s,l,n)||(s!==u&&s.push(l),u.push(f))}return u}function vi(e,t){return null==(e=Pa(e,t=_i(t,e)))||delete e[La($a(t))]}function pi(e,t,n,r){return ti(e,t,n(Er(e,t)),r)}function hi(e,t,n,r){for(var i=e.length,a=r?i:-1;(r?a--:++a<i)&&t(e[a],a,e););return n?ai(e,r?0:a,r?a+1:i):ai(e,r?a+1:0,r?i:a)}function gi(e,t){var n=e;return n instanceof Kn&&(n=n.value()),Lt(t,(function(e,t){return t.func.apply(t.thisArg,Mt([e],t.args))}),n)}function mi(e,t,n){var i=e.length;if(i<2)return i?di(e[0]):[];for(var a=-1,o=r(i);++a<i;)for(var u=e[a],s=-1;++s<i;)s!=a&&(o[a]=vr(o[a]||u,e[s],t,n));return di(wr(o,1),t,n)}function yi(e,t,n){for(var r=-1,i=e.length,o=t.length,u={};++r<i;){var s=r<o?t[r]:a;n(u,e[r],s)}return u}function wi(e){return Go(e)?e:[]}function bi(e){return"function"==typeof e?e:as}function _i(e,t){return Ko(e)?e:Ia(e,t)?[e]:Ma(bu(e))}var Ii=Xr;function ki(e,t,n){var r=e.length;return n=n===a?r:n,!t&&n>=r?e:ai(e,t,n)}var Si=at||function(e){return gt.clearTimeout(e)};function Ei(e,t){if(t)return e.slice();var n=e.length,r=Qe?Qe(n):new e.constructor(n);return e.copy(r),r}function Oi(e){var t=new e.constructor(e.byteLength);return new Ke(t).set(new Ke(e)),t}function Ti(e,t){var n=t?Oi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ai(e,t){if(e!==t){var n=e!==a,r=null===e,i=e==e,o=fu(e),u=t!==a,s=null===t,c=t==t,f=fu(t);if(!s&&!f&&!o&&e>t||o&&u&&c&&!s&&!f||r&&u&&c||!n&&c||!i)return 1;if(!r&&!o&&!f&&e<t||f&&n&&i&&!r&&!o||s&&n&&i||!u&&i||!c)return-1}return 0}function Pi(e,t,n,i){for(var a=-1,o=e.length,u=n.length,s=-1,c=t.length,f=bn(o-u,0),l=r(c+f),d=!i;++s<c;)l[s]=t[s];for(;++a<u;)(d||a<o)&&(l[n[a]]=e[a]);for(;f--;)l[s++]=e[a++];return l}function Ni(e,t,n,i){for(var a=-1,o=e.length,u=-1,s=n.length,c=-1,f=t.length,l=bn(o-s,0),d=r(l+f),v=!i;++a<l;)d[a]=e[a];for(var p=a;++c<f;)d[p+c]=t[c];for(;++u<s;)(v||a<o)&&(d[p+n[u]]=e[a++]);return d}function Ri(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function ji(e,t,n,r){var i=!n;n||(n={});for(var o=-1,u=t.length;++o<u;){var s=t[o],c=r?r(n[s],e[s],s,n,e):a;c===a&&(c=e[s]),i?ur(n,s,c):rr(n,s,c)}return n}function Ci(e,t){return function(n,r){var i=Ko(n)?Pt:ar,a=t?t():{};return i(n,e,fa(r,2),a)}}function Bi(e){return Xr((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:a,u=i>2?n[2]:a;for(o=e.length>3&&"function"==typeof o?(i--,o):a,u&&_a(n[0],n[1],u)&&(o=i<3?a:o,i=1),t=Ae(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}function xi(e,t){return function(n,r){if(null==n)return n;if(!Wo(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=Ae(n);(t?a--:++a<i)&&!1!==r(o[a],a,o););return n}}function Di(e){return function(t,n,r){for(var i=-1,a=Ae(t),o=r(t),u=o.length;u--;){var s=o[e?u:++i];if(!1===n(a[s],s,a))break}return t}}function Mi(e){return function(t){var n=cn(t=bu(t))?gn(t):a,r=n?n[0]:t.charAt(0),i=n?ki(n,1).join(""):t.slice(1);return r[e]()+i}}function Li(e){return function(t){return Lt(Zu(Hu(t).replace(tt,"")),e,"")}}function Ui(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Vn(e.prototype),r=e.apply(n,t);return nu(r)?r:n}}function Fi(e){return function(t,n,r){var i=Ae(t);if(!Wo(t)){var o=fa(n,3);t=Cu(t),n=function(e){return o(i[e],e,i)}}var u=e(t,n,r);return u>-1?i[o?t[u]:u]:a}}function Ji(e){return ia((function(t){var n=t.length,r=n,i=Hn.prototype.thru;for(e&&t.reverse();r--;){var u=t[r];if("function"!=typeof u)throw new Re(o);if(i&&!s&&"wrapper"==sa(u))var s=new Hn([],!0)}for(r=s?r:n;++r<n;){var c=sa(u=t[r]),f="wrapper"==c?ua(u):a;s=f&&ka(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?s[sa(f[0])].apply(s,f[3]):1==u.length&&ka(u)?s[c]():s.thru(u)}return function(){var e=arguments,r=e[0];if(s&&1==e.length&&Ko(r))return s.plant(r).value();for(var i=0,a=n?t[i].apply(this,e):r;++i<n;)a=t[i].call(this,a);return a}}))}function qi(e,t,n,i,o,u,s,c,f,l){var v=t&d,p=1&t,h=2&t,g=24&t,m=512&t,y=h?a:Ui(e);return function d(){for(var w=arguments.length,b=r(w),_=w;_--;)b[_]=arguments[_];if(g)var I=ca(d),k=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,I);if(i&&(b=Pi(b,i,o,g)),u&&(b=Ni(b,u,s,g)),w-=k,g&&w<l){var S=dn(b,I);return Gi(e,t,qi,d.placeholder,n,b,S,c,f,l-w)}var E=p?n:this,O=h?E[e]:e;return w=b.length,c?b=function(e,t){var n=e.length,r=_n(t.length,n),i=Ri(e);for(;r--;){var o=t[r];e[r]=ba(o,n)?i[o]:a}return e}(b,c):m&&w>1&&b.reverse(),v&&f<w&&(b.length=f),this&&this!==gt&&this instanceof d&&(O=y||Ui(O)),O.apply(E,b)}}function Vi(e,t){return function(n,r){return function(e,t,n,r){return Ir(e,(function(e,i,a){t(r,n(e),i,a)})),r}(n,e,t(r),{})}}function zi(e,t){return function(n,r){var i;if(n===a&&r===a)return t;if(n!==a&&(i=n),r!==a){if(i===a)return r;"string"==typeof n||"string"==typeof r?(n=li(n),r=li(r)):(n=fi(n),r=fi(r)),i=e(n,r)}return i}}function Hi(e){return ia((function(t){return t=Dt(t,en(fa())),Xr((function(n){var r=this;return e(t,(function(e){return At(e,r,n)}))}))}))}function Ki(e,t){var n=(t=t===a?" ":li(t)).length;if(n<2)return n?$r(t,e):t;var r=$r(t,ht(e/hn(t)));return cn(t)?ki(gn(r),0,e).join(""):r.slice(0,e)}function Qi(e){return function(t,n,i){return i&&"number"!=typeof i&&_a(t,n,i)&&(n=i=a),t=hu(t),n===a?(n=t,t=0):n=hu(n),function(e,t,n,i){for(var a=-1,o=bn(ht((t-e)/(n||1)),0),u=r(o);o--;)u[i?o:++a]=e,e+=n;return u}(t,n,i=i===a?t<n?1:-1:hu(i),e)}}function Wi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=yu(t),n=yu(n)),e(t,n)}}function Gi(e,t,n,r,i,o,u,s,c,d){var v=8&t;t|=v?f:l,4&(t&=~(v?l:f))||(t&=-4);var p=[e,t,i,v?o:a,v?u:a,v?a:o,v?a:u,s,c,d],h=n.apply(a,p);return ka(e)&&Ra(h,p),h.placeholder=r,Ba(h,e,t)}function Yi(e){var t=Te[e];return function(e,n){if(e=yu(e),(n=null==n?0:_n(gu(n),292))&&_t(e)){var r=(bu(e)+"e").split("e");return+((r=(bu(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var $i=Pn&&1/vn(new Pn([,-0]))[1]==p?function(e){return new Pn(e)}:fs;function Xi(e){return function(t){var n=ga(t);return n==O?fn(t):n==R?pn(t):function(e,t){return Dt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Zi(e,t,n,i,u,p,h,g){var m=2&t;if(!m&&"function"!=typeof e)throw new Re(o);var y=i?i.length:0;if(y||(t&=-97,i=u=a),h=h===a?h:bn(gu(h),0),g=g===a?g:gu(g),y-=u?u.length:0,t&l){var w=i,b=u;i=u=a}var _=m?a:ua(e),I=[e,t,n,i,u,w,b,p,h,g];if(_&&function(e,t){var n=e[1],r=t[1],i=n|r,a=i<131,o=r==d&&8==n||r==d&&n==v&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!a&&!o)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var u=t[3];if(u){var c=e[3];e[3]=c?Pi(c,u,t[4]):u,e[4]=c?dn(e[3],s):t[4]}(u=t[5])&&(c=e[5],e[5]=c?Ni(c,u,t[6]):u,e[6]=c?dn(e[5],s):t[6]);(u=t[7])&&(e[7]=u);r&d&&(e[8]=null==e[8]?t[8]:_n(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(I,_),e=I[0],t=I[1],n=I[2],i=I[3],u=I[4],!(g=I[9]=I[9]===a?m?0:e.length:bn(I[9]-y,0))&&24&t&&(t&=-25),t&&1!=t)k=8==t||t==c?function(e,t,n){var i=Ui(e);return function o(){for(var u=arguments.length,s=r(u),c=u,f=ca(o);c--;)s[c]=arguments[c];var l=u<3&&s[0]!==f&&s[u-1]!==f?[]:dn(s,f);return(u-=l.length)<n?Gi(e,t,qi,o.placeholder,a,s,l,a,a,n-u):At(this&&this!==gt&&this instanceof o?i:e,this,s)}}(e,t,g):t!=f&&33!=t||u.length?qi.apply(a,I):function(e,t,n,i){var a=1&t,o=Ui(e);return function t(){for(var u=-1,s=arguments.length,c=-1,f=i.length,l=r(f+s),d=this&&this!==gt&&this instanceof t?o:e;++c<f;)l[c]=i[c];for(;s--;)l[c++]=arguments[++u];return At(d,a?n:this,l)}}(e,t,n,i);else var k=function(e,t,n){var r=1&t,i=Ui(e);return function t(){return(this&&this!==gt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Ba((_?ni:Ra)(k,I),e,t)}function ea(e,t,n,r){return e===a||qo(e,Be[n])&&!Me.call(r,n)?t:e}function ta(e,t,n,r,i,o){return nu(e)&&nu(t)&&(o.set(t,e),zr(e,t,a,ta,o),o.delete(t)),e}function na(e){return ou(e)?a:e}function ra(e,t,n,r,i,o){var u=1&n,s=e.length,c=t.length;if(s!=c&&!(u&&c>s))return!1;var f=o.get(e),l=o.get(t);if(f&&l)return f==t&&l==e;var d=-1,v=!0,p=2&n?new Yn:a;for(o.set(e,t),o.set(t,e);++d<s;){var h=e[d],g=t[d];if(r)var m=u?r(g,h,d,t,e,o):r(h,g,d,e,t,o);if(m!==a){if(m)continue;v=!1;break}if(p){if(!Ft(t,(function(e,t){if(!nn(p,t)&&(h===e||i(h,e,n,r,o)))return p.push(t)}))){v=!1;break}}else if(h!==g&&!i(h,g,n,r,o)){v=!1;break}}return o.delete(e),o.delete(t),v}function ia(e){return Ca(Aa(e,a,Ka),e+"")}function aa(e){return Or(e,Cu,pa)}function oa(e){return Or(e,Bu,ha)}var ua=jn?function(e){return jn.get(e)}:fs;function sa(e){for(var t=e.name+"",n=Cn[t],r=Me.call(Cn,t)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==e)return i.name}return t}function ca(e){return(Me.call(qn,"placeholder")?qn:e).placeholder}function fa(){var e=qn.iteratee||os;return e=e===os?Mr:e,arguments.length?e(arguments[0],arguments[1]):e}function la(e,t){var n,r,a=e.__data__;return("string"==(r=i(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?a["string"==typeof t?"string":"hash"]:a.map}function da(e){for(var t=Cu(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Oa(i)]}return t}function va(e,t){var n=function(e,t){return null==e?a:e[t]}(e,t);return Dr(n)?n:a}var pa=yt?function(e){return null==e?[]:(e=Ae(e),Ct(yt(e),(function(t){return Ye.call(e,t)})))}:ms,ha=yt?function(e){for(var t=[];e;)Mt(t,pa(e)),e=We(e);return t}:ms,ga=Tr;function ma(e,t,n){for(var r=-1,i=(t=_i(t,e)).length,a=!1;++r<i;){var o=La(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&tu(i)&&ba(o,i)&&(Ko(e)||Ho(e))}function ya(e){return"function"!=typeof e.constructor||Ea(e)?{}:Vn(We(e))}function wa(e){return Ko(e)||Ho(e)||!!(Xe&&e&&e[Xe])}function ba(e,t){var n=i(e);return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function _a(e,t,n){if(!nu(n))return!1;var r=i(t);return!!("number"==r?Wo(n)&&ba(t,n.length):"string"==r&&t in n)&&qo(n[t],e)}function Ia(e,t){if(Ko(e))return!1;var n=i(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!fu(e))||(re.test(e)||!ne.test(e)||null!=t&&e in Ae(t))}function ka(e){var t=sa(e),n=qn[t];if("function"!=typeof n||!(t in Kn.prototype))return!1;if(e===n)return!0;var r=ua(n);return!!r&&e===r[0]}(On&&ga(new On(new ArrayBuffer(1)))!=D||Tn&&ga(new Tn)!=O||An&&ga(An.resolve())!=P||Pn&&ga(new Pn)!=R||Nn&&ga(new Nn)!=B)&&(ga=function(e){var t=Tr(e),n=t==A?e.constructor:a,r=n?Ua(n):"";if(r)switch(r){case Bn:return D;case xn:return O;case Dn:return P;case Mn:return R;case Ln:return B}return t});var Sa=xe?Zo:ys;function Ea(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Be)}function Oa(e){return e==e&&!nu(e)}function Ta(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==a||e in Ae(n)))}}function Aa(e,t,n){return t=bn(t===a?e.length-1:t,0),function(){for(var i=arguments,a=-1,o=bn(i.length-t,0),u=r(o);++a<o;)u[a]=i[t+a];a=-1;for(var s=r(t+1);++a<t;)s[a]=i[a];return s[t]=n(u),At(e,this,s)}}function Pa(e,t){return t.length<2?e:Er(e,ai(t,0,-1))}function Na(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Ra=xa(ni),ja=pt||function(e,t){return gt.setTimeout(e,t)},Ca=xa(ri);function Ba(e,t,n){var r=t+"";return Ca(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ce,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Nt(y,(function(n){var r="_."+n[0];t&n[1]&&!Bt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(fe);return t?t[1].split(le):[]}(r),n)))}function xa(e){var t=0,n=0;return function(){var r=In(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(a,arguments)}}function Da(e,t){var n=-1,r=e.length,i=r-1;for(t=t===a?r:t;++n<t;){var o=Yr(n,i),u=e[o];e[o]=e[n],e[n]=u}return e.length=t,e}var Ma=function(e){var t=Do(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ie,(function(e,n,r,i){t.push(r?i.replace(pe,"$1"):n||e)})),t}));function La(e){if("string"==typeof e||fu(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ua(e){if(null!=e){try{return De.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Fa(e){if(e instanceof Kn)return e.clone();var t=new Hn(e.__wrapped__,e.__chain__);return t.__actions__=Ri(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ja=Xr((function(e,t){return Go(e)?vr(e,wr(t,1,Go,!0)):[]})),qa=Xr((function(e,t){var n=$a(t);return Go(n)&&(n=a),Go(e)?vr(e,wr(t,1,Go,!0),fa(n,2)):[]})),Va=Xr((function(e,t){var n=$a(t);return Go(n)&&(n=a),Go(e)?vr(e,wr(t,1,Go,!0),a,n):[]}));function za(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:gu(n);return i<0&&(i=bn(r+i,0)),Vt(e,fa(t,3),i)}function Ha(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==a&&(i=gu(n),i=n<0?bn(r+i,0):_n(i,r-1)),Vt(e,fa(t,3),i,!0)}function Ka(e){return(null==e?0:e.length)?wr(e,1):[]}function Qa(e){return e&&e.length?e[0]:a}var Wa=Xr((function(e){var t=Dt(e,wi);return t.length&&t[0]===e[0]?Rr(t):[]})),Ga=Xr((function(e){var t=$a(e),n=Dt(e,wi);return t===$a(n)?t=a:n.pop(),n.length&&n[0]===e[0]?Rr(n,fa(t,2)):[]})),Ya=Xr((function(e){var t=$a(e),n=Dt(e,wi);return(t="function"==typeof t?t:a)&&n.pop(),n.length&&n[0]===e[0]?Rr(n,a,t):[]}));function $a(e){var t=null==e?0:e.length;return t?e[t-1]:a}var Xa=Xr(Za);function Za(e,t){return e&&e.length&&t&&t.length?Wr(e,t):e}var eo=ia((function(e,t){var n=null==e?0:e.length,r=sr(e,t);return Gr(e,Dt(t,(function(e){return ba(e,n)?+e:e})).sort(Ai)),r}));function to(e){return null==e?e:En.call(e)}var no=Xr((function(e){return di(wr(e,1,Go,!0))})),ro=Xr((function(e){var t=$a(e);return Go(t)&&(t=a),di(wr(e,1,Go,!0),fa(t,2))})),io=Xr((function(e){var t=$a(e);return t="function"==typeof t?t:a,di(wr(e,1,Go,!0),a,t)}));function ao(e){if(!e||!e.length)return[];var t=0;return e=Ct(e,(function(e){if(Go(e))return t=bn(e.length,t),!0})),Xt(t,(function(t){return Dt(e,Wt(t))}))}function oo(e,t){if(!e||!e.length)return[];var n=ao(e);return null==t?n:Dt(n,(function(e){return At(t,a,e)}))}var uo=Xr((function(e,t){return Go(e)?vr(e,t):[]})),so=Xr((function(e){return mi(Ct(e,Go))})),co=Xr((function(e){var t=$a(e);return Go(t)&&(t=a),mi(Ct(e,Go),fa(t,2))})),fo=Xr((function(e){var t=$a(e);return t="function"==typeof t?t:a,mi(Ct(e,Go),a,t)})),lo=Xr(ao);var vo=Xr((function(e){var t=e.length,n=t>1?e[t-1]:a;return n="function"==typeof n?(e.pop(),n):a,oo(e,n)}));function po(e){var t=qn(e);return t.__chain__=!0,t}function ho(e,t){return t(e)}var go=ia((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return sr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Kn&&ba(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ho,args:[i],thisArg:a}),new Hn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(a),e}))):this.thru(i)}));var mo=Ci((function(e,t,n){Me.call(e,n)?++e[n]:ur(e,n,1)}));var yo=Fi(za),wo=Fi(Ha);function bo(e,t){return(Ko(e)?Nt:pr)(e,fa(t,3))}function _o(e,t){return(Ko(e)?Rt:hr)(e,fa(t,3))}var Io=Ci((function(e,t,n){Me.call(e,n)?e[n].push(t):ur(e,n,[t])}));var ko=Xr((function(e,t,n){var i=-1,a="function"==typeof t,o=Wo(e)?r(e.length):[];return pr(e,(function(e){o[++i]=a?At(t,e,n):jr(e,t,n)})),o})),So=Ci((function(e,t,n){ur(e,n,t)}));function Eo(e,t){return(Ko(e)?Dt:Jr)(e,fa(t,3))}var Oo=Ci((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var To=Xr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&_a(e,t[0],t[1])?t=[]:n>2&&_a(t[0],t[1],t[2])&&(t=[t[0]]),Kr(e,wr(t,1),[])})),Ao=lt||function(){return gt.Date.now()};function Po(e,t,n){return t=n?a:t,t=e&&null==t?e.length:t,Zi(e,d,a,a,a,a,t)}function No(e,t){var n;if("function"!=typeof t)throw new Re(o);return e=gu(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=a),n}}var Ro=Xr((function(e,t,n){var r=1;if(n.length){var i=dn(n,ca(Ro));r|=f}return Zi(e,r,t,n,i)})),jo=Xr((function(e,t,n){var r=3;if(n.length){var i=dn(n,ca(jo));r|=f}return Zi(t,r,e,n,i)}));function Co(e,t,n){var r,i,u,s,c,f,l=0,d=!1,v=!1,p=!0;if("function"!=typeof e)throw new Re(o);function h(t){var n=r,o=i;return r=i=a,l=t,s=e.apply(o,n)}function g(e){var n=e-f;return f===a||n>=t||n<0||v&&e-l>=u}function m(){var e=Ao();if(g(e))return y(e);c=ja(m,function(e){var n=t-(e-f);return v?_n(n,u-(e-l)):n}(e))}function y(e){return c=a,p&&r?h(e):(r=i=a,s)}function w(){var e=Ao(),n=g(e);if(r=arguments,i=this,f=e,n){if(c===a)return function(e){return l=e,c=ja(m,t),d?h(e):s}(f);if(v)return Si(c),c=ja(m,t),h(f)}return c===a&&(c=ja(m,t)),s}return t=yu(t)||0,nu(n)&&(d=!!n.leading,u=(v="maxWait"in n)?bn(yu(n.maxWait)||0,t):u,p="trailing"in n?!!n.trailing:p),w.cancel=function(){c!==a&&Si(c),l=0,r=f=i=c=a},w.flush=function(){return c===a?s:y(Ao())},w}var Bo=Xr((function(e,t){return dr(e,1,t)})),xo=Xr((function(e,t,n){return dr(e,yu(t)||0,n)}));function Do(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Re(o);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(Do.Cache||Gn),n}function Mo(e){if("function"!=typeof e)throw new Re(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Do.Cache=Gn;var Lo=Ii((function(e,t){var n=(t=1==t.length&&Ko(t[0])?Dt(t[0],en(fa())):Dt(wr(t,1),en(fa()))).length;return Xr((function(r){for(var i=-1,a=_n(r.length,n);++i<a;)r[i]=t[i].call(this,r[i]);return At(e,this,r)}))})),Uo=Xr((function(e,t){var n=dn(t,ca(Uo));return Zi(e,f,a,t,n)})),Fo=Xr((function(e,t){var n=dn(t,ca(Fo));return Zi(e,l,a,t,n)})),Jo=ia((function(e,t){return Zi(e,v,a,a,a,t)}));function qo(e,t){return e===t||e!=e&&t!=t}var Vo=Wi(Ar),zo=Wi((function(e,t){return e>=t})),Ho=Cr(function(){return arguments}())?Cr:function(e){return ru(e)&&Me.call(e,"callee")&&!Ye.call(e,"callee")},Ko=r.isArray,Qo=It?en(It):function(e){return ru(e)&&Tr(e)==x};function Wo(e){return null!=e&&tu(e.length)&&!Zo(e)}function Go(e){return ru(e)&&Wo(e)}var Yo=bt||ys,$o=kt?en(kt):function(e){return ru(e)&&Tr(e)==I};function Xo(e){if(!ru(e))return!1;var t=Tr(e);return t==k||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ou(e)}function Zo(e){if(!nu(e))return!1;var t=Tr(e);return t==S||t==E||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eu(e){return"number"==typeof e&&e==gu(e)}function tu(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function nu(e){var t=i(e);return null!=e&&("object"==t||"function"==t)}function ru(e){return null!=e&&"object"==i(e)}var iu=St?en(St):function(e){return ru(e)&&ga(e)==O};function au(e){return"number"==typeof e||ru(e)&&Tr(e)==T}function ou(e){if(!ru(e)||Tr(e)!=A)return!1;var t=We(e);if(null===t)return!0;var n=Me.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&De.call(n)==Je}var uu=Et?en(Et):function(e){return ru(e)&&Tr(e)==N};var su=Ot?en(Ot):function(e){return ru(e)&&ga(e)==R};function cu(e){return"string"==typeof e||!Ko(e)&&ru(e)&&Tr(e)==j}function fu(e){return"symbol"==i(e)||ru(e)&&Tr(e)==C}var lu=Tt?en(Tt):function(e){return ru(e)&&tu(e.length)&&!!ct[Tr(e)]};var du=Wi(Fr),vu=Wi((function(e,t){return e<=t}));function pu(e){if(!e)return[];if(Wo(e))return cu(e)?gn(e):Ri(e);if(Ze&&e[Ze])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ze]());var t=ga(e);return(t==O?fn:t==R?vn:qu)(e)}function hu(e){return e?(e=yu(e))===p||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function gu(e){var t=hu(e),n=t%1;return t==t?n?t-n:t:0}function mu(e){return e?cr(gu(e),0,m):0}function yu(e){if("number"==typeof e)return e;if(fu(e))return g;if(nu(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=nu(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Zt(e);var n=ye.test(e);return n||be.test(e)?vt(e.slice(2),n?2:8):me.test(e)?g:+e}function wu(e){return ji(e,Bu(e))}function bu(e){return null==e?"":li(e)}var _u=Bi((function(e,t){if(Ea(t)||Wo(t))ji(t,Cu(t),e);else for(var n in t)Me.call(t,n)&&rr(e,n,t[n])})),Iu=Bi((function(e,t){ji(t,Bu(t),e)})),ku=Bi((function(e,t,n,r){ji(t,Bu(t),e,r)})),Su=Bi((function(e,t,n,r){ji(t,Cu(t),e,r)})),Eu=ia(sr);var Ou=Xr((function(e,t){e=Ae(e);var n=-1,r=t.length,i=r>2?t[2]:a;for(i&&_a(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],u=Bu(o),s=-1,c=u.length;++s<c;){var f=u[s],l=e[f];(l===a||qo(l,Be[f])&&!Me.call(e,f))&&(e[f]=o[f])}return e})),Tu=Xr((function(e){return e.push(a,ta),At(Du,a,e)}));function Au(e,t,n){var r=null==e?a:Er(e,t);return r===a?n:r}function Pu(e,t){return null!=e&&ma(e,t,Nr)}var Nu=Vi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),e[t]=n}),ns(as)),Ru=Vi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),Me.call(e,t)?e[t].push(n):e[t]=[n]}),fa),ju=Xr(jr);function Cu(e){return Wo(e)?Xn(e):Lr(e)}function Bu(e){return Wo(e)?Xn(e,!0):Ur(e)}var xu=Bi((function(e,t,n){zr(e,t,n)})),Du=Bi((function(e,t,n,r){zr(e,t,n,r)})),Mu=ia((function(e,t){var n={};if(null==e)return n;var r=!1;t=Dt(t,(function(t){return t=_i(t,e),r||(r=t.length>1),t})),ji(e,oa(e),n),r&&(n=fr(n,7,na));for(var i=t.length;i--;)vi(n,t[i]);return n}));var Lu=ia((function(e,t){return null==e?{}:function(e,t){return Qr(e,t,(function(t,n){return Pu(e,n)}))}(e,t)}));function Uu(e,t){if(null==e)return{};var n=Dt(oa(e),(function(e){return[e]}));return t=fa(t),Qr(e,n,(function(e,n){return t(e,n[0])}))}var Fu=Xi(Cu),Ju=Xi(Bu);function qu(e){return null==e?[]:tn(e,Cu(e))}var Vu=Li((function(e,t,n){return t=t.toLowerCase(),e+(n?zu(t):t)}));function zu(e){return Xu(bu(e).toLowerCase())}function Hu(e){return(e=bu(e))&&e.replace(Ie,on).replace(nt,"")}var Ku=Li((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Qu=Li((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Wu=Mi("toLowerCase");var Gu=Li((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Yu=Li((function(e,t,n){return e+(n?" ":"")+Xu(t)}));var $u=Li((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Xu=Mi("toUpperCase");function Zu(e,t,n){return e=bu(e),(t=n?a:t)===a?function(e){return ot.test(e)}(e)?function(e){return e.match(it)||[]}(e):function(e){return e.match(de)||[]}(e):e.match(t)||[]}var es=Xr((function(e,t){try{return At(e,a,t)}catch(e){return Xo(e)?e:new Ee(e)}})),ts=ia((function(e,t){return Nt(t,(function(t){t=La(t),ur(e,t,Ro(e[t],e))})),e}));function ns(e){return function(){return e}}var rs=Ji(),is=Ji(!0);function as(e){return e}function os(e){return Mr("function"==typeof e?e:fr(e,1))}var us=Xr((function(e,t){return function(n){return jr(n,e,t)}})),ss=Xr((function(e,t){return function(n){return jr(e,n,t)}}));function cs(e,t,n){var r=Cu(t),i=Sr(t,r);null!=n||nu(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Sr(t,Cu(t)));var a=!(nu(n)&&"chain"in n&&!n.chain),o=Zo(e);return Nt(i,(function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=Ri(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Mt([this.value()],arguments))})})),e}function fs(){}var ls=Hi(Dt),ds=Hi(jt),vs=Hi(Ft);function ps(e){return Ia(e)?Wt(La(e)):function(e){return function(t){return Er(t,e)}}(e)}var hs=Qi(),gs=Qi(!0);function ms(){return[]}function ys(){return!1}var ws=zi((function(e,t){return e+t}),0),bs=Yi("ceil"),_s=zi((function(e,t){return e/t}),1),Is=Yi("floor");var ks,Ss=zi((function(e,t){return e*t}),1),Es=Yi("round"),Os=zi((function(e,t){return e-t}),0);return qn.after=function(e,t){if("function"!=typeof t)throw new Re(o);return e=gu(e),function(){if(--e<1)return t.apply(this,arguments)}},qn.ary=Po,qn.assign=_u,qn.assignIn=Iu,qn.assignInWith=ku,qn.assignWith=Su,qn.at=Eu,qn.before=No,qn.bind=Ro,qn.bindAll=ts,qn.bindKey=jo,qn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ko(e)?e:[e]},qn.chain=po,qn.chunk=function(e,t,n){t=(n?_a(e,t,n):t===a)?1:bn(gu(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,u=0,s=r(ht(i/t));o<i;)s[u++]=ai(e,o,o+=t);return s},qn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var a=e[t];a&&(i[r++]=a)}return i},qn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Mt(Ko(n)?Ri(n):[n],wr(t,1))},qn.cond=function(e){var t=null==e?0:e.length,n=fa();return e=t?Dt(e,(function(e){if("function"!=typeof e[1])throw new Re(o);return[n(e[0]),e[1]]})):[],Xr((function(n){for(var r=-1;++r<t;){var i=e[r];if(At(i[0],this,n))return At(i[1],this,n)}}))},qn.conforms=function(e){return function(e){var t=Cu(e);return function(n){return lr(n,e,t)}}(fr(e,1))},qn.constant=ns,qn.countBy=mo,qn.create=function(e,t){var n=Vn(e);return null==t?n:or(n,t)},qn.curry=function e(t,n,r){var i=Zi(t,8,a,a,a,a,a,n=r?a:n);return i.placeholder=e.placeholder,i},qn.curryRight=function e(t,n,r){var i=Zi(t,c,a,a,a,a,a,n=r?a:n);return i.placeholder=e.placeholder,i},qn.debounce=Co,qn.defaults=Ou,qn.defaultsDeep=Tu,qn.defer=Bo,qn.delay=xo,qn.difference=Ja,qn.differenceBy=qa,qn.differenceWith=Va,qn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ai(e,(t=n||t===a?1:gu(t))<0?0:t,r):[]},qn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ai(e,0,(t=r-(t=n||t===a?1:gu(t)))<0?0:t):[]},qn.dropRightWhile=function(e,t){return e&&e.length?hi(e,fa(t,3),!0,!0):[]},qn.dropWhile=function(e,t){return e&&e.length?hi(e,fa(t,3),!0):[]},qn.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&_a(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=gu(n))<0&&(n=-n>i?0:i+n),(r=r===a||r>i?i:gu(r))<0&&(r+=i),r=n>r?0:mu(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},qn.filter=function(e,t){return(Ko(e)?Ct:yr)(e,fa(t,3))},qn.flatMap=function(e,t){return wr(Eo(e,t),1)},qn.flatMapDeep=function(e,t){return wr(Eo(e,t),p)},qn.flatMapDepth=function(e,t,n){return n=n===a?1:gu(n),wr(Eo(e,t),n)},qn.flatten=Ka,qn.flattenDeep=function(e){return(null==e?0:e.length)?wr(e,p):[]},qn.flattenDepth=function(e,t){return(null==e?0:e.length)?wr(e,t=t===a?1:gu(t)):[]},qn.flip=function(e){return Zi(e,512)},qn.flow=rs,qn.flowRight=is,qn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},qn.functions=function(e){return null==e?[]:Sr(e,Cu(e))},qn.functionsIn=function(e){return null==e?[]:Sr(e,Bu(e))},qn.groupBy=Io,qn.initial=function(e){return(null==e?0:e.length)?ai(e,0,-1):[]},qn.intersection=Wa,qn.intersectionBy=Ga,qn.intersectionWith=Ya,qn.invert=Nu,qn.invertBy=Ru,qn.invokeMap=ko,qn.iteratee=os,qn.keyBy=So,qn.keys=Cu,qn.keysIn=Bu,qn.map=Eo,qn.mapKeys=function(e,t){var n={};return t=fa(t,3),Ir(e,(function(e,r,i){ur(n,t(e,r,i),e)})),n},qn.mapValues=function(e,t){var n={};return t=fa(t,3),Ir(e,(function(e,r,i){ur(n,r,t(e,r,i))})),n},qn.matches=function(e){return qr(fr(e,1))},qn.matchesProperty=function(e,t){return Vr(e,fr(t,1))},qn.memoize=Do,qn.merge=xu,qn.mergeWith=Du,qn.method=us,qn.methodOf=ss,qn.mixin=cs,qn.negate=Mo,qn.nthArg=function(e){return e=gu(e),Xr((function(t){return Hr(t,e)}))},qn.omit=Mu,qn.omitBy=function(e,t){return Uu(e,Mo(fa(t)))},qn.once=function(e){return No(2,e)},qn.orderBy=function(e,t,n,r){return null==e?[]:(Ko(t)||(t=null==t?[]:[t]),Ko(n=r?a:n)||(n=null==n?[]:[n]),Kr(e,t,n))},qn.over=ls,qn.overArgs=Lo,qn.overEvery=ds,qn.overSome=vs,qn.partial=Uo,qn.partialRight=Fo,qn.partition=Oo,qn.pick=Lu,qn.pickBy=Uu,qn.property=ps,qn.propertyOf=function(e){return function(t){return null==e?a:Er(e,t)}},qn.pull=Xa,qn.pullAll=Za,qn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Wr(e,t,fa(n,2)):e},qn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Wr(e,t,a,n):e},qn.pullAt=eo,qn.range=hs,qn.rangeRight=gs,qn.rearg=Jo,qn.reject=function(e,t){return(Ko(e)?Ct:yr)(e,Mo(fa(t,3)))},qn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],a=e.length;for(t=fa(t,3);++r<a;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}return Gr(e,i),n},qn.rest=function(e,t){if("function"!=typeof e)throw new Re(o);return Xr(e,t=t===a?t:gu(t))},qn.reverse=to,qn.sampleSize=function(e,t,n){return t=(n?_a(e,t,n):t===a)?1:gu(t),(Ko(e)?er:ei)(e,t)},qn.set=function(e,t,n){return null==e?e:ti(e,t,n)},qn.setWith=function(e,t,n,r){return r="function"==typeof r?r:a,null==e?e:ti(e,t,n,r)},qn.shuffle=function(e){return(Ko(e)?tr:ii)(e)},qn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&_a(e,t,n)?(t=0,n=r):(t=null==t?0:gu(t),n=n===a?r:gu(n)),ai(e,t,n)):[]},qn.sortBy=To,qn.sortedUniq=function(e){return e&&e.length?ci(e):[]},qn.sortedUniqBy=function(e,t){return e&&e.length?ci(e,fa(t,2)):[]},qn.split=function(e,t,n){return n&&"number"!=typeof n&&_a(e,t,n)&&(t=n=a),(n=n===a?m:n>>>0)?(e=bu(e))&&("string"==typeof t||null!=t&&!uu(t))&&!(t=li(t))&&cn(e)?ki(gn(e),0,n):e.split(t,n):[]},qn.spread=function(e,t){if("function"!=typeof e)throw new Re(o);return t=null==t?0:bn(gu(t),0),Xr((function(n){var r=n[t],i=ki(n,0,t);return r&&Mt(i,r),At(e,this,i)}))},qn.tail=function(e){var t=null==e?0:e.length;return t?ai(e,1,t):[]},qn.take=function(e,t,n){return e&&e.length?ai(e,0,(t=n||t===a?1:gu(t))<0?0:t):[]},qn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ai(e,(t=r-(t=n||t===a?1:gu(t)))<0?0:t,r):[]},qn.takeRightWhile=function(e,t){return e&&e.length?hi(e,fa(t,3),!1,!0):[]},qn.takeWhile=function(e,t){return e&&e.length?hi(e,fa(t,3)):[]},qn.tap=function(e,t){return t(e),e},qn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Re(o);return nu(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Co(e,t,{leading:r,maxWait:t,trailing:i})},qn.thru=ho,qn.toArray=pu,qn.toPairs=Fu,qn.toPairsIn=Ju,qn.toPath=function(e){return Ko(e)?Dt(e,La):fu(e)?[e]:Ri(Ma(bu(e)))},qn.toPlainObject=wu,qn.transform=function(e,t,n){var r=Ko(e),i=r||Yo(e)||lu(e);if(t=fa(t,4),null==n){var a=e&&e.constructor;n=i?r?new a:[]:nu(e)&&Zo(a)?Vn(We(e)):{}}return(i?Nt:Ir)(e,(function(e,r,i){return t(n,e,r,i)})),n},qn.unary=function(e){return Po(e,1)},qn.union=no,qn.unionBy=ro,qn.unionWith=io,qn.uniq=function(e){return e&&e.length?di(e):[]},qn.uniqBy=function(e,t){return e&&e.length?di(e,fa(t,2)):[]},qn.uniqWith=function(e,t){return t="function"==typeof t?t:a,e&&e.length?di(e,a,t):[]},qn.unset=function(e,t){return null==e||vi(e,t)},qn.unzip=ao,qn.unzipWith=oo,qn.update=function(e,t,n){return null==e?e:pi(e,t,bi(n))},qn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:a,null==e?e:pi(e,t,bi(n),r)},qn.values=qu,qn.valuesIn=function(e){return null==e?[]:tn(e,Bu(e))},qn.without=uo,qn.words=Zu,qn.wrap=function(e,t){return Uo(bi(t),e)},qn.xor=so,qn.xorBy=co,qn.xorWith=fo,qn.zip=lo,qn.zipObject=function(e,t){return yi(e||[],t||[],rr)},qn.zipObjectDeep=function(e,t){return yi(e||[],t||[],ti)},qn.zipWith=vo,qn.entries=Fu,qn.entriesIn=Ju,qn.extend=Iu,qn.extendWith=ku,cs(qn,qn),qn.add=ws,qn.attempt=es,qn.camelCase=Vu,qn.capitalize=zu,qn.ceil=bs,qn.clamp=function(e,t,n){return n===a&&(n=t,t=a),n!==a&&(n=(n=yu(n))==n?n:0),t!==a&&(t=(t=yu(t))==t?t:0),cr(yu(e),t,n)},qn.clone=function(e){return fr(e,4)},qn.cloneDeep=function(e){return fr(e,5)},qn.cloneDeepWith=function(e,t){return fr(e,5,t="function"==typeof t?t:a)},qn.cloneWith=function(e,t){return fr(e,4,t="function"==typeof t?t:a)},qn.conformsTo=function(e,t){return null==t||lr(e,t,Cu(t))},qn.deburr=Hu,qn.defaultTo=function(e,t){return null==e||e!=e?t:e},qn.divide=_s,qn.endsWith=function(e,t,n){e=bu(e),t=li(t);var r=e.length,i=n=n===a?r:cr(gu(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},qn.eq=qo,qn.escape=function(e){return(e=bu(e))&&X.test(e)?e.replace(Y,un):e},qn.escapeRegExp=function(e){return(e=bu(e))&&oe.test(e)?e.replace(ae,"\\$&"):e},qn.every=function(e,t,n){var r=Ko(e)?jt:gr;return n&&_a(e,t,n)&&(t=a),r(e,fa(t,3))},qn.find=yo,qn.findIndex=za,qn.findKey=function(e,t){return qt(e,fa(t,3),Ir)},qn.findLast=wo,qn.findLastIndex=Ha,qn.findLastKey=function(e,t){return qt(e,fa(t,3),kr)},qn.floor=Is,qn.forEach=bo,qn.forEachRight=_o,qn.forIn=function(e,t){return null==e?e:br(e,fa(t,3),Bu)},qn.forInRight=function(e,t){return null==e?e:_r(e,fa(t,3),Bu)},qn.forOwn=function(e,t){return e&&Ir(e,fa(t,3))},qn.forOwnRight=function(e,t){return e&&kr(e,fa(t,3))},qn.get=Au,qn.gt=Vo,qn.gte=zo,qn.has=function(e,t){return null!=e&&ma(e,t,Pr)},qn.hasIn=Pu,qn.head=Qa,qn.identity=as,qn.includes=function(e,t,n,r){e=Wo(e)?e:qu(e),n=n&&!r?gu(n):0;var i=e.length;return n<0&&(n=bn(i+n,0)),cu(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&zt(e,t,n)>-1},qn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:gu(n);return i<0&&(i=bn(r+i,0)),zt(e,t,i)},qn.inRange=function(e,t,n){return t=hu(t),n===a?(n=t,t=0):n=hu(n),function(e,t,n){return e>=_n(t,n)&&e<bn(t,n)}(e=yu(e),t,n)},qn.invoke=ju,qn.isArguments=Ho,qn.isArray=Ko,qn.isArrayBuffer=Qo,qn.isArrayLike=Wo,qn.isArrayLikeObject=Go,qn.isBoolean=function(e){return!0===e||!1===e||ru(e)&&Tr(e)==_},qn.isBuffer=Yo,qn.isDate=$o,qn.isElement=function(e){return ru(e)&&1===e.nodeType&&!ou(e)},qn.isEmpty=function(e){if(null==e)return!0;if(Wo(e)&&(Ko(e)||"string"==typeof e||"function"==typeof e.splice||Yo(e)||lu(e)||Ho(e)))return!e.length;var t=ga(e);if(t==O||t==R)return!e.size;if(Ea(e))return!Lr(e).length;for(var n in e)if(Me.call(e,n))return!1;return!0},qn.isEqual=function(e,t){return Br(e,t)},qn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:a)?n(e,t):a;return r===a?Br(e,t,a,n):!!r},qn.isError=Xo,qn.isFinite=function(e){return"number"==typeof e&&_t(e)},qn.isFunction=Zo,qn.isInteger=eu,qn.isLength=tu,qn.isMap=iu,qn.isMatch=function(e,t){return e===t||xr(e,t,da(t))},qn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:a,xr(e,t,da(t),n)},qn.isNaN=function(e){return au(e)&&e!=+e},qn.isNative=function(e){if(Sa(e))throw new Ee("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Dr(e)},qn.isNil=function(e){return null==e},qn.isNull=function(e){return null===e},qn.isNumber=au,qn.isObject=nu,qn.isObjectLike=ru,qn.isPlainObject=ou,qn.isRegExp=uu,qn.isSafeInteger=function(e){return eu(e)&&e>=-9007199254740991&&e<=h},qn.isSet=su,qn.isString=cu,qn.isSymbol=fu,qn.isTypedArray=lu,qn.isUndefined=function(e){return e===a},qn.isWeakMap=function(e){return ru(e)&&ga(e)==B},qn.isWeakSet=function(e){return ru(e)&&"[object WeakSet]"==Tr(e)},qn.join=function(e,t){return null==e?"":Jt.call(e,t)},qn.kebabCase=Ku,qn.last=$a,qn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==a&&(i=(i=gu(n))<0?bn(r+i,0):_n(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):Vt(e,Kt,i,!0)},qn.lowerCase=Qu,qn.lowerFirst=Wu,qn.lt=du,qn.lte=vu,qn.max=function(e){return e&&e.length?mr(e,as,Ar):a},qn.maxBy=function(e,t){return e&&e.length?mr(e,fa(t,2),Ar):a},qn.mean=function(e){return Qt(e,as)},qn.meanBy=function(e,t){return Qt(e,fa(t,2))},qn.min=function(e){return e&&e.length?mr(e,as,Fr):a},qn.minBy=function(e,t){return e&&e.length?mr(e,fa(t,2),Fr):a},qn.stubArray=ms,qn.stubFalse=ys,qn.stubObject=function(){return{}},qn.stubString=function(){return""},qn.stubTrue=function(){return!0},qn.multiply=Ss,qn.nth=function(e,t){return e&&e.length?Hr(e,gu(t)):a},qn.noConflict=function(){return gt._===this&&(gt._=qe),this},qn.noop=fs,qn.now=Ao,qn.pad=function(e,t,n){e=bu(e);var r=(t=gu(t))?hn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Ki(mt(i),n)+e+Ki(ht(i),n)},qn.padEnd=function(e,t,n){e=bu(e);var r=(t=gu(t))?hn(e):0;return t&&r<t?e+Ki(t-r,n):e},qn.padStart=function(e,t,n){e=bu(e);var r=(t=gu(t))?hn(e):0;return t&&r<t?Ki(t-r,n)+e:e},qn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),kn(bu(e).replace(ue,""),t||0)},qn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&_a(e,t,n)&&(t=n=a),n===a&&("boolean"==typeof t?(n=t,t=a):"boolean"==typeof e&&(n=e,e=a)),e===a&&t===a?(e=0,t=1):(e=hu(e),t===a?(t=e,e=0):t=hu(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=Sn();return _n(e+i*(t-e+dt("1e-"+((i+"").length-1))),t)}return Yr(e,t)},qn.reduce=function(e,t,n){var r=Ko(e)?Lt:Yt,i=arguments.length<3;return r(e,fa(t,4),n,i,pr)},qn.reduceRight=function(e,t,n){var r=Ko(e)?Ut:Yt,i=arguments.length<3;return r(e,fa(t,4),n,i,hr)},qn.repeat=function(e,t,n){return t=(n?_a(e,t,n):t===a)?1:gu(t),$r(bu(e),t)},qn.replace=function(){var e=arguments,t=bu(e[0]);return e.length<3?t:t.replace(e[1],e[2])},qn.result=function(e,t,n){var r=-1,i=(t=_i(t,e)).length;for(i||(i=1,e=a);++r<i;){var o=null==e?a:e[La(t[r])];o===a&&(r=i,o=n),e=Zo(o)?o.call(e):o}return e},qn.round=Es,qn.runInContext=e,qn.sample=function(e){return(Ko(e)?Zn:Zr)(e)},qn.size=function(e){if(null==e)return 0;if(Wo(e))return cu(e)?hn(e):e.length;var t=ga(e);return t==O||t==R?e.size:Lr(e).length},qn.snakeCase=Gu,qn.some=function(e,t,n){var r=Ko(e)?Ft:oi;return n&&_a(e,t,n)&&(t=a),r(e,fa(t,3))},qn.sortedIndex=function(e,t){return ui(e,t)},qn.sortedIndexBy=function(e,t,n){return si(e,t,fa(n,2))},qn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ui(e,t);if(r<n&&qo(e[r],t))return r}return-1},qn.sortedLastIndex=function(e,t){return ui(e,t,!0)},qn.sortedLastIndexBy=function(e,t,n){return si(e,t,fa(n,2),!0)},qn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=ui(e,t,!0)-1;if(qo(e[n],t))return n}return-1},qn.startCase=Yu,qn.startsWith=function(e,t,n){return e=bu(e),n=null==n?0:cr(gu(n),0,e.length),t=li(t),e.slice(n,n+t.length)==t},qn.subtract=Os,qn.sum=function(e){return e&&e.length?$t(e,as):0},qn.sumBy=function(e,t){return e&&e.length?$t(e,fa(t,2)):0},qn.template=function(e,t,n){var r=qn.templateSettings;n&&_a(e,t,n)&&(t=a),e=bu(e),t=ku({},t,r,ea);var i,o,u=ku({},t.imports,r.imports,ea),s=Cu(u),c=tn(u,s),f=0,l=t.interpolate||ke,d="__p += '",v=Pe((t.escape||ke).source+"|"+l.source+"|"+(l===te?he:ke).source+"|"+(t.evaluate||ke).source+"|$","g"),p="//# sourceURL="+(Me.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++st+"]")+"\n";e.replace(v,(function(t,n,r,a,u,s){return r||(r=a),d+=e.slice(f,s).replace(Se,sn),n&&(i=!0,d+="' +\n__e("+n+") +\n'"),u&&(o=!0,d+="';\n"+u+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),f=s+t.length,t})),d+="';\n";var h=Me.call(t,"variable")&&t.variable;if(h){if(ve.test(h))throw new Ee("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(K,""):d).replace(Q,"$1").replace(W,"$1;"),d="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=es((function(){return Oe(s,p+"return "+d).apply(a,c)}));if(g.source=d,Xo(g))throw g;return g},qn.times=function(e,t){if((e=gu(e))<1||e>h)return[];var n=m,r=_n(e,m);t=fa(t),e-=m;for(var i=Xt(r,t);++n<e;)t(n);return i},qn.toFinite=hu,qn.toInteger=gu,qn.toLength=mu,qn.toLower=function(e){return bu(e).toLowerCase()},qn.toNumber=yu,qn.toSafeInteger=function(e){return e?cr(gu(e),-9007199254740991,h):0===e?e:0},qn.toString=bu,qn.toUpper=function(e){return bu(e).toUpperCase()},qn.trim=function(e,t,n){if((e=bu(e))&&(n||t===a))return Zt(e);if(!e||!(t=li(t)))return e;var r=gn(e),i=gn(t);return ki(r,rn(r,i),an(r,i)+1).join("")},qn.trimEnd=function(e,t,n){if((e=bu(e))&&(n||t===a))return e.slice(0,mn(e)+1);if(!e||!(t=li(t)))return e;var r=gn(e);return ki(r,0,an(r,gn(t))+1).join("")},qn.trimStart=function(e,t,n){if((e=bu(e))&&(n||t===a))return e.replace(ue,"");if(!e||!(t=li(t)))return e;var r=gn(e);return ki(r,rn(r,gn(t))).join("")},qn.truncate=function(e,t){var n=30,r="...";if(nu(t)){var i="separator"in t?t.separator:i;n="length"in t?gu(t.length):n,r="omission"in t?li(t.omission):r}var o=(e=bu(e)).length;if(cn(e)){var u=gn(e);o=u.length}if(n>=o)return e;var s=n-hn(r);if(s<1)return r;var c=u?ki(u,0,s).join(""):e.slice(0,s);if(i===a)return c+r;if(u&&(s+=c.length-s),uu(i)){if(e.slice(s).search(i)){var f,l=c;for(i.global||(i=Pe(i.source,bu(ge.exec(i))+"g")),i.lastIndex=0;f=i.exec(l);)var d=f.index;c=c.slice(0,d===a?s:d)}}else if(e.indexOf(li(i),s)!=s){var v=c.lastIndexOf(i);v>-1&&(c=c.slice(0,v))}return c+r},qn.unescape=function(e){return(e=bu(e))&&$.test(e)?e.replace(G,yn):e},qn.uniqueId=function(e){var t=++Le;return bu(e)+t},qn.upperCase=$u,qn.upperFirst=Xu,qn.each=bo,qn.eachRight=_o,qn.first=Qa,cs(qn,(ks={},Ir(qn,(function(e,t){Me.call(qn.prototype,t)||(ks[t]=e)})),ks),{chain:!1}),qn.VERSION="4.17.21",Nt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){qn[e].placeholder=qn})),Nt(["drop","take"],(function(e,t){Kn.prototype[e]=function(n){n=n===a?1:bn(gu(n),0);var r=this.__filtered__&&!t?new Kn(this):this.clone();return r.__filtered__?r.__takeCount__=_n(n,r.__takeCount__):r.__views__.push({size:_n(n,m),type:e+(r.__dir__<0?"Right":"")}),r},Kn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Nt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Kn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:fa(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Nt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Kn.prototype[e]=function(){return this[n](1).value()[0]}})),Nt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Kn.prototype[e]=function(){return this.__filtered__?new Kn(this):this[n](1)}})),Kn.prototype.compact=function(){return this.filter(as)},Kn.prototype.find=function(e){return this.filter(e).head()},Kn.prototype.findLast=function(e){return this.reverse().find(e)},Kn.prototype.invokeMap=Xr((function(e,t){return"function"==typeof e?new Kn(this):this.map((function(n){return jr(n,e,t)}))})),Kn.prototype.reject=function(e){return this.filter(Mo(fa(e)))},Kn.prototype.slice=function(e,t){e=gu(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Kn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==a&&(n=(t=gu(t))<0?n.dropRight(-t):n.take(t-e)),n)},Kn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Kn.prototype.toArray=function(){return this.take(m)},Ir(Kn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=qn[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(qn.prototype[t]=function(){var t=this.__wrapped__,u=r?[1]:arguments,s=t instanceof Kn,c=u[0],f=s||Ko(t),l=function(e){var t=i.apply(qn,Mt([e],u));return r&&d?t[0]:t};f&&n&&"function"==typeof c&&1!=c.length&&(s=f=!1);var d=this.__chain__,v=!!this.__actions__.length,p=o&&!d,h=s&&!v;if(!o&&f){t=h?t:new Kn(this);var g=e.apply(t,u);return g.__actions__.push({func:ho,args:[l],thisArg:a}),new Hn(g,d)}return p&&h?e.apply(this,u):(g=this.thru(l),p?r?g.value()[0]:g.value():g)})})),Nt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=je[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);qn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Ko(i)?i:[],e)}return this[n]((function(n){return t.apply(Ko(n)?n:[],e)}))}})),Ir(Kn.prototype,(function(e,t){var n=qn[t];if(n){var r=n.name+"";Me.call(Cn,r)||(Cn[r]=[]),Cn[r].push({name:t,func:n})}})),Cn[qi(a,2).name]=[{name:"wrapper",func:a}],Kn.prototype.clone=function(){var e=new Kn(this.__wrapped__);return e.__actions__=Ri(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ri(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ri(this.__views__),e},Kn.prototype.reverse=function(){if(this.__filtered__){var e=new Kn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Kn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ko(e),r=t<0,i=n?e.length:0,a=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=_n(t,e+o);break;case"takeRight":e=bn(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=a.start,u=a.end,s=u-o,c=r?u:o-1,f=this.__iteratees__,l=f.length,d=0,v=_n(s,this.__takeCount__);if(!n||!r&&i==s&&v==s)return gi(e,this.__actions__);var p=[];e:for(;s--&&d<v;){for(var h=-1,g=e[c+=t];++h<l;){var m=f[h],y=m.iteratee,w=m.type,b=y(g);if(2==w)g=b;else if(!b){if(1==w)continue e;break e}}p[d++]=g}return p},qn.prototype.at=go,qn.prototype.chain=function(){return po(this)},qn.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},qn.prototype.next=function(){this.__values__===a&&(this.__values__=pu(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?a:this.__values__[this.__index__++]}},qn.prototype.plant=function(e){for(var t,n=this;n instanceof zn;){var r=Fa(n);r.__index__=0,r.__values__=a,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},qn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Kn){var t=e;return this.__actions__.length&&(t=new Kn(this)),(t=t.reverse()).__actions__.push({func:ho,args:[to],thisArg:a}),new Hn(t,this.__chain__)}return this.thru(to)},qn.prototype.toJSON=qn.prototype.valueOf=qn.prototype.value=function(){return gi(this.__wrapped__,this.__actions__)},qn.prototype.first=qn.prototype.head,Ze&&(qn.prototype[Ze]=function(){return this}),qn}();"object"==i(n.amdO)&&n.amdO?(gt._=wn,(r=function(){return wn}.call(t,n,t,e))===a||(e.exports=r)):yt?((yt.exports=wn)._=wn,mt._=wn):gt._=wn}).call(this)},55:function(e,t,n){var r=n(952).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,a=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),u=new A(r||[]);return o(a,"_invoke",{value:S(e,n,u)}),a}function v(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p={};function h(){}function g(){}function m(){}var y={};l(y,s,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(P([])));b&&b!==n&&a.call(b,s)&&(y=b);var _=m.prototype=h.prototype=Object.create(y);function I(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(i,o,u,s){var c=v(e[i],e,o);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==r(l)&&a.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,u,s)}),(function(e){n("throw",e,u,s)})):t.resolve(l).then((function(e){f.value=e,u(f)}),(function(e){return n("throw",e,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}})}function S(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=E(o,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=v(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=v(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function P(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:N}}function N(){return{value:void 0,done:!0}}return g.prototype=m,o(_,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:g,configurable:!0}),g.displayName=l(m,f,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,f,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},I(k.prototype),l(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new k(d(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},I(_),l(_,f,"Generator"),l(_,s,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),s=a.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},952:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},196:function(e,t,n){var r=n(952),i=n(55)();e.exports=i;try{regeneratorRuntime=i}catch(e){"object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,n||"default");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}function r(e,n,r){return(n=t(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,t(i.key),i)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},c.apply(this,arguments)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function d(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function h(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=function(e){return e.NONE="none",e.ERROR="error",e.WARN="warn",e.INFO="info",e.DEBUG="debug",e.TRACE="trace",e}({}),m=function(e){return e.METADATA_USER="meta_user",e.METADATA_SESSION="meta_session",e.METADATA_PAGEVIEW="meta_pageview",e}({}),y=function(e){return e.CORE_TRACK="core_track",e.CORE_IDENTIFY_v3="core_identify_v3",e.CORE_ADD_USER_PROPERTIES="core_aup",e}({}),w=function(e){return e.COOKIES="cookies",e.LOCAL_STORAGE="localstorage",e}({}),b=o((function e(){i(this,e),r(this,"setItem",(function(e,t,n){sessionStorage.setItem(e,t)})),r(this,"getItem",(function(e){return sessionStorage.getItem(e)})),r(this,"removeItem",(function(e){sessionStorage.removeItem(e)}))})),_="_hp5_logger",I=function(){function t(e){var n=this;i(this,t),r(this,"persistentStorage",new b),r(this,"getLogLevelFromStorage",(function(e){return n.persistentStorage.getItem("".concat(_,".").concat(e))})),r(this,"setLogLevel",(function(e,t){n.logLevel=e,t&&n.persistentStorage.setItem("".concat(_,".").concat(t),e)})),this.logLevel=null!=e?e:g.NONE}return o(t,[{key:"log",value:function(t,n,r){if(this.logLevel!==g.NONE){var i=Array.isArray(n)||"object"===e(n)&&null!==n?n:{context:n};console.log(t,n?i:"")}}},{key:"error",value:function(e,t){[g.TRACE,g.DEBUG,g.INFO,g.WARN,g.ERROR].includes(this.logLevel)&&this.log(e,t,g.ERROR)}},{key:"warn",value:function(e,t){[g.TRACE,g.DEBUG,g.INFO,g.WARN].includes(this.logLevel)&&this.log(e,t,g.DEBUG)}},{key:"info",value:function(e,t){[g.TRACE,g.DEBUG,g.INFO].includes(this.logLevel)&&this.log(e,t,g.DEBUG)}},{key:"debug",value:function(e,t){[g.TRACE,g.DEBUG].includes(this.logLevel)&&this.log(e,t,g.DEBUG)}},{key:"trace",value:function(e,t){this.logLevel===g.TRACE&&this.log(e,t,g.TRACE)}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=new t(g.NONE)),t.instance}}]),t}(),k=I.getInstance();function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,u=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return u}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var E=function e(t,n){var r;if(n||(n=16),void 0===t&&(t=128),t<=0)return"0";var i=Math.log(Math.pow(2,t))/Math.log(n);for(r=2;i===1/0;r*=2)i=Math.log(Math.pow(2,t/r))/Math.log(n)*r;var a=i-Math.floor(i),o="";for(r=0;r<Math.floor(i);r++)o=Math.floor(Math.random()*n).toString(n)+o;if(a){var u=Math.pow(n,a);o=Math.floor(Math.random()*u).toString(n)+o}var s=parseInt(o,n);return s!==1/0&&s>=Math.pow(2,t)?e(t,n):o},O=function(){return function(e){return e.replace(/^0+/,"")}(E(53,10))},T=255,A=1024,P=340776e5,N=18e5,R=["data-heap-redact-text","data-cs-mask"],j=function(e){return"[object String]"===Object.prototype.toString.call(e)},C=function(e){return"[object Number]"===Object.prototype.toString.call(e)},B=function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},x=function(e){return"[object Object]"===Object.prototype.toString.call(e)},D=function(e){return"function"==typeof e},M=function(e,t){return(new n.g.TextEncoder).encode(e).length<=t},L=function(e){return/^\d+$/.test(e)};function U(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var J=function(e,t){var n,r="",i=0,a=U(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,u=o.codePointAt(0),s=u&&u>65535?2:1;if(!(i+s<=t))break;r+=o,i+=s}}catch(e){a.e(e)}finally{a.f()}return r},q=function(e,t){var n={};return Object.entries(e).forEach((function(e){var r=S(e,2),i=r[0],a=r[1];if(t)n[i]=a;else if(M(i,512))if(null!=a&&""!==a)if(j(a)||C(a)||B(a)){var o=a;if(j(o)&&!M(o,A))o=J(o,A),k.warn("Property ".concat(i," exceeded ").concat(A," UTF-16 code units and was truncated."));n[i]=o}else k.warn("Property ".concat(i," was omitted because its value is not a string, number or boolean."));else k.warn("Property ".concat(i," was omitted because its value is blank."));else k.warn("Property ".concat(i," was omitted because its name exceeds ").concat(512," UTF-16 code units."))})),k.trace("Sanitized properties",{before:e,after:n}),n},V=function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=S(e,2);t[0];return void 0!==t[1]})))};function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){return e.PRIVACY="privacy",e.INGEST_SERVER="ingestServer",e.METADATA_STORAGE="metadataStorage",e.EVENT_PROPERTIES_STORAGE="eventPropertiesStorage",e.CUSTOM_EVENTS="customEvents",e.DISABLE_INTERACTION_EVENTS="disableInteractionEvents",e.CLASSIC_SDK_COMPATIBILITY="classicSDKCompatibility",e.SUPPORTED_DOMAINS="supportedDomains",e.SALESFORCE_AURA="salesforceAura",e.DISABLE_SESSION_REPLAY="disableSessionReplay",e.CLEAR_EVENT_PROPERTIES_ON_NEW_USER="clearEventPropertiesOnNewUser",e.DISABLE_PAGEVIEW_AUTOCAPTURE="disablePageviewAutocapture",e.SDK="sdk",e}(K||{}),Q=function(){function e(){i(this,e),r(this,"shouldStopTracking",!1),r(this,"safestSettings",{privacy:{enableSecureCookies:!0,disableTextCapture:!0}}),r(this,"config",{})}return o(e,[{key:"setShouldStopTracking",value:function(e){this.shouldStopTracking=e}},{key:"getShouldStopTracking",value:function(){return this.shouldStopTracking}},{key:"_getEnableSecureCookiesFromClientSideConfig",value:function(e){return B(null==e?void 0:e.enableSecureCookies)?null==e?void 0:e.enableSecureCookies:B(null==e?void 0:e.secureCookie)?null==e?void 0:e.secureCookie:void 0}},{key:"normalizeClientSideConfigToHeapConfig",value:function(e){if(!e)return{};var t={disableTextCapture:e.disableTextCapture,enableSecureCookies:this._getEnableSecureCookiesFromClientSideConfig(e)},n=e.ingestServer||e.trackingServer,r=e.metadataStorage,i=e.eventPropertiesStorage,a=e.customEvents,o=e.disableInteractionEvents,u=e.classicSDKCompatibility,s=e.supportedDomains,c=e.salesforceAura,f=e.disableSessionReplay,l=e.clearEventPropertiesOnNewUser,d=e.disablePageviewAutocapture,v=e.sdk;return V({ingestServer:n,privacy:V(t),metadataStorage:r,eventPropertiesStorage:i,customEvents:a,disableInteractionEvents:o,classicSDKCompatibility:u,supportedDomains:s,salesforceAura:c,disableSessionReplay:f,clearEventPropertiesOnNewUser:l,disablePageviewAutocapture:d,sdk:v})}},{key:"_resolveToClientConfigIfAvailable",value:function(e,t){return e||t}},{key:"_resolvePrivacyConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=H({},t),r=this.safestSettings.privacy;return Object.keys(e).forEach((function(i){var a,o=e[i];i in r&&i in t&&t[i]!==o?(a=r[i],k.debug("ConfigStore -- Disagreement between client & server-side configs: Using value ".concat(a," for ").concat(i," as safest value"))):a=o,n[i]=a})),n}},{key:"_resolveStorageConfig",value:function(e){return!e||!j(e)||e.toLowerCase()!==w.LOCAL_STORAGE&&e.toLowerCase()!==w.COOKIES?w.COOKIES:e.toLowerCase()}},{key:"_resolveBoolean",value:function(e){return!!B(e)&&e}},{key:"resolveConfig",value:function(e,t){var n,i=(r(n={},K.PRIVACY,this._resolvePrivacyConfig.bind(this)),r(n,K.INGEST_SERVER,this._resolveToClientConfigIfAvailable.bind(this)),r(n,K.METADATA_STORAGE,this._resolveStorageConfig.bind(this)),r(n,K.EVENT_PROPERTIES_STORAGE,this._resolveStorageConfig.bind(this)),r(n,K.CUSTOM_EVENTS,this._resolveToClientConfigIfAvailable.bind(this)),r(n,K.DISABLE_INTERACTION_EVENTS,this._resolveToClientConfigIfAvailable.bind(this)),r(n,K.CLASSIC_SDK_COMPATIBILITY,this._resolveBoolean.bind(this)),r(n,K.SUPPORTED_DOMAINS,this._resolveToClientConfigIfAvailable.bind(this)),r(n,K.SALESFORCE_AURA,this._resolveToClientConfigIfAvailable.bind(this)),r(n,K.DISABLE_SESSION_REPLAY,this._resolveBoolean.bind(this)),r(n,K.CLEAR_EVENT_PROPERTIES_ON_NEW_USER,this._resolveBoolean.bind(this)),r(n,K.DISABLE_PAGEVIEW_AUTOCAPTURE,this._resolveBoolean.bind(this)),r(n,K.SDK,this._resolveToClientConfigIfAvailable.bind(this)),n),a=this.normalizeClientSideConfigToHeapConfig(e),o=H({},t);return Object.keys(i).forEach((function(e){var n=i[e](null==a?void 0:a[e],null==t?void 0:t[e]);o[e]=n})),k.trace("resolved config",{clientSideConfig:e,normalizedClientSideConfig:a,serverSideConfig:t,resolvedConfig:o}),o}},{key:"setConfig",value:function(e){this.config=e}},{key:"getConfig",value:function(){return this.config}},{key:"getEnableSecureCookies",value:function(){var e;return!(null===(e=this.config.privacy)||void 0===e||!e.enableSecureCookies)}},{key:"getIntegrations",value:function(){return this.config.integrations||[]}},{key:"getIngestServer",value:function(){return this.getConfig().ingestServer||"https://c.us.heap-api.com"}},{key:"getMetadataStorageType",value:function(){return this.config.metadataStorage||w.COOKIES}},{key:"getEventPropertiesStorageType",value:function(){return this.config.eventPropertiesStorage||w.COOKIES}},{key:"isSessionReplayDisabled",value:function(){return this.config.disableSessionReplay}},{key:"getClearEventPropertiesOnNewUser",value:function(){return this.config.clearEventPropertiesOnNewUser}},{key:"getDisablePageviewAutocapture",value:function(){return this.config.disablePageviewAutocapture}},{key:"getCsHeapTagStatus",value:function(){var e;return null===(e=this.config.csSettings)||void 0===e?void 0:e.heapTagStatus}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),W=function(e){return e.None="None",e.Lax="Lax",e}({}),G=function(){return navigator.userAgent},Y=function(){return e=12,!!(t=G().match(/\(iP.+; CPU .*OS (\d+)[_\d]*.*\) AppleWebKit\//))&&parseInt(t[0],10)===e||function(e,t){var n=G().match(/\(Macintosh;.*Mac OS X (\d+)_(\d+)[_\d]*.*\) AppleWebKit\//);if(!n)return!1;var r=parseInt(n[0],10),i=parseInt(n[1],10);return r===e&&i===t}(10,14)&&(/Version\/.* Safari/.test(G())&&!X()||$());var e,t},$=function(){return/^Mozilla\/[.\d]+ \(Macintosh;.*Mac OS X [_\d]+\) AppleWebKit\/[.\d]+ \(KHTML, like Gecko\)$/.test(G())},X=function(){return/Chrom(e|ium)/.test(G())},Z=function(e){var t=G().match(/Chrom[^ /]+\/(\d+)[.\d]* /),n=0;return t&&(n=parseInt(t[0],10)),n>=e},ee=function(){return/UCBrowser\//.test(G())?!function(e,t,n){var r=G().match(/UCBrowser\/(\d+)\.(\d+)\.(\d+)[.\d]* /);if(!r)return!1;if(0===r.length)return!1;var i=parseInt(r[0],10),a=parseInt(r[1],10),o=parseInt(r[2],10);return i!==e?i>e:a!==t?a>t:o>=n}(12,13,2):X()&&Z(51)&&!Z(67)},te=function(e){return Y()||ee()?null:e?W.None:W.Lax};function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie=o((function e(){var t=this;i(this,e),r(this,"_findHighestLevelDomain",(function(){for(var e="",n=window.location.hostname||"localhost",r="hld"+O(),i="_hp2_".concat(r),a=n.split("."),o=a.length-1;o>=0;o--)t.getItem(i)!==r&&(e=a.slice(o,a.length).join("."),t.setItem(i,r,{expires:15e4,domain:e}));t.setItem(i,r,{expires:-1,domain:e});var u=!e.match(/[a-zA-Z]/),s=e.indexOf(".")<0;return(u||s)&&(e=null),e})),r(this,"setItem",(function(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n)),u=!1;a&&a.domain||(i=t._findHighestLevelDomain());var s="https:"===document.location.protocol&&Q.getInstance().getEnableSecureCookies(),c=te(s);c&&(a=re(re({},a),{},r({},"SameSite",c))),a&&Object.keys(a).map((function(e){var t=a[e];if("expires"===e){var n=new Date,r=n.getTime()+ +a.expires;n.setTime(r),t=n.toUTCString()}t&&(o+="; ".concat(e,"=").concat(t)),"path"===e&&(u=!0),"domain"===e&&(i=t)})),u||(o+="; path=/"),i&&(o+="; domain=.".concat(i)),s&&(o+="; secure"),document.cookie=o})),r(this,"getAllCookiesMatching",(function(e,t){for(var n=new RegExp("(^|;)[ ]*"+e+"=([^;]*)","g"),r=[],i=n.exec(t);i;)r.push(decodeURIComponent(i[2])),i=n.exec(t);return r})),r(this,"getItem",(function(e){var n,r=t.getAllCookiesMatching(e,document.cookie),i=r[0];if(r.length>1&&window.heap.loaded){t.setItem(e,"delete",{expires:-1});var a=t.getAllCookiesMatching(e,document.cookie),o=r.filter((function(e){return!a.includes(e)}));o.length>0&&(i=o[0]),i&&t.setItem(e,i)}return null!==(n=i)&&void 0!==n?n:null})),r(this,"hasExpired",(function(e){return new Date>=e})),r(this,"removeItem",(function(e){t.setItem(e,"",{expires:"-60000"})}))})),ae=function(){function e(){var t=this;i(this,e),r(this,"storage",{}),r(this,"setItem",(function(e,n,r){t.storage[e]=n})),r(this,"getItem",(function(e){return t.storage[e]})),r(this,"removeItem",(function(e){delete t.storage[e]}))}return o(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function oe(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function ue(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){oe(a,r,i,o,u,"next",e)}function u(e){oe(a,r,i,o,u,"throw",e)}o(void 0)}))}}var se=n(196),ce=n.n(se),fe=function(){function e(){i(this,e)}return o(e,[{key:"setUserAgentClientHints",value:function(e){this.userAgentClientHints=e}},{key:"getUserAgentClientHints",value:function(){return this.userAgentClientHints}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),le="uach_adapter",de=function(){var e=ue(ce().mark((function e(){var t,n,r,i,a,o,u,s;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=["fullVersionList","platformVersion","model"],e.next=3,null===(t=navigator.userAgentData)||void 0===t?void 0:t.getHighEntropyValues(r);case 3:if(i=e.sent){e.next=6;break}return e.abrupt("return");case 6:return a=i.model,o=i.platformVersion,u="",s=/Chromium/.test(navigator.userAgent)?"Chromium":"Chrome",null===(n=i.fullVersionList)||void 0===n||n.forEach((function(e){var t;(null===(t=e.brand)||void 0===t?void 0:t.indexOf(s))>-1&&(u=e.version)})),e.abrupt("return",{model:a,platform_version:o,browser_version:u});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve={name:le,fn:function(){var e;null!==(e=navigator.userAgentData)&&void 0!==e&&e.getHighEntropyValues||(k.trace("UACH Adapter -- Browser does not contain UACH APIs, resolving adapter"),du.markAdapterAsResolved(le));try{de().then((function(e){k.trace("UACH Adapter -- Setting UACH on store",{uach:e}),fe.getInstance().setUserAgentClientHints(e)})).finally((function(){du.markAdapterAsResolved(le)}))}catch(e){k.error("UACH Adapter -- exception occurred while getting UACH data, resolving adapter",{error:e}),du.markAdapterAsResolved(le)}}},pe=function(){function e(){i(this,e)}return o(e,[{key:"setAPIDependencies",value:function(e){this.coreAPIs=e}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),he="_hp_ved",ge="https://heapanalytics.com",me=function(e){return e.Telemetry="telemetry",e.StatusUpdate="status",e}({}),ye=function(e){return e.ReceivedInitMessage="received_init_message",e.PreFetchMetadata="pre_fetch_metadata",e.PostFetchMetadata="post_fetch_metadata",e}({});function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var be=function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=t(e[i]));return n},_e=function(){function e(){i(this,e),r(this,"_hasInitialized",!1),this._coreApis=pe.getInstance().coreAPIs,this._storage=new ie,this._metadataStore=Rr.getInstance()}return o(e,[{key:"_noopHeap",value:function(){var e;null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - No-oping window.heap"),window.heap=be(window.heap,(function(e){return D(e)?function(){}:e}))}},{key:"_loadVLScript",value:function(){var e,t=document.createElement("script");t.type="text/javascript",t.src="https://heapanalytics.com/js/ved.js",document.head.appendChild(t),null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - VL Script has been loaded")}},{key:"_loadVLStyles",value:function(){var e;["https://heapanalytics.com/css/ved.css","https://heapanalytics.com/js/ved.css"].forEach((function(e){var t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t)})),null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - VL Styles have been loaded")}},{key:"_setVLCookie",value:function(){var e,t;null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - Setting VL cookie"),this._storage.setItem(he,"on",{expires:18e5}),null===(t=this._coreApis)||void 0===t||t.logger.trace("VisualLabeler - Cookie has been set",r({},he,this._storage.getItem(he)))}},{key:"_overrideEnvironmentId",value:function(){var e,t=this._metadataStore.getEnvironmentId();this._metadataStore.setEnvironmentId("3407116132"),vu.appid=this._metadataStore.getEnvironmentId(),null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - Overriding App ID",{before:{appId:t},after:{appId:vu.appid}})}},{key:"_initializeHeapV",value:function(e){var t;null===(t=this._coreApis)||void 0===t||t.logger.trace("Visual Labeler - Initializing window.heapV for use in the VL"),window.heapV=Object.assign({},window.heap,{source:null==e?void 0:e.source,uri:ge,loadArgs:null==e?void 0:e.data.args})}},{key:"initialize",value:function(e){var t,n,r,i,a;this._hasInitialized?null===(i=this._coreApis)||void 0===i||i.logger.trace("Visual Labeler - VL has already been initialized. Exiting"):(null===(t=this._coreApis)||void 0===t||t.logger.trace("Visual Labeler - Intializing"),this._hasInitialized=!0,this._setVLCookie(),this._overrideEnvironmentId(),null===(n=this._coreApis)||void 0===n||n.logger.trace("Visual Labeler - Flushing event queue"),null===(r=this._coreApis)||void 0===r||r.flushEventQueue(),this._initializeHeapV(e),window.heapV?(this._loadVLScript(),this._loadVLStyles(),this._noopHeap()):null===(a=this._coreApis)||void 0===a||a.logger.trace("Visual Labeler - heapV not initialized. Exiting"))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function Ie(t){var n,r=null===(n=pe.getInstance().coreAPIs)||void 0===n?void 0:n.logger;t.origin===ge&&("object"===e(t.data)?"init"===t.data.message?t.source?(null==r||r.trace("Visual Labeler - Init message received"),ke(t.source),_e.getInstance().initialize(t)):null==r||r.trace("Visual Labeler - Post message `source` not provided. Exiting",{event:t}):null==r||r.trace('Visual Labeler - Disregarding non "init" post message',{event:t}):null==r||r.trace("Visual Labeler - Post message `data` is not an object. Exiting",{event:t}))}var ke=function(e){e.postMessage({type:me.StatusUpdate,value:ye.ReceivedInitMessage},{targetOrigin:"*"})},Se=[{adapter:ve,config:{isBlocking:!0,blockDurationInMs:1e3}},{adapter:{name:"visualLabeler",fn:function(e){var t,n,r;pe.getInstance().setAPIDependencies(e),null==(n=null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.logger)||n.trace("Visual Labeler - Listening for postmessage"),window.addEventListener("message",Ie),r=new ie,window.top===window.self&&r.getItem(he)&&_e.getInstance().initialize()}},config:{isBlocking:!1}}],Ee=["auryc","session_replay","cslite"],Oe=function(){function e(){i(this,e),r(this,"apiQueue",[]),r(this,"onReadyQueue",[]),r(this,"onReadyQueueHasBeenFlushed",!1)}return o(e,[{key:"enqueueHeapApi",value:function(e){k.debug("enqueuing API function",e),this.apiQueue.push(e)}},{key:"enqueueOnReady",value:function(e){k.debug("enqueuing onReady function",e),this.onReadyQueue.push(e)}},{key:"dequeueHeapApi",value:function(){return this.apiQueue.shift()}},{key:"dequeueOnReady",value:function(){return this.onReadyQueue.shift()}},{key:"executeHeapApiQueue",value:function(){for(;this.apiQueue.length>0;){var e=this.dequeueHeapApi();try{var t;null==e||null===(t=e.fn)||void 0===t||t.call(e)}catch(t){k.warn("FunctionQueue -- exception thrown when executing API callback, ignoring and continuing",{fn:e})}}}},{key:"executeStopTrackingAndStopRecording",value:function(){var e=[];this.apiQueue=this.apiQueue.filter((function(t){return!["stopTracking","stopRecording"].includes(t.name)||(e.push(t),!1)})),e.forEach((function(e){try{e.fn()}catch(t){k.warn("FunctionQueue -- exception thrown when executing stopTracking/stopRecording API callback, ignoring and continuing",{fn:e})}}))}},{key:"executeOnReadyQueue",value:function(){var e=h(this.onReadyQueue);for(k.debug("executeOnReadyQueue -- executing onReady function queue",{queue:e});this.onReadyQueue.length>0;){var t=this.dequeueOnReady();try{var n;null==t||null===(n=t.fn)||void 0===n||n.call(t)}catch(e){k.warn("FunctionQueue -- exception thrown when executing onReady callback, ignoring and continuing",{fn:t})}}this.onReadyQueueHasBeenFlushed=!0}},{key:"getApiQueue",value:function(){return this.apiQueue}},{key:"getOnReadyQueue",value:function(){return this.onReadyQueue}},{key:"getOnReadyQueueHasBeenFlushed",value:function(){return this.onReadyQueueHasBeenFlushed}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=5e3,Ne=function(){function e(){i(this,e),r(this,"startProcessingTime",Number.MAX_SAFE_INTEGER),r(this,"adapters",[]),r(this,"hasProcessingBeenCalled",!1),r(this,"adapterResolvedState",{})}return o(e,[{key:"registerAdapter",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isBlocking:!1};this.hasProcessingBeenCalled||this.adapters.find((function(t){return t.name===e.name}))||(this.adapters.push({name:e.name,adapterFn:e.fn,config:Ae(Ae({},n),{},{blockDurationInMs:n.blockDurationInMs&&n.blockDurationInMs<Pe?n.blockDurationInMs:Pe,rerunOnNewPageview:null!==(t=n.rerunOnNewPageview)&&void 0!==t&&t})}),this.adapterResolvedState[e.name]=!n.isBlocking)}},{key:"markAdapterAsResolved",value:function(e){this.adapterResolvedState[e]?k.trace("AdapterRegistry -- adapter has already been resolved, skipping: ".concat(e)):k.trace("AdapterRegistry -- adapter has been resolved: ".concat(e)),this.adapterResolvedState[e]=!0,this.shouldBlockEventProcessing()||(kr.getInstance().flushTemporaryMetadataQueue(),vu.loaded&&!Oe.getInstance().onReadyQueueHasBeenFlushed&&Oe.getInstance().executeOnReadyQueue())}},{key:"_registerIntegrationAdapters",value:function(){var e=this,t=Q.getInstance(),n=t.getIntegrations(),r=t.isSessionReplayDisabled();n.forEach((function(t){var n=t.name,i=t.fn,a=t.config;r&&Ee.includes(n)?k.debug("AdapterRegistry -- Session replay is disabled, skipping adapter: ",{name:n}):e.registerAdapter({name:n,fn:i},a)}))}},{key:"_registerDefaultClientsideAdapters",value:function(){var e=this;Se.forEach((function(t){var n=t.adapter,r=t.config;e.registerAdapter(n,r)}))}},{key:"initializeAdapters",value:function(e){var t=this;this.dependencies=Ae(Ae({},e),{},{markAdapterAsResolved:this.markAdapterAsResolved.bind(this)}),this.hasProcessingBeenCalled?k.trace("AdapterRegistry - initializeAdapters has already been called, skipping"):(k.trace("AdapterRegistry -- begin adapter initialization"),this._registerIntegrationAdapters(),this._registerDefaultClientsideAdapters(),this.hasProcessingBeenCalled=!0,this.startProcessingTime=Date.now(),this.adapters.forEach((function(e){var r=e.name,i=e.adapterFn,a=e.config;k.trace("AdapterRegistry -- Processing adapter: ",{name:r,adapterFn:i,config:a}),i(t.dependencies),n.g.setTimeout((function(){t.markAdapterAsResolved(r)}),a.blockDurationInMs)})))}},{key:"shouldBlockEventProcessing",value:function(){return!!this.adapters.length&&(!(this.startProcessingTime+Pe<Date.now())&&(!this.hasProcessingBeenCalled||Object.values(this.adapterResolvedState).some((function(e){return!e}))))}},{key:"getAdaptersToRerunOnNewPageview",value:function(){return this.adapters.filter((function(e){return e.config.rerunOnNewPageview}))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Re=function(){function e(){i(this,e),r(this,"shouldIgnoreBlockingTransformers",!1)}return o(e,[{key:"setShouldIgnoreBlockingTransformers",value:function(e){this.shouldIgnoreBlockingTransformers=e}},{key:"getShouldIgnoreBlockingTransformers",value:function(){return this.shouldIgnoreBlockingTransformers}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),je=function(){function e(){i(this,e),r(this,"isAsync",!1)}return o(e,[{key:"transformAsync",value:function(e){return Promise.resolve(this.transform(e))}},{key:"relay",value:function(e,t){var n=this.getTarget(t);k.trace("Transformer ".concat(this.name," relaying messages to ").concat(n.name)),n.transformAndRelay(e,t)}},{key:"transformAndRelay",value:function(e,t){var r,i,a=this,o=e,u=Re.getInstance().getShouldIgnoreBlockingTransformers();if(this.isAsync&&this.transformAsync){if(u)return k.trace("Transformer ".concat(this.name," -- async and unloading, so skipping this transformer")),void this.relay(o,t);Promise.race([this.transformAsync(e),(r=5e3,i=e,new Promise((function(e){n.g.setTimeout((function(){e(i)}),r)})))]).then((function(e){a.relay(e,t)}))}else o=this.transform(e),this.relay(o,t)}}]),e}(),Ce=function(e){return e.TRACK_EVENT_CONSTRUCTION="TRACK_EVENT_CONSTRUCTION",e.ENTRY="ENTRY",e.EVENT_METADATA_ENRICHMENT="EVENT_METADATA_ENRICHMENT",e.REDACTION="REDACTION",e.PROPERTY_SANITIZATION="PROPERTY_SANITIZATION",e.EXIT="EXIT",e.ERROR="ERROR",e.SESSION_REPLAY_ENRICHMENT="SESSION_REPLAY_ENRICHMENT",e}({}),Be=function(e){return e.METADATA_EVENT_CREATION="META_EVENT_CREATION",e.BLOCK_UNTIL_CS_METADATA_IS_AVAILABLE="BLOCK_UNTIL_CS_METADATA_IS_AVAILABLE",e.METADATA_EXIT="META_EXIT",e}({}),xe=function(e){return e.IDENTITY_EVENT_CREATION="IDENTITY_EVENT_CREATION",e.IDENTITY_EXIT="IDENTITY_EXIT",e}({}),De=function(e){return e.ENTRY="ENTRY",e.PROPERTY_SANITIZATION="PROPERTY_SANITIZATION",e.USER_PROPERTIES_EVENT_CREATION="USER_PROPERTIES_EVENT_CREATION",e}({}),Me=function(e){return e.GENERAL="general",e.METADATA="metadata",e.IDENTITY="identity",e.ADD_USER_PROPERTIES="addUserProperties",e}({}),Le=function(e){if(e&&e.length){var t=function(e){var t=0;return e.forEach((function(e){var n=e.data.time;n&&(!t||n>t)&&(t=n)})),t}(e);if(t)Rr.getInstance().updateLastEventTime(t);else k.trace("Unable to find most recent event time.",{messages:e})}else k.trace("No events to update last event time against")},Ue=function(e){var t=Rr.getInstance();Le(e),t.setIdentity(e[0].data.identity)};function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var Je=function(e){l(n,e);var t=Fe(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.EXIT),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"relay",value:function(e,t){Do(e,Le)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(e){var t=Rr.getInstance();if(!t.hasQueuedMetadataEvents()){var n,r,i,a={};e.forEach((function(e){var t=e.id,o=e.type,u=e.data,s=u.time||0;o===m.METADATA_USER?(k.trace("Metadata Request - User event has been enqueued."),n=t,a=ze(ze({},a),{},{userId:t})):o===m.METADATA_SESSION?(k.trace("Metadata Request - Session event has been enqueued."),r=t,a=ze(ze({},a),{},{sessionId:t,lastEventTime:s,sessionProperties:u.session_info})):o===m.METADATA_PAGEVIEW&&(k.debug("Metadata Request - Pageview event has been enqueued."),i=t,a=ze(ze({},a),{},{pageviewId:t,pageviewProperties:u.pageview_info,lastEventTime:s}))})),t.setMetadata(a),n&&t.setHasUserBeenQueued(!0),r&&t.setHasSessionBeenQueued(!0),i&&t.setHasPageviewBeenQueued(!0)}},Ke=function(e){l(n,e);var t=qe(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Be.METADATA_EXIT),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"relay",value:function(e,t){Do(e,He)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je),Qe=/[a-zA-Z0-9._%+-]+(?:@|%40|%2540)[a-zA-Z0-9.%-_]+((?:\.|%2[eE])[a-zA-Z0-9-]+)+/g,We=/[a-zA-Z0-9+_-](?:@|%40|%2540)/,Ge="([-A-Za-z0-9+/=_]|=[^=]|={3,})+",Ye=new RegExp("(ey".concat(Ge,"\\.ey").concat(Ge,"\\.").concat(Ge,")"),"g"),$e=/[0-9]{4}/,Xe=/(^|[^a-zA-Z0-9*.,-])([45*][0-9*]{3}([ -]?)[0-9*]{4}\3[0-9*]{4}\3[0-9*]{4})($|[^a-zA-Z0-9*.,-])/g,Ze=function(){function e(){i(this,e)}return o(e,[{key:"anonymizePII",value:function(e){return"string"==typeof e&&(e=this.anonymizeEmail(e)),e}},{key:"anonymizeEmail",value:function(e){return We.test(e)?e.replace(Qe,"CS_ANONYMIZED_EMAIL"):e}},{key:"anonymizeCreditCard",value:function(e){var t=this;return $e.test(e)?e.replace(Xe,(function(e,n,r,i,a){if(-1===r.indexOf("*")){var o=i.length?r.split(i).join(""):r;if(!t.checkLuhn(o))return e}return"".concat(n).concat("CS_ANONYMIZED_PII").concat(a)})):e}},{key:"checkLuhn",value:function(e){for(var t=parseInt(e[e.length-1],10),n=0,r=e.length-2;r>=0;r--){var i=parseInt(e[r],10);r%2==0&&(i*=2),n+=Math.floor(i/10)+i%10}return 10-n%10===t}},{key:"anonymizeJwt",value:function(e){return e.replace(Ye,"CS_ANONYMIZED_JWT")}},{key:"anonymizeFields",value:function(e,t){var n=this;return t.forEach((function(t){e[t]=n.anonymizeEmail(e[t])})),e}}]),e}(),et=function(e){return e.HeapSideloadsCS="heap_sideloads_cs",e.CsSideloadsHeap="cs_sideloads_heap",e.HeapDrivesCS="heap_drives_cs",e.MappingOnly="mapping_only",e}({}),tt=[et.HeapSideloadsCS,et.HeapDrivesCS],nt=function(){if(rt())return!1;var e=Q.getInstance().getCsHeapTagStatus();return e&&tt.includes(e)},rt=function(){return!("236035469"!==Rr.getInstance().getEnvironmentId()||!window.location.hostname.includes("contentsquare.com"))},it=[et.CsSideloadsHeap],at=[et.CsSideloadsHeap,et.HeapSideloadsCS],ot=function(){var e=Q.getInstance().getCsHeapTagStatus();return e&&it.includes(e)},ut=function(e){return e.OnNextPageviewOnly="onNextPageviewOnly",e.UserSession="userSession",e}({}),st=["id_token","access_token","refresh_token","auth_token"].map((function(e){return new RegExp(e+"(=|%3D).*?(?=%26|&|$)","gi")})),ct=function(e){var t;(t=function(e){if(!e||!j(e))return e;var t=e;return st.forEach((function(e){t=t.replace(e,(function(e){var t=-1===e.indexOf("=")?"%3D":"=";return e.split(t)[0]+t+"heap_redacted"}))})),t}(e),ot())&&(t=(new Ze).anonymizeJwt(t));return t},ft=o((function e(){var t=this;i(this,e),r(this,"setItem",(function(e,t,n){var r={value:t};if(null!=n&&n.expires){var i=new Date;r.expires=i.getTime()+ +(null==n?void 0:n.expires)}localStorage.setItem(e,JSON.stringify(r))})),r(this,"getItem",(function(e){var n=localStorage.getItem(e);if(!n)return null;var r=JSON.parse(n);return r.expires&&t.hasExpired(r.expires)?(t.removeItem(e),null):r.value})),r(this,"hasExpired",(function(e){return(new Date).getTime()>=e})),r(this,"removeItem",(function(e){localStorage.removeItem(e)}))})),lt="props",dt="id",vt="ses_props";function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gt=function(e){var t=Rr.getInstance().getEnvironmentId();return"".concat("_hp2_").concat(e,".").concat(t)},mt=function(e){var t=new ie,n=gt(e);return t.getItem(n)},yt=function(){var e=mt(dt);if(e){var t=null,n=JSON.parse(e),r=n.userId,i=n.identity,a=n.sessionId,o={userId:r,identity:i};a!==Rr.getInstance().getSessionId()&&(t=function(e){var t,n,r,i,a,o,u,s,c,f,l=mt(vt);if(!l)return null;var d=JSON.parse(l);return{sessionId:e,sessionProperties:{id:e,time:d.ts,referrer:null!==(t=d.r)&&void 0!==t?t:"",utm:{source:null!==(n=d.us)&&void 0!==n?n:"",medium:null!==(r=d.um)&&void 0!==r?r:"",term:null!==(i=d.ut)&&void 0!==i?i:"",content:null!==(a=d.uc)&&void 0!==a?a:"",campaign:null!==(o=d.ua)&&void 0!==o?o:""},initial_pageview_info:{time:d.ts,id:"",url:{domain:null!==(u=d.d)&&void 0!==u?u:"",path:null!==(s=d.h)&&void 0!==s?s:"",query:null!==(c=d.q)&&void 0!==c?c:"",hash:null!==(f=d.g)&&void 0!==f?f:""}}},lastEventTime:e?(new Date).getTime():void 0}}(a));var u,s=ht(ht({},o),t);k.trace("Migration -- updating metadata",{metadata:s}),u=s,Rr.getInstance().setMetadata(u)}},wt=function(){yt(),function(){var e=mt(lt);if(e){var t=JSON.parse(e);k.trace("Migration -- updating event properties",{properties:t}),window.heap.clearEventProperties(),window.heap.addEventProperties(t)}}(),(new bt).removeClassicCookiesIfNeeded()},bt=function(){function e(){var t=this;i(this,e),r(this,"_storage",new ie),r(this,"_idCookie",gt(dt)),r(this,"_sessionPropertiesCookie",gt(vt)),r(this,"_eventPropertiesCookie",gt(lt)),r(this,"shouldWriteToV4",(function(){var e;return null!==(e=Q.getInstance().getConfig().classicSDKCompatibility&&t.classicCookiesExist())&&void 0!==e&&e})),r(this,"classicCookiesExist",(function(){return t._storage.getItem(t._idCookie)||t._storage.getItem(t._sessionPropertiesCookie)||t._storage.getItem(t._eventPropertiesCookie)})),r(this,"updateIdCookie",(function(e){t._storage.setItem(t._idCookie,JSON.stringify(e),{expires:P}),k.trace("Updated v4 cookie id ".concat(t._idCookie),e)})),r(this,"updateSessionPropertiesCookie",(function(e){var n,r,i,a,o,u,s,c,f,l,d,v,p;if(e){var h={ts:e.time,r:e.referrer,us:null===(n=e.utm)||void 0===n?void 0:n.source,um:null===(r=e.utm)||void 0===r?void 0:r.medium,ut:null===(i=e.utm)||void 0===i?void 0:i.term,uc:null===(a=e.utm)||void 0===a?void 0:a.content,ua:null===(o=e.utm)||void 0===o?void 0:o.campaign,d:null===(u=e.initial_pageview_info)||void 0===u||null===(s=u.url)||void 0===s?void 0:s.domain,h:null===(c=e.initial_pageview_info)||void 0===c||null===(f=c.url)||void 0===f?void 0:f.path,q:null===(l=e.initial_pageview_info)||void 0===l||null===(d=l.url)||void 0===d?void 0:d.query,g:null===(v=e.initial_pageview_info)||void 0===v||null===(p=v.url)||void 0===p?void 0:p.hash},g=t._removeEmptyValues(h);t._storage.setItem(t._sessionPropertiesCookie,JSON.stringify(g),{expires:N}),k.trace("Updated v4 session properties ".concat(t._sessionPropertiesCookie),g)}else t._storage.removeItem(t._sessionPropertiesCookie)})),r(this,"updateMetadata",(function(e){var n={userId:e.userId,sessionId:e.sessionId,identity:e.identity},r=e.sessionProperties;t.updateIdCookie(n),t.updateSessionPropertiesCookie(r)})),r(this,"updateEventProperties",(function(e){t._storage.setItem(t._eventPropertiesCookie,JSON.stringify(e),{expires:P}),k.trace("Updated v4 event properties ".concat(t._eventPropertiesCookie),e)})),r(this,"updateSessionPropsExpiration",(function(e){var n=t._storage.getItem(t._sessionPropertiesCookie);n&&(t._storage.setItem(t._sessionPropertiesCookie,n,{expires:e}),k.trace("Updated v4 session properties ".concat(t._sessionPropertiesCookie," expiration"),e))})),r(this,"removeClassicCookiesIfNeeded",(function(){t.shouldWriteToV4()||(t._storage.removeItem(t._idCookie),t._storage.removeItem(t._sessionPropertiesCookie),t._storage.removeItem(t._eventPropertiesCookie))}))}return o(e,[{key:"_removeEmptyValues",value:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=S(e,2);t[0];return""!==t[1]})))}}],[{key:"deleteV4Cookies",value:function(){var e=gt(dt),t=gt(vt),n=gt(lt),r=new ie;r.removeItem(e),r.removeItem(t),r.removeItem(n)}}]),e}();function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kt=function(){function e(t){i(this,e),r(this,"_dualWriteToV4",new bt),this.storageType=t,this._storage=this._getStorageType()}return o(e,[{key:"_isStorageBlocked",value:function(){return Q.getInstance().getShouldStopTracking()}},{key:"_getStorageType",value:function(){var e=Q.getInstance().getConfig(),t=this.storageType||e.eventPropertiesStorage;return(null==t?void 0:t.toLowerCase())===w.LOCAL_STORAGE?new ft:new ie}},{key:"_getStorageKey",value:function(){var e=Rr.getInstance();return"".concat("_hp5_event_props",".").concat(e.getEnvironmentId())}},{key:"clearProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._storage.removeItem(this._getStorageKey()),k.debug("Cleared event properties in persistent storage"),e&&this._dualWriteToV4.shouldWriteToV4()&&this._dualWriteToV4.updateEventProperties({})}},{key:"addProperties",value:function(e){if(!this._isStorageBlocked()){var t=this.getProperties(),n=It(It({},t),e);this._storage.setItem(this._getStorageKey(),JSON.stringify(n),{expires:P}),k.debug("Updated event property values in persistent storage",{before:t,after:n}),this._dualWriteToV4.shouldWriteToV4()&&this._dualWriteToV4.updateEventProperties(n)}}},{key:"getProperties",value:function(){return JSON.parse(this._storage.getItem(this._getStorageKey())||"{}")}},{key:"removeEventProperty",value:function(e){var t=It({},this.getProperties());delete t[e],k.debug("Removed event property ".concat(e," from persistent storage"),{before:this.getProperties(),after:t}),this._storage.setItem(this._getStorageKey(),JSON.stringify(t),{expires:P}),this._dualWriteToV4.shouldWriteToV4()&&this._dualWriteToV4.updateEventProperties(t)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot=function(e){var t=new RegExp("#.*");return e.replace(t,"")},Tt=function(e,t){t=t||window.location.search,e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);if(null===n)return"";try{return decodeURIComponent(n[1].replace(/\+/g," "))}catch(e){return""}},At=function(e){if(!e)return e;var t=new RegExp("^(?:(?:https?|ftp):)/*(?:[^@]+@)?([^:/#]+)").exec(e);return t?t[1]:e},Pt=function(){var e,t=null===(e=Rr.getInstance().getMetadata().sessionProperties)||void 0===e?void 0:e.referrer;return Ot(t||document.referrer)},Nt=function(e){var t,n=At(e);if(!n)return"";var r=e.slice(e.indexOf("?"));if(n.search("google.([^/?]*)$")>=0||n.search("bing.com$")>=0)t="q";else{if(!(n.search("yahoo.com$")>=0))return"";t="p"}return window.decodeURIComponent(Tt(t,r))},Rt=function(){return{source:Tt("utm_source"),medium:Tt("utm_medium"),term:Tt("utm_term"),content:Tt("utm_content"),campaign:Tt("utm_campaign")}},jt=function(){var e,t,n,r,i;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var a,o,u,s=Rr.getInstance();n=null===(a=s.getMetadata().setPath)||void 0===a?void 0:a.path,r=null===(o=s.getMetadata().setPath)||void 0===o?void 0:o.query,i=null===(u=s.getMetadata().setPath)||void 0===u?void 0:u.hash}return{domain:window.location.hostname,path:n||window.location.pathname,query:null!==(e=r)&&void 0!==e?e:ct(window.location.search),hash:null!==(t=i)&&void 0!==t?t:ct(window.location.hash)}},Ct=function(){var e=fe.getInstance().getUserAgentClientHints();return Et({user_agent:navigator.userAgent},e&&{uach:e})},Bt=function(e){var t=null!=e?e:{},n=Et(Et({},xt()),t);return n&&Object.keys(n).length>0?{properties:n}:null},xt=function(){return kt.getInstance().getProperties()};function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var Ut=function(e){l(n,e);var t=Lt(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.EVENT_METADATA_ENRICHMENT),r(u(e),"_normalizeEventTimeAgainstPageviewTime",(function(t,n){var r=t.reduce((function(e,t){return t.data.time<e?t.data.time:e}),t[0].data.time);if(r>n)return t;var i=n-r,a=t.map((function(e){var t=e.data.time+i,n=Mt(Mt({},e.data),{},{time:t});return Mt(Mt({},e),{},{data:n})}));return k.trace("Transformer ".concat(e.name," - normalized event time against pageview time"),{before:t,after:a,pageviewTime:n}),a})),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"_enrichMessageWithMetadataContext",value:function(e){var t=Rr.getInstance(),n=t.getMetadata(),r=n.userId,i=n.pageviewId,a=n.pageviewProperties,o=n.sessionProperties,u=n.identity,s=Ct(),c={name:"web",version:"5.0",platform:"web"},f={env_id:t.getEnvironmentId(),user_id:r,identity:u,base_library:c,device:s,session_info:o,pageview_info:Mt(Mt({},a),{},{id:i})};return Mt(Mt({},e),{},{data:Mt(Mt({},e.data),f)})}},{key:"transform",value:function(e){var t=this,n=Rr.getInstance();if(n.createNewUserIfNeeded(),n.createNewSessionIfNeeded(),n.createNewPageviewIfNeeded(),!n.hasQueuedMetadataEvents())return[];var r=n.getMetadata().pageviewProperties.time,i=this._normalizeEventTimeAgainstPageviewTime(e,r).map((function(e){return t._enrichMessageWithMetadataContext(e)}));return k.trace("Transformer ".concat(this.name," - added metadata context to event messages"),{before:e,after:i}),i}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function Ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var Jt=function(e){l(n,e);var t=Ft(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.EXIT),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"relay",value:function(e,t){Do(e,Ue)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var Ht=function(e){l(n,e);var t=zt(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",De.USER_PROPERTIES_EVENT_CREATION),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"_constructUserPropertiesMessage",value:function(e){var t=Rr.getInstance();return Vt(Vt({},e),{},{data:{time:e.info.time,env_id:t.getEnvironmentId(),user_id:t.getUserId(),properties:e.info.properties,device:Ct(),library:{name:"web",version:"5.0",platform:"web"}}})}},{key:"transform",value:function(e){if(!e.length||e.length>1)return k.trace("Transformer ".concat(this.name," - Invalid number of AUP event messages sent, should always expect 1 message"),{messages:e}),[];var t=e[0];if(0===Object.keys(t.info.properties).length)return k.trace("Transformer ".concat(this.name," - Invalid properties")),[];var n=this._constructUserPropertiesMessage(t);return k.trace("Transformer ".concat(this.name," - creating aup event message"),{before:t,after:n}),[n]}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var Gt=function(e){l(n,e);var t=Wt(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.PROPERTY_SANITIZATION),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"_sanitizeMessages",value:function(e){var t=e.info.properties;if(!t)return e;var n=e;if(t){var r=q(t,e.info.isAutotrack);n=Qt(Qt({},e),{},{info:Qt(Qt({},e.info),{},{properties:r})})}return n}},{key:"transform",value:function(e){var t=this,n=e.map((function(e){return t._sanitizeMessages(e)}));return k.trace("Transformer ".concat(this.name," - sanitized event messages"),{before:e,after:n}),n}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var Zt=function(e){return e.APPCUES="appcues",e.CHAMELEON="chameleon",e.SEGMENT="segment",e.CONTENTSQUARE="contentsquare",e}({}),en=function(e){l(n,e);var t=Xt(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.TRACK_EVENT_CONSTRUCTION),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"_constructSourceName",value:function(e,t){return-1!==e.toLocaleLowerCase().indexOf(Zt.CHAMELEON)?Zt.CHAMELEON:t}},{key:"constructCustomTrackPayload",value:function(e,t){var n=t?{source_properties:e.info.properties}:{properties:e.info.properties};return{custom:$t({name:e.info.event},e.info.properties&&n)}}},{key:"constructInteractionTrackPayload",value:function(e){return{interaction:$t({},e.info.properties)}}},{key:"_isSupportedSource",value:function(e){return!!e&&Object.values(Zt).includes(e.toLowerCase())}},{key:"_constructSourceLibrary",value:function(e,t){var n,r,i,a;return{source_library:$t($t({},e.info.source),{},{name:t,version:null!==(n=null===(r=e.info.source)||void 0===r?void 0:r.version)&&void 0!==n?n:"0.0.0",platform:null!==(i=null===(a=e.info.source)||void 0===a?void 0:a.platform)&&void 0!==i?i:"web"})}}},{key:"_getSourceInformation",value:function(e){var t,n={isSupported:!1};return n.name=this._constructSourceName(e.info.event,null===(t=e.info.source)||void 0===t?void 0:t.name),n.isSupported=this._isSupportedSource(n.name),n}},{key:"transform",value:function(e){var t=this,n=e.map((function(e){var n,r=e.info.isAutotrack,i=t._getSourceInformation(e);return $t($t({},e),{},{data:$t($t($t({},e.data),Bt(null===(n=e.info.properties)||void 0===n?void 0:n.snapshotProperties)),{},{event:r?t.constructInteractionTrackPayload(e):t.constructCustomTrackPayload(e,i.isSupported)},i.isSupported&&i.name&&t._constructSourceLibrary(e,i.name))})}));return k.trace("Transformer ".concat(this.name," - populated track event data"),{before:e,after:n}),n}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var nn=function(e){l(r,e);var t,n=tn(r);function r(){return i(this,r),n.apply(this,arguments)}return o(r,[{key:"transformAsync",value:(t=ue(ce().mark((function e(t){var n,r;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(JSON.stringify(t)),e.prev=1,e.next=4,this.transformFnAsync(n);case 4:return r=e.sent,k.debug("CustomTransformer ".concat(this.name," -- transformed messages with async call"),{before:t,after:r}),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(1),k.warn("CustomTransformer ".concat(this.name," -- failed to transform message asynchronously, defaulting to original messages"),{error:e.t0}),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return t.apply(this,arguments)})},{key:"transform",value:function(e){var t=JSON.parse(JSON.stringify(e));try{var n=this.transformFn(t);return k.debug("CustomTransformer ".concat(this.name," -- transformed messages"),{before:e,after:n}),n}catch(t){return k.warn("CustomTransformer ".concat(this.name," -- failed to transform message, defaulting to original messages"),{error:t}),e}}},{key:"getTarget",value:function(e){return hr(e,this.name)}}]),r}(je);function rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var an=function(){function e(){var t;i(this,e),r(this,"pipelineToTransformers",(r(t={},Me.GENERAL,[]),r(t,Me.ADD_USER_PROPERTIES,[]),r(t,Me.IDENTITY,[]),r(t,Me.METADATA,[]),t))}return o(e,[{key:"registerTransformer",value:function(e,t){var n=t||Me.GENERAL;this.pipelineToTransformers[n].find((function(t){return t.name===e.name}))?k.info("TransformerRegistry -- Transformer already registered",{transformer:e,pipeline:t}):this.pipelineToTransformers[n].push(e)}},{key:"registerTransformerFn",value:function(e,t,n){var a=function(n){l(s,n);var a=rn(s);function s(){var t;return i(this,s),r(u(t=a.call(this)),"name",e),t}return o(s,[{key:"transformFnAsync",value:function(e){throw new Error("Transformer ".concat(this.name," -- only synchronous method should be called"))}},{key:"transformFn",value:function(e){return t(e)}}]),s}(nn);this.registerTransformer(new a,n)}},{key:"registerTransformerFnAsync",value:function(e,t,n){var a=function(n){l(c,n);var a,s=rn(c);function c(){var t;return i(this,c),r(u(t=s.call(this)),"name",e),r(u(t),"isAsync",!0),t}return o(c,[{key:"transformFnAsync",value:(a=ue(ce().mark((function e(n){return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"transformFn",value:function(e){throw new Error("Transformer ".concat(this.name," -- only async method should be called"))}}]),c}(nn);this.registerTransformer(new a,n)}},{key:"removeTransformer",value:function(e,t){var n=t||Me.GENERAL,r=this.pipelineToTransformers[n].filter((function(t){return t.name!==e||(k.info("TransformerRegistry -- Transformer removed",{transformerName:e,targetPipeline:n}),!1)}));this.pipelineToTransformers[n]=r}},{key:"resetTransformers",value:function(){var e;this.pipelineToTransformers=(r(e={},Me.GENERAL,[]),r(e,Me.ADD_USER_PROPERTIES,[]),r(e,Me.IDENTITY,[]),r(e,Me.METADATA,[]),e)}},{key:"getCustomTransformers",value:function(e){return this.pipelineToTransformers[e]}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var un=function(e){var t=document.createElement("a");if(t.href=e,""===t.host){var n=t.href;t.href=n}var r=t.pathname;if(j(r))return function(e){return j(e)?e.length>0&&"/"===e[0]?e:"/"+e:e}(r)},sn=function(){var e=document.referrer;if(e)return At(e)===window.location.hostname?un(e):void 0},cn=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,n=(e=R.map((function(e){return"head title[".concat(e,"]")})).join(", "),!!document.querySelector(e)),r=document.title;return n?"****":J(r,t)},fn=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({screen_height:window.innerHeight||0,screen_width:window.innerWidth||0},null==e?void 0:e.source_properties)},ln=function(e){return e.Click="click",e.Change="change",e.Submit="submit",e.Pageview="pageview",e}({}),dn=function(e){return e.Selector="s",e.TextInNearestElement="t",e.JavaScript="j",e.Form="f",e}({}),vn=n(571),pn=/([\^$*]=)/,hn=/^\[(\S+)=(.*)\]$/,gn=/^\[([^=*]*)\]$/,mn=function(e,t){return 0===e.length?null:0===t.length?"[".concat(e,"=*]"):"[".concat(e,"=").concat(t,"]")},yn=function(e){try{var t,n,r,i;if(a=e,gn.test(a))return(t=gn.exec(e))&&null!==(n=mn(t[1],"*"))&&void 0!==n?n:e;if(function(e){return pn.test(e)}(e))return null!==(r=function(e){var t=pn.exec(e);if(!t)return e;var n=t[0],r=new RegExp("\\[(\\S+)\\"+n+"(.*)\\]").exec(e);if(!r)return e;var i=r[1],a=r[2];switch(n){case"^=":return mn(i,"".concat(a,"*"));case"$=":return mn(i,"*".concat(a));case"*=":return mn(i,"*".concat(a,"*"));default:return e}}(e))&&void 0!==r?r:e;if(function(e){return hn.test(e)}(e))return(t=hn.exec(e))&&null!==(i=mn(t[1],t[2]))&&void 0!==i?i:e}catch(t){return e}var a;return e},wn=/^([^#.[].*?)?(#.+?)?((?:\..+?)*)((?:\[.*?\])*)$/,bn=/\s+(?=(?:(?:[^[\]]*[[\]]){2})*[^[\]]*$)/,_n=/,+(?=(?:(?:[^[\]]*[[\]]){2})*[^[\]]*$)/,In=/.*@.*;.*/,kn=function(){function e(){i(this,e),r(this,"_parsedHierarchyParts",{}),r(this,"_parsedSelectorParts",{})}return o(e,[{key:"max",value:function(e){return e.length?Math.max.apply(Math,h(e)):0}},{key:"size",value:function(e){return e.constructor===Object?Object.keys(e).length:e.length}},{key:"_isSubsetOfSuperset",value:function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;for(var n=0;n<e.length;n++)if(!this.wildcardMatchesAny(e[n],t))return!1;return!0}},{key:"_cssScore",value:function(e){var t=0;return e.tag&&(t+=1),e.id&&(t+=1),t+=e.classes.length+e.attrs.length}},{key:"parseCss",value:function(e){return e.indexOf("[")<0?e.trim().split(/\s+/g):e.split(bn).map((function(e){return e.trim()})).filter(Boolean)}},{key:"cssToObj",value:function(e){var t=S((e.match(wn)||[]).slice(1),4),n=t[0],r=t[1],i=t[2],a=t[3];return{tag:n,id:r,classes:(i||"").split(".").filter(Boolean).sort(),attrs:(a||"").split("[").filter(Boolean).sort().map((function(e){return"["+e.replace(/"/g,"")})).map(yn)}}},{key:"wildcardCanShortcut",value:function(e,t){return!e||!t||-1===e.indexOf("*")}},{key:"convertWildcardStringToRegex",value:function(e){return new RegExp("^"+e.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace(/\*/g,".*")+"$")}},{key:"wildcardMatchesAny",value:function(e,t){if(t&&!(0,vn.isArray)(t))return this.wildcardMatch(e,t);for(var n=0;n<t.length;n++)if(this.wildcardMatch(e,t[n]))return!0;return!1}},{key:"wildcardMatch",value:function(e,t){if(this.wildcardCanShortcut(e,t))return e===t;var n=this.convertWildcardStringToRegex(e);return null!==t.match(n)}},{key:"_singleHierarchyMatchesSelector",value:function(e,t){if("*"===(e=e.replace("**","*").trim()))try{return In.exec(t)?1:0}catch(e){return 0}if(!t)return 0;var n=this._parsedSelectorParts[e];if(!n){var r=(n=this._parsedSelectorParts[e]=this.parseCss(e).map(this.cssToObj)).map(this._cssScore);n._score=r.reduce((function(e,t){return e+=t}),0),this.size(this._parsedSelectorParts)>1e4&&(this._parsedSelectorParts={})}var i=this._parsedHierarchyParts[t];i||(i=this._parsedHierarchyParts[t]=t.split("|").map((function(e){return e.split(";").join("").slice(1)})).map(this.cssToObj),this.size(this._parsedHierarchyParts)>1e4&&(this._parsedHierarchyParts={}));for(var a=0,o=i.length,u=n.length,s=0;s<o;s++){var c=i[s];if(a===u)break;var f=n[a],l=!f.tag||this.wildcardMatch(f.tag,c.tag),d=!f.id||this.wildcardMatch(f.id,c.id),v=!f.classes.length||this._isSubsetOfSuperset(f.classes,c.classes),p=!f.attrs.length||this._isSubsetOfSuperset(f.attrs,c.attrs);l&&d&&v&&p&&a++}return a===n.length&&n._score||0}},{key:"splitComboSelector",value:function(e){return e.split(_n)}},{key:"hierarchyMatchesSelector",value:function(e,t){var n=this;return e.indexOf(",")<0?this._singleHierarchyMatchesSelector(e,t):this.max(this.splitComboSelector(e).map((function(e){return n._singleHierarchyMatchesSelector(e,t)})))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Sn=function(e){var t=e.target;"composed"in e&&"function"==typeof e.composedPath&&(t=e.composedPath()[0]);return t},En=function(e){try{return!(!e||"function"!=typeof e.toString)&&"[object ShadowRoot]"===e.toString()}catch(e){return!1}},On=function(e){return"[object String]"===Object.prototype.toString.call(e)},Tn=function(e){return!An(e)},An=function(e){return 1===e.nodeType&&"http://www.w3.org/2000/svg"===e.namespaceURI},Pn=/(.+):nth-of-type\((\d+)\)$/,Nn=/^\w+(\.[-_\w][-_\w\d]+)*(#[-_\w][-_\w\d]+)?$/,Rn=function(e,t){var n=[];e=function(e){if(!e)return null;for(var t=e,n=0;t&&n<200;)Tn(t)&&(e=t),t=t.previousElementSibling||t.previousSibling,n+=1;return e}(e);for(var r=0,i=!Nn.test(t);e&&r<200;)Tn(e)&&e.matches&&e.matches(t)&&(i||jn(e)===t)&&n.push(e),e=e.nextElementSibling||e.nextSibling,r+=1;return n},jn=function(e){if(!e||!e.tagName)return null;var t=[e.tagName.toLowerCase()];if(e.classList.length>0)for(var n=Array.from(e.classList),r=0;r<n.length;++r){var i=n[r];t.push("."+i)}return e.type&&"select"!==e.tagName.toLowerCase()&&t.push('[type="'+e.type+'"]'),e.name&&t.push('[name="'+e.name+'"]'),""!==e.id&&"radio"!==e.type&&"checkbox"!==e.type&&t.push("#"+e.id),t.join("")},Cn=function(e){return Pn.test(e)?e.replace(Pn,"$1"):e},Bn=function(e){if(!e||!e.tagName)return null;var t=e.tagName.toLowerCase();if("input"===t){var n=e;switch(n.type){case"checkbox":case"radio":return n.checked;default:return n.value}}else if("select"===t){var r=e;return r.options[r.selectedIndex].text}return Ln(e)},xn=function(e){var t=[],n=function n(r,i){i>=50||(r.querySelectorAll(e).forEach((function(e){return t.push(e)})),r.querySelectorAll("*").forEach((function(e){e.shadowRoot&&n(e.shadowRoot,i+1)})))};return document.querySelectorAll(e).forEach((function(e){return t.push(e)})),document.querySelectorAll("*").forEach((function(e){e.shadowRoot&&n(e.shadowRoot,1)})),t},Dn=function(e,t){for(var n,r,i=t?t.target:document,a=Cn(e),o=function(e){if(Pn.test(e)){var t=e.replace(Pn,"$2");return parseInt(t,10)}return 1}(e),u=0;u<50;){if(r=[],null!==(n=i instanceof HTMLElement&&i.shadowRoot?i.shadowRoot.querySelectorAll(a):i instanceof Document?xn(a):i.querySelectorAll(a))&&n.length>0&&(r=Rn(n[0],a)),1===r.length)return r[0];if(r.length>=o)return r[o-1];if(null===(i=En(i.parentNode)?i.parentNode.host:i.parentElement))return null;u+=1}return null},Mn=function e(t,n){return t&&"BODY"!==t.tagName&&"HTML"!==t.tagName?n(t)?t:En(t.parentNode)?e(t.parentNode.host,n):null===t.parentElement?null:e(t.parentElement,n):null},Ln=function(e){return e.innerText||e.textContent||""},Un=function(e){return e&&e.form||Fn(e)},Fn=function(e){for(;e&&"tagName"in e&&(void 0===e.tagName||"form"!==e.tagName.toLowerCase());)e=En(e.parentNode)?e.parentNode.host:e.parentNode;return e};function Jn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Vn=function(){return document},zn=function(e){if(""!==e.id){var t=Vn().querySelector("label#".concat(e.id)),n=null==t?void 0:t.textContent;if(n)return n}return e.value},Hn=function(e){switch(e.tagName.toLowerCase()){case"input":var t=e;switch(t.type){case"date":case"email":return function(e){return e.validity.valid?e.value:null}(t);case"password":return"****";case"checkbox":return function(e){var t="input[type=checkbox][name=".concat(e.name,"]"),n=Vn().querySelectorAll(t),r=Array.from(n);if(r.length>1){var i,a=[],o=Jn(r);try{for(o.s();!(i=o.n()).done;){var u=i.value;u instanceof HTMLInputElement&&u.checked&&a.push(u.value)}}catch(e){o.e(e)}finally{o.f()}return a.join(",")}return e.checked?"true":"false"}(t);case"radio":return function(e){for(var t=Vn().querySelectorAll("input[type=radio][name=".concat(e.name,"]")),n=0;n<t.length;n++){var r=t[n];if(r.checked)return zn(r)}return e.checked?"true":"false"}(t);default:return function(e){return e.value}(t)}case"textarea":return function(e){var t=e.value;return t.length>64?t.slice(0,64):t}(e);case"select":return function(e){var t=e.options[e.selectedIndex];return t.value?new RegExp(/^[^\w]/).test(t.value)&&t.value===t.innerHTML?null:t.value:null}(e);default:return"N/A"}},Kn=new Map,Qn=function(e,t){var n,r=null===(n=Q.getInstance().getConfig().snapshots)||void 0===n?void 0:n[e];if(r){var i,a,o=(i=function(e,t){var n=[];for(var i in r)if("pageview"===e)Wn(i,t)&&n.push(r[i]);else{var a=Cn(i);kn.getInstance().hierarchyMatchesSelector(a,t)>0&&n.push(r[i])}return n},a=function(e,t){return e+"."+t},function(){var e=a?a.apply(void 0,arguments):arguments.length<=0?void 0:arguments[0];if(Kn.has(e))return Kn.get(e);var t=i.apply(void 0,arguments);return Kn.set(e,t),t})(e,t);return k.trace("Snapshots - ".concat(e," definitions for ").concat(t),{snapshotConfig:r,eventType:e,capturedElement:t,snapshots:o}),o}k.trace("Snapshots - no config found for ".concat(e," snapshots"))},Wn=function(e,t){var n;if(""!==e){try{n=encodeURIComponent(t)}catch(e){return k.warn("Snapshots - error encoding pageview path",e),!1}var r=new RegExp("^"+e.replace(/\*/g,".*")+"$");return r.test(t)||r.test(n)}return!1},Gn=function(e){return j(e)?J(e.trim(),T):e},Yn=function(e,t){if(e){t=t||window.event;var n={f:function(e){var n=Dn(e,t);if(!n)return"N/A";var r=Hn(n);return Gn(r)},t:function(e){var n,r=(n=Dn(e,t),Bn(n));return Gn(r)},s:function(e){var t=xn(e);if(t){var n=Bn(t[0]);return Gn(n)}},j:function(e){try{var t=e();return Gn(t)}catch(e){return void k.warn("Snapshots - error running javascript snapshot",e)}}},r=Object.values(dn).map((function(t){var r=n[t];if(r){var i=e.map((function(e){return e[t]})).map((function(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n))try{var i=e[n],a=r(i);void 0!==a&&(t[n]=a)}catch(e){k.warn("Snapshots - Error extracting ".concat(n),{e:e})}return t})).filter((function(e){return 0!==Object.keys(e).length}));return i}})).flat(),i=r.reduce((function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}),{}),a=i?q(i):{};return k.trace("Snapshots - properties",{snapshotProperties:a}),a}};function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var er=function(e){l(n,e);var t=Zn(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Be.METADATA_EVENT_CREATION),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"_createUserEventMessage",value:function(e){var t,n=e.time,r=e.userId,i=e.sessionId,a=e.pageviewId,o=Rr.getInstance(),u=Pt(),s=Ct(),c={name:"web",version:"5.0",platform:"web"};return{time:n,id:r,user_id:r,identity:o.getIdentity()||"",base_library:c,device:s,env_id:o.getEnvironmentId(),user:{time:n,id:r,identity:o.getIdentity(),initial_session_info:{referrer:u,time:n,id:i,search_keyword:Nt(u),utm:Rt(),initial_pageview_info:{time:n,id:a,url:jt(),source_properties:fn(),properties:null===(t=o.getMetadata().pageviewProperties)||void 0===t?void 0:t.properties}}}}}},{key:"_createSessionEventMessage",value:function(e){var t,n=e.time,r=e.sessionId,i=e.userId,a=e.pageviewId,o=Rr.getInstance(),u=Pt(),s=Ct(),c={name:"web",version:"5.0",platform:"web"},f=null!=i?i:o.getUserId();return{time:n,id:r,env_id:o.getEnvironmentId(),user_id:f,identity:o.getIdentity()||"",base_library:c,device:s,session_info:{time:n,referrer:u,id:r,search_keyword:Nt(u),utm:Rt(),initial_pageview_info:{time:n,id:a,title:cn(),previous_page:sn(),url:jt(),source_properties:fn(),properties:null===(t=o.getMetadata().pageviewProperties)||void 0===t?void 0:t.properties}},session:{}}}},{key:"_createPageviewEventMessage",value:function(e){var t,n=e.time,r=e.pageviewId,i=e.sessionMessage,a=e.userId,o=e.overridePageviewInfo,u=Rr.getInstance(),s=null!=a?a:u.getUserId(),c=i?i.session_info:u.getMetadata().sessionProperties,f=Ct(),l={name:"web",version:"5.0",platform:"web"},d=jt(),v=Qn(ln.Pageview,d.path),p=Yn(v);return Xn({time:n,id:r,env_id:u.getEnvironmentId(),user_id:s,identity:u.getIdentity()||"",base_library:l,device:f,session_info:c,pageview_info:Xn({time:n,id:r,url:d,title:cn(),previous_page:sn(),source_properties:fn(o),properties:null===(t=u.getMetadata().pageviewProperties)||void 0===t?void 0:t.properties},o),pageview:{}},Bt(p))}},{key:"transform",value:function(e){if(!e.length||e.length>1)return k.trace("Transformer ".concat(this.name," - Invalid number of metadata event messages sent, should always expect 1 message"),{messages:e}),[];var t=[],n=e[0],r=n.type,i=n.id,a=n.overrideProps,o=(new Date).getTime();if(r===m.METADATA_USER){k.debug("Transformer ".concat(this.name," - Creating user + session + pageview message."));var u=i,s=O(),c=O(),f={type:m.METADATA_USER,id:u,data:this._createUserEventMessage({time:o,userId:u,sessionId:s,pageviewId:c})},l=this._createSessionEventMessage({time:o,sessionId:s,userId:u,pageviewId:c});t=[f,{type:m.METADATA_SESSION,id:s,data:l},{type:m.METADATA_PAGEVIEW,id:c,data:this._createPageviewEventMessage({time:o,pageviewId:c,sessionMessage:l,userId:u,overridePageviewInfo:null==a?void 0:a.pageviewInfo})}]}else if(r===m.METADATA_SESSION){k.debug("Transformer ".concat(this.name," - Creating session + pageview message."));var d=i,v=O(),p=this._createSessionEventMessage({time:o,sessionId:d,pageviewId:v});t=[{type:m.METADATA_SESSION,id:d,data:p},{type:m.METADATA_PAGEVIEW,id:v,data:this._createPageviewEventMessage({time:o,pageviewId:v,sessionMessage:p,overridePageviewInfo:null==a?void 0:a.pageviewInfo})}]}else if(r===m.METADATA_PAGEVIEW){k.debug("Transformer ".concat(this.name," - Creating pageview message."));var h=i;t=[{type:m.METADATA_PAGEVIEW,id:h,data:this._createPageviewEventMessage({time:o,pageviewId:h,overridePageviewInfo:null==a?void 0:a.pageviewInfo})}]}return Rr.getInstance().deleteSetPathIfExpired(),k.trace("Transformer ".concat(this.name," - creating metadata events"),{before:e,after:t}),t}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var ir=function(e){l(n,e);var t=rr(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",xe.IDENTITY_EVENT_CREATION),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"_constructIdentityMessage",value:function(e){var t=Rr.getInstance();return nr(nr({},e),{},{data:{time:e.info.time,identity:e.info.identity,env_id:t.getEnvironmentId(),user_id:e.info.user_id||t.getUserId(),library:{name:"web",version:"5.0",platform:"web"}}})}},{key:"transform",value:function(e){if(!e.length||e.length>1)return k.trace("Transformer ".concat(this.name," - Invalid number of identity event messages sent, should always expect 1 message"),{messages:e}),[];var t=e[0],n=this._constructIdentityMessage(t);return k.trace("Transformer ".concat(this.name," - creating identity event message"),{before:t,after:n}),[n]}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var or=function(e){l(n,e);var t=ar(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.ERROR),e}return o(n,[{key:"getTarget",value:function(e){return Je.getInstance()}},{key:"relay",value:function(e,t){k.error("Error transformer reached.",{messages:e,pipeline:t})}},{key:"transform",value:function(e){return[]}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je),ur=function(e){try{var t="";return window._lr_surl_cb&&window._lr_surl_cb((function(e){return t=e})),t?"logrocket:".concat(function(e,t){var n=un(e);if(!n)throw new Error("No path present on Logrocket session URL");var r=n.split("/"),i=r[1],a=r[2],o=r[4],u=r[5];if(!(i&&a&&o&&u))throw new Error("Invalid path on Logrocket session URL");return encodeURIComponent("".concat(i,"/").concat(a,"/").concat(o,"/").concat(u,"/").concat(t))}(t,e)):void 0}catch(e){return void k.trace("SessionReplay - failed to parse logrocket string - ".concat(e))}},sr=function(){try{var e,t,n=null===(e=window._uxa)||void 0===e||null===(t=e.push)||void 0===t?void 0:t.call(e,["getSessionData"]);if(!n)return;var r=n.projectId,i=n.userId,a=n.sessionNumber,o=n.pageNumber,u=n.relativeTimestamp;if(!(r&&i&&a&&o))return;return{cs_pid:r.toString(),cs_pvid:o.toString(),cs_sn:a.toString(),cs_ts:null==u?void 0:u.toString(),cs_uu:i.toString()}}catch(e){return}};function cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var dr=function(e){l(n,e);var t=lr(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.SESSION_REPLAY_ENRICHMENT),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"_getSessionReplayString",value:function(e){return[function(e){try{if(window.auryc){var t=window.auryc.getSessionMetadata(),n=t.siteId,r=t.sessionId,i=t.sampled,a=t.isOver;if(i&&!a){var o=encodeURIComponent("".concat(n,"/").concat(r,"/").concat(e));return"auryc:".concat(o)}}return}catch(e){return}}(e.data.time),ur(e.data.time),function(){try{var e="",t=sr();if(t){var n=t.cs_pid,r=t.cs_pvid,i=t.cs_sn,a=t.cs_ts,o=t.cs_uu,u=encodeURIComponent("".concat(n,"/").concat(o,"/").concat(i,"/").concat(r,"/").concat(a));e="cs:".concat(u)}return e}catch(e){return""}}()].filter((function(e){return e})).join(";")||void 0}},{key:"_enrichMessageWithSessionReplayContext",value:function(e){var t=this._getSessionReplayString(e),n=sr()||{};return t?fr(fr({},e),{},{data:fr(fr({},e.data),{},{session_replay:t,cs_properties:n})}):e}},{key:"transform",value:function(e){var t=this,n=e.map((function(e){return t._enrichMessageWithSessionReplayContext(e)}));return k.trace("Transformer ".concat(this.name," - added session replay context to event messages"),{before:e,after:n}),n}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je);function vr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var pr=function(e){l(s,e);var t,a=vr(s);function s(){var e;i(this,s);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r(u(e=a.call.apply(a,[this].concat(n))),"name",Be.BLOCK_UNTIL_CS_METADATA_IS_AVAILABLE),r(u(e),"isCsMetadataAvailable",!1),r(u(e),"isAsync",!0),e}return o(s,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"getIsCsMetadataAvailable",value:function(){return this.isCsMetadataAvailable}},{key:"setIsCsMetadataAvailable",value:function(e){this.isCsMetadataAvailable=e}},{key:"blockQueueUntilCsMetadataIsAvailable",value:function(){var e=this;return new Promise((function(t,r){var i=Date.now(),a=n.g.setTimeout((function(){var t=Date.now()-i;k.warn("Transformer ".concat(e.name," - Timeout reached after ").concat(t," ms while waiting for cs metadata, proceeding")),o()}),1e3),o=function(){n.g.clearInterval(u)},u=n.g.setInterval((function(){if(e.getIsCsMetadataAvailable()){var r=Date.now()-i;k.trace("Transformer ".concat(e.name," - cs metadata is available after ").concat(r," ms, proceeding")),o(),n.g.clearTimeout(a),t()}}),10)}))}},{key:"resumeMetadataCreation",value:function(){this.setIsCsMetadataAvailable(!0)}},{key:"transformAsync",value:(t=ue(ce().mark((function e(t){var n,r,i,a;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=void 0,(o=Q.getInstance().getCsHeapTagStatus())&&at.includes(o)){e.next=3;break}return k.trace("Transformer ".concat(this.name," - no sideloading with cs, proceeding")),e.abrupt("return",t);case 3:return k.trace("Transformer ".concat(this.name," - blocking queue until cs metadata is available")),He(t),null===(n=window._uxa)||void 0===n||null===(r=n.push)||void 0===r||r.call(n,["startDataCollection"]),null===(i=window._uxa)||void 0===i||null===(a=i.push)||void 0===a||a.call(i,["afterPageView",this.resumeMetadataCreation.bind(this)]),e.next=9,this.blockQueueUntilCsMetadataIsAvailable();case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}var o}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return s.instance||(s.instance=new s),s.instance}}]),s}(je),hr=function(e,t){var n=function(e){var t=[yr.getInstance(),Ut.getInstance(),dr.getInstance(),Gt.getInstance(),en.getInstance()],n=[Je.getInstance()],r=[er.getInstance(),pr.getInstance(),dr.getInstance()],i=[Ke.getInstance()],a=[ir.getInstance(),Jt.getInstance()],o=[Jt.getInstance()],u=[yr.getInstance(),Gt.getInstance(),Ht.getInstance()],s=[Je.getInstance()],c=[],f=[],l=an.getInstance().getCustomTransformers(e);return e===Me.GENERAL?(c=t,f=n):e===Me.METADATA?(c=r,f=i):e===Me.IDENTITY?(c=a,f=o):e===Me.ADD_USER_PROPERTIES&&(c=u,f=s),[].concat(h(c),h(l),h(f))}(e),r=n.findIndex((function(e){return e.name===t}));return-1===r?(k.trace("Source transformer not found.",{sourceTransformerName:t,pipeline:e}),or.getInstance()):r===n.length-1?Je.getInstance():n[r+1]};function gr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var mr,yr=function(e){l(n,e);var t=gr(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"name",Ce.ENTRY),e}return o(n,[{key:"getTarget",value:function(e){return hr(e,this.name)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(je),wr=function(){if(!Q.getInstance().getShouldStopTracking()){k.trace("Begin flushing all messages for processing"),kr.getInstance().flushTemporaryMetadataQueue();var e=xo();e&&e.length?(k.debug("Flushing the following messages into general event pipeline",e),yr.getInstance().transformAndRelay(e,Me.GENERAL)):k.debug("No messages queued in the EPQ - terminating")}},br=function(e,t,n){if(!Q.getInstance().getShouldStopTracking()){var r=null!=t?t:O();er.getInstance().transformAndRelay([{overrideProps:n,type:e,id:r}],Me.METADATA)}},_r=function(e,t){Q.getInstance().getShouldStopTracking()||ir.getInstance().transformAndRelay([{type:y.CORE_IDENTIFY_v3,id:O(),info:{identity:e,user_id:t,time:(new Date).getTime()}}],Me.IDENTITY)},Ir=function(){Q.getInstance().getShouldStopTracking()||(mr=n.g.setInterval((function(){var e=Bo();e.length&&(k.debug("Sending events from the event processing queue to transformers",{messages:e}),yr.getInstance().transformAndRelay(e,Me.GENERAL))}),2e3))},kr=function(){function e(){i(this,e),r(this,"queue",[])}return o(e,[{key:"flushTemporaryMetadataQueue",value:function(){this.queue.length&&(k.debug("MetadataMessageQueue -- flushing the temporary metadata queue",{queue:this.queue}),this.queue.forEach((function(e){var t=e.type,n=e.id,r=e.overrideProps;br(t,n,r)})),this.queue=[])}},{key:"queueMetadataEvent",value:function(e,t,r){var i=this;Ne.getInstance().shouldBlockEventProcessing()?(k.trace("MetadataMessageQueue -- blocking metadata event until adapters are resolved",{type:e}),this.queue.push({type:e,id:t,overrideProps:r}),n.g.setTimeout((function(){k.trace("MetadataMessageQueue -- 5 seconds has passed, flushing regardless of adapter state"),i.flushTemporaryMetadataQueue()}),Pe)):br(e,t,r)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Sr=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n=function(){var n,r;t&&(null===(r=window.auryc)||void 0===r||r.clearUserCookie(!1));null===(n=window.auryc)||void 0===n||n.addUserProperties({heap_user_id:e})},r=function(){window.clearInterval(a)},i=function(){return!!(window.auryc&&window.auryc.addUserProperties&&window.auryc.clearUserCookie)};if(i())return void n();var a=window.setInterval((function(){i()&&(r(),n())}),500);window.setTimeout(r,5e3)}catch(e){return}},Er=function(e){Sr(e)},Or=function(e){var t=nt();(t||!t&&e)&&(k.debug("Contentsquare -- creating new cs user"),function(){try{var e=function(){var e;null===(e=window._uxa)||void 0===e||e.push(["session:start:newVisitor"])},t=function(){window.clearInterval(r)},n=function(){var e,t,n=null===(e=window._uxa)||void 0===e||null===(t=e.push)||void 0===t?void 0:t.call(e,["getSessionData"]);return n&&n.projectId&&n.userId};if(n())return void e();var r=window.setInterval((function(){n()&&(t(),e())}),250);window.setTimeout(t,5e3)}catch(e){return}}())};function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pr=["pageviewId","pageviewProperties"],Nr=["userId","sessionId","identity","lastEventTime","sessionProperties","setPath"],Rr=function(){function e(t,n){i(this,e),r(this,"envId",""),r(this,"_sessionExpirationTime",N),r(this,"_ephemeralStorage",ae.getInstance()),r(this,"_metadataMessageQueue",kr.getInstance()),r(this,"hasUserBeenQueued",!1),r(this,"hasSessionBeenQueued",!1),r(this,"hasPageviewBeenQueued",!1),r(this,"hasCheckedCrossDomainContext",!1),t&&(this.envId=t),n&&(this.storageType=n),this._persistentStorage=this._getStorageType()}return o(e,[{key:"_isStorageBlocked",value:function(){return Q.getInstance().getShouldStopTracking()}},{key:"_getStorageType",value:function(){var e=Q.getInstance().getMetadataStorageType(),t=this.storageType||e;return(null==t?void 0:t.toLowerCase())===w.LOCAL_STORAGE?new ft:new ie}},{key:"_getStorageKey",value:function(){return"".concat("_hp5_meta",".").concat(this.getEnvironmentId())}},{key:"_extractPersistentMetadata",value:function(e){var t={};return Object.entries(e).forEach((function(e){var n=S(e,2),r=n[0],i=n[1];Nr.includes(r)&&i&&(t[r]=i)})),t}},{key:"_extractEphemeralMetadata",value:function(e){var t={};return Object.entries(e).forEach((function(e){var n=S(e,2),r=n[0],i=n[1];Pr.includes(r)&&i&&(t[r]=i)})),t}},{key:"hasQueuedMetadataEvents",value:function(){return this.hasPageviewBeenQueued&&this.hasSessionBeenQueued&&this.hasUserBeenQueued}},{key:"setMetadata",value:function(e){if(!this._isStorageBlocked()){var t=this.getMetadata(),n=this._extractEphemeralMetadata(t),r=this._extractPersistentMetadata(t),i=this._extractEphemeralMetadata(e),a=this._extractPersistentMetadata(e),o=Ar(Ar({},r),a),u=Ar(Ar({},n),i),s=JSON.stringify(o);if(Q.getInstance().getMetadataStorageType()===w.COOKIES&&function(e){try{return(new TextEncoder).encode(e).length}catch(e){return 0}}(s)>3500){var c,f,l,d,v,p,h,g,m,y,b,_,I,S,E,O,T,N,R,j,C,B;k.debug("MetadataStore -- persistent values larger than cookie size, setting ids first then attempting truncation");var x=Ar(Ar({},o),{},{sessionProperties:{id:null===(c=o.sessionProperties)||void 0===c?void 0:c.id,time:null===(f=o.sessionProperties)||void 0===f?void 0:f.time,initial_pageview_info:{id:null===(l=o.sessionProperties)||void 0===l||null===(d=l.initial_pageview_info)||void 0===d?void 0:d.id,time:null===(v=o.sessionProperties)||void 0===v||null===(p=v.initial_pageview_info)||void 0===p?void 0:p.time}}});this._persistentStorage.setItem(this._getStorageKey(),JSON.stringify(x),{expires:P});var D=Ar(Ar({},o),{},{sessionProperties:Ar(Ar({},o.sessionProperties),{},{referrer:J(null!==(h=null===(g=o.sessionProperties)||void 0===g?void 0:g.referrer)&&void 0!==h?h:"",A),search_keyword:J(null!==(m=null===(y=o.sessionProperties)||void 0===y?void 0:y.search_keyword)&&void 0!==m?m:"",A),utm:q(null!==(b=null===(_=o.sessionProperties)||void 0===_?void 0:_.utm)&&void 0!==b?b:{}),initial_pageview_info:Ar(Ar({},null===(I=o.sessionProperties)||void 0===I?void 0:I.initial_pageview_info),{},{title:J(null!==(S=null===(E=o.sessionProperties)||void 0===E||null===(O=E.initial_pageview_info)||void 0===O?void 0:O.title)&&void 0!==S?S:"",A),url:q(null!==(T=null===(N=o.sessionProperties)||void 0===N||null===(R=N.initial_pageview_info)||void 0===R?void 0:R.url)&&void 0!==T?T:{}),previous_page:J(null!==(j=null===(C=o.sessionProperties)||void 0===C||null===(B=C.initial_pageview_info)||void 0===B?void 0:B.previous_page)&&void 0!==j?j:"",A)})})});this._persistentStorage.setItem(this._getStorageKey(),JSON.stringify(D),{expires:P}),k.trace("Updated metadata values in persistent storage",{before:r,after:D})}else k.trace("MetadataStore - persistent metadata size is acceptable - proceeding with default behavior"),this._persistentStorage.setItem(this._getStorageKey(),JSON.stringify(o),{expires:P}),k.trace("Updated metadata values in persistent storage",{before:r,after:o});this._ephemeralStorage.setItem(this._getStorageKey(),JSON.stringify(u),{expires:P}),k.trace("Updated metadata values in ephemeral storage",{before:n,after:u});var M=new bt;M.shouldWriteToV4()&&M.updateMetadata(o)}}},{key:"getMetadata",value:function(){var e=this._getStorageKey(),t=JSON.parse(this._persistentStorage.getItem(e)||"{}"),n=JSON.parse(this._ephemeralStorage.getItem(e)||"{}");return Ar(Ar({},t),n)}},{key:"deleteMetadata",value:function(){var e=this._getStorageKey();this._persistentStorage.removeItem(e)}},{key:"clearPageviewMetadata",value:function(){var e=this._getStorageKey();this._ephemeralStorage.removeItem(e),this.setHasPageviewBeenQueued(!1)}},{key:"clearMetadata",value:function(){var e=this._getStorageKey();this._persistentStorage.removeItem(e),this._ephemeralStorage.removeItem(e),this.setHasSessionBeenQueued(!1),this.setHasUserBeenQueued(!1),k.debug("Cleared metadata values in persistent storage")}},{key:"updateLastEventTime",value:function(e){if(e){k.debug("Updating lastEventTime to ".concat(e)),this.setMetadata({lastEventTime:e});var t,n,r=new bt;r.shouldWriteToV4()&&r.updateSessionPropsExpiration(e),nt()&&(k.debug("Contentsquare -- extending cs session"),null===(t=window._uxa)||void 0===t||null===(n=t.push)||void 0===n||n.call(t,["extendSessionV2"]))}else k.warn("Invalid lastEventTime passed to metadata store")}},{key:"getSessionId",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.sessionId}},{key:"getUserId",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.userId}},{key:"getIdentity",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.identity}},{key:"setIdentity",value:function(e){this.setMetadata({identity:e})}},{key:"setEnvironmentId",value:function(e){this.envId="".concat(e)}},{key:"getEnvironmentId",value:function(){if(!this.envId)throw k.error("Environment ID is missing"),new Error("heap environment id is missing");return this.envId}},{key:"getHasUserBeenQueued",value:function(){return this.hasUserBeenQueued}},{key:"getHasSessionBeenQueued",value:function(){return this.hasSessionBeenQueued}},{key:"setHasUserBeenQueued",value:function(e){this.hasUserBeenQueued=e}},{key:"setHasSessionBeenQueued",value:function(e){this.hasSessionBeenQueued=e}},{key:"setHasPageviewBeenQueued",value:function(e){this.hasPageviewBeenQueued=e}},{key:"setMetadataStateFromCrossDomainContextIfPresent",value:function(){if(!this._isStorageBlocked()&&!this.hasCheckedCrossDomainContext){this.hasCheckedCrossDomainContext=!0;var e=function(){try{var e=new URL(window.location.href).searchParams.get("_hp5_cdc");if(!e)return{};var t=S(e.split(";"),5);return{envId:t[0],userId:t[1],sessionId:t[2],sessionStartTime:t[3],identity:t[4]}}catch(e){return k.error("getCrossDomainMetadata -- failed to parse metadata from URL, defaulting to normal logic"),{}}}(),t=e.envId,n=e.userId,r=e.sessionId,i=e.identity,a=e.sessionStartTime;if(this.getEnvironmentId()===t&&n&&r)return k.debug("MetadataStore -- cross domain userid found, overriding current user"),this.setMetadata({userId:n,sessionId:r,identity:i,sessionProperties:{id:r,time:parseInt(a,10)},lastEventTime:(new Date).getTime()}),this.hasUserBeenQueued=!0,this.hasSessionBeenQueued=!0,void Er(n)}}},{key:"getPageviewProperties",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.pageviewProperties}},{key:"getCustomPageviewProperties",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.pageviewProperties.properties}},{key:"addCustomPageviewProperties",value:function(e){var t=this.getPageviewProperties(),n=Ar(Ar({},null==t?void 0:t.properties),e);this.setMetadata({pageviewProperties:Ar(Ar({},t),{},{properties:n})})}},{key:"removeCustomPageviewProperty",value:function(e){var t=Ar({},this.getCustomPageviewProperties());delete t[e],k.debug("Removed custom pageview property ".concat(e," from storage"),{before:this.getCustomPageviewProperties(),after:t});var n=this.getPageviewProperties();this.setMetadata({pageviewProperties:Ar(Ar({},n),{},{properties:t})})}},{key:"clearCustomPageviewProperties",value:function(){var e=this.getPageviewProperties();k.trace("MetadataStore -- clearing custom pageview properties"),this.setMetadata({pageviewProperties:Ar(Ar({},e),{},{properties:{}})})}},{key:"clearEventPropertiesIfNeeded",value:function(){var e=Q.getInstance().getClearEventPropertiesOnNewUser(),t=kt.getInstance();e&&(k.debug("Clearing event properties"),t.clearProperties())}},{key:"createNewUserIfNeeded",value:function(e){var t=this.getMetadata().userId;if(!t||null!=e&&e.newUserId&&t!==e.newUserId||!L(t)){var n;this.clearEventPropertiesIfNeeded(),this.hasUserBeenQueued=!1,this.hasSessionBeenQueued=!1,this.hasPageviewBeenQueued=!1;var r=null!==(n=null==e?void 0:e.newUserId)&&void 0!==n?n:O();null!=e&&e.identity&&_r(e.identity,r),this._metadataMessageQueue.queueMetadataEvent(m.METADATA_USER,r),Mo(),function(e){Sr(e,!0)}(r),Or(null==e?void 0:e.heapDrives)}else this.hasUserBeenQueued=!0,Er(t)}},{key:"createNewSessionIfNeeded",value:function(e){if(this.hasUserBeenQueued){var t,n,r,i,a=this.getMetadata(),o=a.sessionId,u=a.sessionProperties,s=this.hasSessionExpired();o&&!s&&L(o)&&o===(null==u?void 0:u.id)?this.hasSessionBeenQueued=!0:(this.hasSessionBeenQueued=!1,this._metadataMessageQueue.queueMetadataEvent(m.METADATA_SESSION,O()),Mo(),t=null==e?void 0:e.heapDrives,((i=nt())||!i&&t)&&(k.debug("Contentsquare -- starting cs session"),null===(n=window._uxa)||void 0===n||null===(r=n.push)||void 0===r||r.call(n,["clearSession"])))}}},{key:"createNewPageviewIfNeeded",value:function(e){if(this.hasUserBeenQueued&&this.hasSessionBeenQueued){var t=this.getMetadata().pageviewId;t&&L(t)?this.hasPageviewBeenQueued=!0:(this.hasPageviewBeenQueued=!1,this._metadataMessageQueue.queueMetadataEvent(m.METADATA_PAGEVIEW,O(),e))}}},{key:"hasSessionExpired",value:function(){var e=this.getMetadata().lastEventTime;return!e||e+this._sessionExpirationTime<(new Date).getTime()}},{key:"deleteSetPathIfExpired",value:function(){var e;(null===(e=this.getMetadata().setPath)||void 0===e?void 0:e.lifespan)===ut.OnNextPageviewOnly&&this.setMetadata({setPath:{path:void 0,query:void 0,hash:void 0,lifespan:void 0}})}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),jr=function(e){return e.EVENT_PROCESSING_QUEUE="_hp5_epq",e}({}),Cr=function(){function t(){i(this,t),r(this,"_replacerFunc",(function(){var t=new WeakSet;return function(n,r){if("object"===e(r)&&null!==r){if(t.has(r))return;t.add(r)}return r}}))}return o(t,[{key:"_getQueueIdentifier",value:function(){return"".concat(this.queueName,".").concat(Rr.getInstance().getEnvironmentId())}},{key:"_getQueuedMessages",value:function(){var e,t;return JSON.parse(null!==(e=null===(t=this.storage)||void 0===t?void 0:t.getItem(this._getQueueIdentifier()))&&void 0!==e?e:"[]")}},{key:"_getMessageIds",value:function(e){return e.map((function(e){return e.id}))}},{key:"_syncPersistentStorage",value:function(e){this.storage&&this.storage.setItem(this._getQueueIdentifier(),JSON.stringify(e,this._replacerFunc()))}},{key:"enqueueMessages",value:function(e){var t=this._getQueuedMessages(),n=this._getMessageIds(t),r=e.filter((function(e){var t=e.id;return!n.includes(t)}));t=[].concat(h(t),h(r)),this._syncPersistentStorage(t)}},{key:"dequeueMessages",value:function(e){var t=this._getQueuedMessages(),n=this._getMessageIds(e);this.bufferedIds=this.bufferedIds.filter((function(e){return!n.includes(e)})),t=t.filter((function(e){var t=e.id;return!n.includes(t)})),this._syncPersistentStorage(t)}},{key:"clearStorage",value:function(){var e;null===(e=this.storage)||void 0===e||e.removeItem(this._getQueueIdentifier())}},{key:"clearBuffer",value:function(){this.bufferedIds=[]}},{key:"getMessagesToProcess",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,n=this._getQueuedMessages().filter((function(t){var n=t.id;return!e.bufferedIds.includes(n)})).slice(0,t);return this.bufferedIds=[].concat(h(this.bufferedIds),h(this._getMessageIds(n))),n.length&&k.trace("".concat(this.queueName," - getting messages for processing"),n),n}}]),t}();function Br(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var xr=function(e){l(n,e);var t=Br(n);function n(){var e;i(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return r(u(e=t.call.apply(t,[this].concat(o))),"queueName",jr.EVENT_PROCESSING_QUEUE),r(u(e),"bufferedIds",[]),r(u(e),"storage",ae.getInstance()),e}return o(n,[{key:"_isQueueBlocked",value:function(){var e=Rr.getInstance(),t=Ne.getInstance();try{e.getEnvironmentId()}catch(e){return!0}return Q.getInstance().getShouldStopTracking()?(k.debug("EventProcessingQueue - blocked, shouldStopTracking is true"),!0):e.hasQueuedMetadataEvents()?!!t.shouldBlockEventProcessing()&&(k.debug("EventProcessingQueue - blocked, waiting for adapter initialization to complete"),!0):(k.debug("EventProcessingQueue - blocked, waiting for metadata events to be queued"),!0)}},{key:"getMessagesToProcess",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this._isQueueBlocked()?(k.debug("".concat(this.queueName," - blocked, waiting for unblock before processing")),[]):c(s(n.prototype),"getMessagesToProcess",this).call(this,e)}},{key:"getAndClearAllMessages",value:function(){var e=c(s(n.prototype),"getMessagesToProcess",this).call(this,Number.MAX_SAFE_INTEGER);return this.clearStorage(),this.clearBuffer(),e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Cr),Dr=function(){function e(){i(this,e)}return o(e,[{key:"equals",value:function(e){return this.getType().runtime.util.equals(this.getType(),this,e)}},{key:"clone",value:function(){return this.getType().runtime.util.clone(this)}},{key:"fromBinary",value:function(e,t){var n=this.getType().runtime.bin,r=n.makeReadOptions(t);return n.readMessage(this,r.readerFactory(e),e.byteLength,r),this}},{key:"fromJson",value:function(e,t){var n=this.getType(),r=n.runtime.json,i=r.makeReadOptions(t);return r.readMessage(n,e,i,this),this}},{key:"fromJsonString",value:function(e,t){var n;try{n=JSON.parse(e)}catch(e){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(e instanceof Error?e.message:String(e)))}return this.fromJson(n,t)}},{key:"toBinary",value:function(e){var t=this.getType().runtime.bin,n=t.makeWriteOptions(e),r=n.writerFactory();return t.writeMessage(this,r,n),r.finish()}},{key:"toJson",value:function(e){var t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}},{key:"toJsonString",value:function(e){var t,n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}},{key:"toJSON",value:function(){return this.toJson({emitDefaultValues:!0})}},{key:"getType",value:function(){return Object.getPrototypeOf(this).constructor}}]),e}();function Mr(e,t){if(!e)throw new Error(t)}var Lr=34028234663852886e22,Ur=-34028234663852886e22,Fr=4294967295,Jr=2147483647,qr=-2147483648;function Vr(t){if("number"!=typeof t)throw new Error("invalid int 32: "+e(t));if(!Number.isInteger(t)||t>Jr||t<qr)throw new Error("invalid int 32: "+t)}function zr(t){if("number"!=typeof t)throw new Error("invalid uint 32: "+e(t));if(!Number.isInteger(t)||t>Fr||t<0)throw new Error("invalid uint 32: "+t)}function Hr(t){if("number"!=typeof t)throw new Error("invalid float 32: "+e(t));if(Number.isFinite(t)&&(t>Lr||t<Ur))throw new Error("invalid float 32: "+t)}function Kr(){for(var e=0,t=0,n=0;n<28;n+=7){var r=this.buf[this.pos++];if(e|=(127&r)<<n,0==(128&r))return this.assertBounds(),[e,t]}var i=this.buf[this.pos++];if(e|=(15&i)<<28,t=(112&i)>>4,0==(128&i))return this.assertBounds(),[e,t];for(var a=3;a<=31;a+=7){var o=this.buf[this.pos++];if(t|=(127&o)<<a,0==(128&o))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Qr(e,t,n){for(var r=0;r<28;r+=7){var i=e>>>r,a=!(i>>>7==0&&0==t),o=255&(a?128|i:i);if(n.push(o),!a)return}var u=e>>>28&15|(7&t)<<4,s=!(t>>3==0);if(n.push(255&(s?128|u:u)),s){for(var c=3;c<31;c+=7){var f=t>>>c,l=!(f>>>7==0),d=255&(l?128|f:f);if(n.push(d),!l)return}n.push(t>>>31&1)}}var Wr=4294967296;function Gr(e){var t="-"===e[0];t&&(e=e.slice(1));var n=1e6,r=0,i=0;function a(t,a){var o=Number(e.slice(t,a));i*=n,(r=r*n+o)>=Wr&&(i+=r/Wr|0,r%=Wr)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?Xr(r,i):$r(r,i)}function Yr(e,t){var n=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t);if(e=n.lo,(t=n.hi)<=2097151)return String(Wr*t+e);var r=16777215&(e>>>24|t<<8),i=t>>16&65535,a=(16777215&e)+6777216*r+6710656*i,o=r+8147497*i,u=2*i,s=1e7;return a>=s&&(o+=Math.floor(a/s),a%=s),o>=s&&(u+=Math.floor(o/s),o%=s),u.toString()+Zr(o)+Zr(a)}function $r(e,t){return{lo:0|e,hi:0|t}}function Xr(e,t){return t=~t,e?e=1+~e:t+=1,$r(e,t)}var Zr=function(e){var t=String(e);return"0000000".slice(t.length)+t};function ei(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(var n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function ti(){var e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<7,0==(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<14,0==(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<21,0==(128&e))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(var n=5;0!=(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}var ni=function(){var t=new DataView(new ArrayBuffer(8));if(void 0!==globalThis.BigInt&&"function"==typeof t.getBigInt64&&"function"==typeof t.getBigUint64&&"function"==typeof t.setBigInt64&&"function"==typeof t.setBigUint64&&("object"!=("undefined"==typeof process?"undefined":e(process))||"object"!=e(process.env)||"1"!==process.env.BUF_BIGINT_DISABLE)){var n=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),i=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse:function(e){var t="bigint"==typeof e?e:BigInt(e);if(t>r||t<n)throw new Error("int64 invalid: ".concat(e));return t},uParse:function(e){var t="bigint"==typeof e?e:BigInt(e);if(t>a||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc:function(e){return t.setBigInt64(0,this.parse(e),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc:function(e){return t.setBigInt64(0,this.uParse(e),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec:function(e,n){return t.setInt32(0,e,!0),t.setInt32(4,n,!0),t.getBigInt64(0,!0)},uDec:function(e,n){return t.setInt32(0,e,!0),t.setInt32(4,n,!0),t.getBigUint64(0,!0)}}}var o=function(e){return Mr(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e))},u=function(e){return Mr(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e))};return{zero:"0",supported:!1,parse:function(e){return"string"!=typeof e&&(e=e.toString()),o(e),e},uParse:function(e){return"string"!=typeof e&&(e=e.toString()),u(e),e},enc:function(e){return"string"!=typeof e&&(e=e.toString()),o(e),Gr(e)},uEnc:function(e){return"string"!=typeof e&&(e=e.toString()),u(e),Gr(e)},dec:function(e,t){return function(e,t){var n=$r(e,t),r=2147483648&n.hi;r&&(n=Xr(n.lo,n.hi));var i=Yr(n.lo,n.hi);return r?"-"+i:i}(e,t)},uDec:function(e,t){return Yr(e,t)}}}();function ri(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ii(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ii(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function ii(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ai,oi,ui=Symbol("@bufbuild/protobuf/enum-type");function si(e){var t=e[ui];return Mr(t,"missing enum type on enum object"),t}function ci(e,t,n,r){e[ui]=fi(t,n.map((function(t){return{no:t.no,name:t.name,localName:e[t.no]}})),r)}function fi(e,t,n){var r,i=Object.create(null),a=Object.create(null),o=[],u=ri(t);try{for(u.s();!(r=u.n()).done;){var s=r.value,c=di(s);o.push(c),i[s.name]=c,a[s.no]=c}}catch(e){u.e(e)}finally{u.f()}return{typeName:e,values:o,findName:function(e){return i[e]},findNumber:function(e){return a[e]}}}function li(e,t,n){var r,i={},a=ri(t);try{for(a.s();!(r=a.n()).done;){var o=di(r.value);i[o.localName]=o.no,i[o.no]=o.localName}}catch(e){a.e(e)}finally{a.f()}return ci(i,e,t,n),i}function di(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(ai||(ai={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(oi||(oi={}));var vi=function(){function e(t){i(this,e),this.stack=[],this.textEncoder=null!=t?t:new TextEncoder,this.chunks=[],this.buf=[]}return o(e,[{key:"finish",value:function(){this.chunks.push(new Uint8Array(this.buf));for(var e=0,t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;for(var n=new Uint8Array(e),r=0,i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}},{key:"fork",value:function(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}},{key:"join",value:function(){var e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}},{key:"tag",value:function(e,t){return this.uint32((e<<3|t)>>>0)}},{key:"raw",value:function(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}},{key:"uint32",value:function(e){for(zr(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}},{key:"int32",value:function(e){return Vr(e),ei(e,this.buf),this}},{key:"bool",value:function(e){return this.buf.push(e?1:0),this}},{key:"bytes",value:function(e){return this.uint32(e.byteLength),this.raw(e)}},{key:"string",value:function(e){var t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}},{key:"float",value:function(e){Hr(e);var t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}},{key:"double",value:function(e){var t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}},{key:"fixed32",value:function(e){zr(e);var t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}},{key:"sfixed32",value:function(e){Vr(e);var t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}},{key:"sint32",value:function(e){return Vr(e),ei(e=(e<<1^e>>31)>>>0,this.buf),this}},{key:"sfixed64",value:function(e){var t=new Uint8Array(8),n=new DataView(t.buffer),r=ni.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}},{key:"fixed64",value:function(e){var t=new Uint8Array(8),n=new DataView(t.buffer),r=ni.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}},{key:"int64",value:function(e){var t=ni.enc(e);return Qr(t.lo,t.hi,this.buf),this}},{key:"sint64",value:function(e){var t=ni.enc(e),n=t.hi>>31;return Qr(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}},{key:"uint64",value:function(e){var t=ni.uEnc(e);return Qr(t.lo,t.hi,this.buf),this}}]),e}(),pi=function(){function e(t,n){i(this,e),this.varint64=Kr,this.uint32=ti,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=null!=n?n:new TextDecoder}return o(e,[{key:"tag",value:function(){var e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}},{key:"skip",value:function(e){var t=this.pos;switch(e){case oi.Varint:for(;128&this.buf[this.pos++];);break;case oi.Bit64:this.pos+=4;case oi.Bit32:this.pos+=4;break;case oi.LengthDelimited:var n=this.uint32();this.pos+=n;break;case oi.StartGroup:for(var r;(r=this.tag()[1])!==oi.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}},{key:"assertBounds",value:function(){if(this.pos>this.len)throw new RangeError("premature EOF")}},{key:"int32",value:function(){return 0|this.uint32()}},{key:"sint32",value:function(){var e=this.uint32();return e>>>1^-(1&e)}},{key:"int64",value:function(){return ni.dec.apply(ni,h(this.varint64()))}},{key:"uint64",value:function(){return ni.uDec.apply(ni,h(this.varint64()))}},{key:"sint64",value:function(){var e=S(this.varint64(),2),t=e[0],n=e[1],r=-(1&t);return t=(t>>>1|(1&n)<<31)^r,n=n>>>1^r,ni.dec(t,n)}},{key:"bool",value:function(){var e=S(this.varint64(),2),t=e[0],n=e[1];return 0!==t||0!==n}},{key:"fixed32",value:function(){return this.view.getUint32((this.pos+=4)-4,!0)}},{key:"sfixed32",value:function(){return this.view.getInt32((this.pos+=4)-4,!0)}},{key:"fixed64",value:function(){return ni.uDec(this.sfixed32(),this.sfixed32())}},{key:"sfixed64",value:function(){return ni.dec(this.sfixed32(),this.sfixed32())}},{key:"float",value:function(){return this.view.getFloat32((this.pos+=4)-4,!0)}},{key:"double",value:function(){return this.view.getFloat64((this.pos+=8)-8,!0)}},{key:"bytes",value:function(){var e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}},{key:"string",value:function(){return this.textDecoder.decode(this.bytes())}}]),e}();function hi(e,t){return t instanceof Dr||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}ai.DOUBLE,ai.FLOAT,ai.INT64,ai.UINT64,ai.INT32,ai.UINT32,ai.BOOL,ai.STRING,ai.BYTES;function gi(e,t,n){if(t===n)return!0;if(e==ai.BYTES){if(!(t instanceof Uint8Array&&n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}switch(e){case ai.UINT64:case ai.FIXED64:case ai.INT64:case ai.SFIXED64:case ai.SINT64:return t==n}return!1}function mi(e){switch(e){case ai.BOOL:return!1;case ai.UINT64:case ai.FIXED64:case ai.INT64:case ai.SFIXED64:case ai.SINT64:return ni.zero;case ai.DOUBLE:case ai.FLOAT:return 0;case ai.BYTES:return new Uint8Array(0);case ai.STRING:return"";default:return 0}}function yi(e,t){var n=void 0===t,r=oi.Varint,i=0===t;switch(e){case ai.STRING:i=n||!t.length,r=oi.LengthDelimited;break;case ai.BOOL:i=!1===t;break;case ai.DOUBLE:r=oi.Bit64;break;case ai.FLOAT:r=oi.Bit32;break;case ai.INT64:case ai.UINT64:i=n||0==t;break;case ai.FIXED64:i=n||0==t,r=oi.Bit64;break;case ai.BYTES:i=n||!t.byteLength,r=oi.LengthDelimited;break;case ai.FIXED32:case ai.SFIXED32:r=oi.Bit32;break;case ai.SFIXED64:i=n||0==t,r=oi.Bit64;break;case ai.SINT64:i=n||0==t}return[r,ai[e].toLowerCase(),n||i]}function wi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _i=Symbol("@bufbuild/protobuf/unknown-fields"),Ii={readUnknownFields:!0,readerFactory:function(e){return new pi(e)}},ki={writeUnknownFields:!0,writerFactory:function(){return new vi}};function Si(e){return e?Object.assign(Object.assign({},Ii),e):Ii}function Ei(e){return e?Object.assign(Object.assign({},ki),e):ki}function Oi(e,t,n){for(var r,i,a=t.uint32(),o=t.pos+a;t.pos<o;){switch(S(t.tag(),1)[0]){case 1:r=Ti(t,e.K);break;case 2:switch(e.V.kind){case"scalar":i=Ti(t,e.V.T);break;case"enum":i=t.int32();break;case"message":i=e.V.T.fromBinary(t.bytes(),n)}}}if(void 0===r){var u=mi(e.K);r=e.K==ai.BOOL?u.toString():u}if("string"!=typeof r&&"number"!=typeof r&&(r=r.toString()),void 0===i)switch(e.V.kind){case"scalar":i=mi(e.V.T);break;case"enum":i=0;break;case"message":i=new e.V.T}return[r,i]}function Ti(e,t){return e[S(yi(t),2)[1]]()}function Ai(e,t,n,r,i){e.tag(n.no,oi.LengthDelimited),e.fork();var a=r;switch(n.K){case ai.INT32:case ai.FIXED32:case ai.UINT32:case ai.SFIXED32:case ai.SINT32:a=Number.parseInt(r);break;case ai.BOOL:Mr("true"==r||"false"==r),a="true"==r}switch(Ni(e,n.K,1,a,!0),n.V.kind){case"scalar":Ni(e,n.V.T,2,i,!0);break;case"enum":Ni(e,ai.INT32,2,i,!0);break;case"message":Pi(e,t,n.V.T,2,i)}e.join()}function Pi(e,t,n,r,i){if(void 0!==i){var a=hi(n,i);e.tag(r,oi.LengthDelimited).bytes(a.toBinary(t))}}function Ni(e,t,n,r,i){var a=S(yi(t,r),3),o=a[0],u=a[1];a[2]&&!i||e.tag(n,o)[u](r)}function Ri(e,t,n,r){if(r.length){e.tag(n,oi.LengthDelimited).fork();for(var i=S(yi(t),2)[1],a=0;a<r.length;a++)e[i](r[a]);e.join()}}function ji(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ci(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ci(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function Ci(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}for(var Bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),xi=[],Di=0;Di<Bi.length;Di++)xi[Bi[Di].charCodeAt(0)]=Di;xi["-".charCodeAt(0)]=Bi.indexOf("+"),xi["_".charCodeAt(0)]=Bi.indexOf("/");var Mi={dec:function(e){var t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);for(var n,r=new Uint8Array(t),i=0,a=0,o=0,u=0;u<e.length;u++){if(void 0===(n=xi[e.charCodeAt(u)]))switch(e[u]){case"=":a=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:o=n,a=1;break;case 1:r[i++]=o<<2|(48&n)>>4,o=n,a=2;break;case 2:r[i++]=(15&o)<<4|(60&n)>>2,o=n,a=3;break;case 3:r[i++]=(3&o)<<6|n,a=0}}if(1==a)throw Error("invalid base64 string.");return r.subarray(0,i)},enc:function(e){for(var t,n="",r=0,i=0,a=0;a<e.length;a++)switch(t=e[a],r){case 0:n+=Bi[t>>2],i=(3&t)<<4,r=1;break;case 1:n+=Bi[i|t>>4],i=(15&t)<<2,r=2;break;case 2:n+=Bi[i|t>>6],n+=Bi[63&t],r=0}return r&&(n+=Bi[i],n+="=",1==r&&(n+="=")),n}};function Li(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ui(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ui(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function Ui(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fi={ignoreUnknownFields:!1},Ji={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function qi(e){return e?Object.assign(Object.assign({},Fi),e):Fi}function Vi(e){return e?Object.assign(Object.assign({},Ji),e):Ji}function zi(t){if(null===t)return"null";switch(e(t)){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return t.toString()}}function Hi(e,t){switch(e){case ai.DOUBLE:case ai.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;var n=Number(t);if(Number.isNaN(n))break;if(!Number.isFinite(n))break;return e==ai.FLOAT&&Hr(n),n;case ai.INT32:case ai.FIXED32:case ai.SFIXED32:case ai.SINT32:case ai.UINT32:if(null===t)return 0;var r;if("number"==typeof t?r=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(r=Number(t)),void 0===r)break;return e==ai.UINT32?zr(r):Vr(r),r;case ai.INT64:case ai.SFIXED64:case ai.SINT64:if(null===t)return ni.zero;if("number"!=typeof t&&"string"!=typeof t)break;return ni.parse(t);case ai.FIXED64:case ai.UINT64:if(null===t)return ni.zero;if("number"!=typeof t&&"string"!=typeof t)break;return ni.uParse(t);case ai.BOOL:if(null===t)return!1;if("boolean"!=typeof t)break;return t;case ai.STRING:if(null===t)return"";if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw new Error("invalid UTF8")}return t;case ai.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!=typeof t)break;return Mi.dec(t)}throw new Error}function Ki(t,n,r){if(null===n)return 0;switch(e(n)){case"number":if(Number.isInteger(n))return n;break;case"string":var i=t.findName(n);if(i||r)return null==i?void 0:i.no}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(zi(n)))}function Qi(e,t,n,r){var i;if(void 0===t)return t;if(0!==t||n){if(r)return t;if("google.protobuf.NullValue"==e.typeName)return null;var a=e.findNumber(t);return null!==(i=null==a?void 0:a.name)&&void 0!==i?i:t}}function Wi(e,t,n){if(void 0!==t)switch(e){case ai.INT32:case ai.SFIXED32:case ai.SINT32:case ai.FIXED32:case ai.UINT32:return Mr("number"==typeof t),0!=t||n?t:void 0;case ai.FLOAT:case ai.DOUBLE:return Mr("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":0!==t||n?t:void 0;case ai.STRING:return Mr("string"==typeof t),t.length>0||n?t:void 0;case ai.BOOL:return Mr("boolean"==typeof t),t||n?t:void 0;case ai.UINT64:case ai.FIXED64:case ai.INT64:case ai.SFIXED64:case ai.SINT64:return Mr("bigint"==typeof t||"string"==typeof t||"number"==typeof t),n||0!=t?t.toString(10):void 0;case ai.BYTES:return Mr(t instanceof Uint8Array),n||t.byteLength>0?Mi.enc(t):void 0}}function Gi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Yi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function Yi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $i(e,t){if(void 0===t)return t;if(t instanceof Dr)return t.clone();if(t instanceof Uint8Array){var n=new Uint8Array(t.byteLength);return n.set(t),n}return t}function Xi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Zi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function Zi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ea=function(){function e(t,n){i(this,e),this._fields=t,this._normalizer=n}return o(e,[{key:"findJsonName",value:function(e){if(!this.jsonNames){var t,n={},r=Xi(this.list());try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i.jsonName]=n[i.name]=i}}catch(e){r.e(e)}finally{r.f()}this.jsonNames=n}return this.jsonNames[e]}},{key:"find",value:function(e){if(!this.numbers){var t,n={},r=Xi(this.list());try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i.no]=i}}catch(e){r.e(e)}finally{r.f()}this.numbers=n}return this.numbers[e]}},{key:"list",value:function(){return this.all||(this.all=this._normalizer(this._fields)),this.all}},{key:"byNumber",value:function(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((function(e,t){return e.no-t.no}))),this.numbersAsc}},{key:"byMember",value:function(){if(!this.members){this.members=[];var e,t,n=this.members,r=Xi(this.list());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.oneof?i.oneof!==e&&(e=i.oneof,n.push(e)):n.push(i)}}catch(e){r.e(e)}finally{r.f()}}return this.members}}]),e}();function ta(e,t){var n=ia(e);return t?n:ca(sa(n))}function na(e){return ta(e,!1)}var ra=ia;function ia(e){for(var t=!1,n=[],r=0;r<e.length;r++){var i=e.charAt(r);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),n.push(i)}}return n.join("")}new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","Object","bigint","number","boolean","string","object","globalThis","Uint8Array","Partial"]);var aa=new Set(["constructor","toString","toJSON","valueOf"]),oa=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),ua=function(e){return"".concat(e,"$")},sa=function(e){return oa.has(e)?ua(e):e},ca=function(e){return aa.has(e)?ua(e):e},fa=function(){function e(t){i(this,e),this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=t,this.localName=na(t)}return o(e,[{key:"addField",value:function(e){Mr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}},{key:"findField",value:function(e){if(!this._lookup){this._lookup=Object.create(null);for(var t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}]),e}();function la(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return da(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return da(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function da(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var va,pa,ha,ga,ma,ya,wa=(va="proto3",ma=function(e,t){return function(n,r,i){if("map"==n.kind){var a={};switch(n.V.kind){case"scalar":for(var o=0,u=Object.entries(r);o<u.length;o++){var s=S(u[o],2),c=s[0],f=s[1],l=t(n.V.T,f,!0);Mr(void 0!==l),a[c.toString()]=l}break;case"message":for(var d=0,v=Object.entries(r);d<v.length;d++){var p=S(v[d],2),h=p[0],g=p[1];a[h.toString()]=g.toJson(i)}break;case"enum":for(var m=n.V.T,y=0,w=Object.entries(r);y<w.length;y++){var b=S(w[y],2),_=b[0],I=b[1];Mr(void 0===I||"number"==typeof I);var k=e(m,I,!0,i.enumAsInteger);Mr(void 0!==k),a[_.toString()]=k}}return i.emitDefaultValues||Object.keys(a).length>0?a:void 0}if(n.repeated){var E=[];switch(n.kind){case"scalar":for(var O=0;O<r.length;O++)E.push(t(n.T,r[O],!0));break;case"enum":for(var T=0;T<r.length;T++)E.push(e(n.T,r[T],!0,i.enumAsInteger));break;case"message":for(var A=0;A<r.length;A++)E.push(hi(n.T,r[A]).toJson(i))}return i.emitDefaultValues||E.length>0?E:void 0}switch(n.kind){case"scalar":return t(n.T,r,!!n.oneof||n.opt||i.emitDefaultValues);case"enum":return e(n.T,r,!!n.oneof||n.opt||i.emitDefaultValues,i.enumAsInteger);case"message":return void 0!==r?hi(n.T,r).toJson(i):void 0}}},ya=ma(Qi,Wi),pa={makeReadOptions:qi,makeWriteOptions:Vi,readMessage:function(t,n,r,i){if(null==n||Array.isArray(n)||"object"!=e(n))throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(this.debug(n)));i=null!=i?i:new t;for(var a={},o=0,u=Object.entries(n);o<u.length;o++){var s=S(u[o],2),c=s[0],f=s[1],l=t.fields.findJsonName(c);if(l){var d=l.localName,v=i;if(l.oneof){if(null===f&&"scalar"==l.kind)continue;var p=a[l.oneof.localName];if(p)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(p,'", "').concat(c,'"'));a[l.oneof.localName]=c,v=v[l.oneof.localName]={case:d},d="value"}if(l.repeated){if(null===f)continue;if(!Array.isArray(f))throw new Error("cannot decode field ".concat(t.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f)));var h,g=v[d],m=Li(f);try{for(m.s();!(h=m.n()).done;){var y=h.value;if(null===y)throw new Error("cannot decode field ".concat(t.typeName,".").concat(l.name," from JSON: ").concat(this.debug(y)));var w=void 0;switch(l.kind){case"message":w=l.T.fromJson(y,r);break;case"enum":if(void 0===(w=Ki(l.T,y,r.ignoreUnknownFields)))continue;break;case"scalar":try{w=Hi(l.T,y)}catch(e){var b="cannot decode field ".concat(t.typeName,".").concat(l.name," from JSON: ").concat(this.debug(y));throw e instanceof Error&&e.message.length>0&&(b+=": ".concat(e.message)),new Error(b)}}g.push(w)}}catch(e){m.e(e)}finally{m.f()}}else if("map"==l.kind){if(null===f)continue;if(Array.isArray(f)||"object"!=e(f))throw new Error("cannot decode field ".concat(t.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f)));for(var _=v[d],I=0,k=Object.entries(f);I<k.length;I++){var E=S(k[I],2),O=E[0],T=E[1];if(null===T)throw new Error("cannot decode field ".concat(t.typeName,".").concat(l.name," from JSON: map value null"));var A=void 0;switch(l.V.kind){case"message":A=l.V.T.fromJson(T,r);break;case"enum":if(void 0===(A=Ki(l.V.T,T,r.ignoreUnknownFields)))continue;break;case"scalar":try{A=Hi(l.V.T,T)}catch(e){var P="cannot decode map value for field ".concat(t.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f));throw e instanceof Error&&e.message.length>0&&(P+=": ".concat(e.message)),new Error(P)}}try{_[Hi(l.K,l.K==ai.BOOL?"true"==O||"false"!=O&&O:O).toString()]=A}catch(e){var N="cannot decode map key for field ".concat(t.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f));throw e instanceof Error&&e.message.length>0&&(N+=": ".concat(e.message)),new Error(N)}}}else switch(l.kind){case"message":var R=l.T;if(null===f&&"google.protobuf.Value"!=R.typeName){if(l.oneof)throw new Error("cannot decode field ".concat(t.typeName,".").concat(l.name,' from JSON: null is invalid for oneof field "').concat(c,'"'));continue}v[d]instanceof Dr?v[d].fromJson(f,r):(v[d]=R.fromJson(f,r),R.fieldWrapper&&!l.oneof&&(v[d]=R.fieldWrapper.unwrapField(v[d])));break;case"enum":var j=Ki(l.T,f,r.ignoreUnknownFields);void 0!==j&&(v[d]=j);break;case"scalar":try{v[d]=Hi(l.T,f)}catch(e){var C="cannot decode field ".concat(t.typeName,".").concat(l.name," from JSON: ").concat(this.debug(f));throw e instanceof Error&&e.message.length>0&&(C+=": ".concat(e.message)),new Error(C)}}}else if(!r.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(c,'" is unknown'))}return i},writeMessage:function(e,t){var n,r=e.getType(),i={};try{var a,o=Li(r.fields.byMember());try{for(o.s();!(a=o.n()).done;){var u=a.value,s=void 0;if("oneof"==u.kind){var c=e[u.localName];if(void 0===c.value)continue;if(!(n=u.findField(c.case)))throw"oneof case not found: "+c.case;s=ya(n,c.value,t)}else s=ya(n=u,e[n.localName],t);void 0!==s&&(i[t.useProtoFieldName?n.name:n.jsonName]=s)}}catch(e){o.e(e)}finally{o.f()}}catch(e){var f=n?"cannot encode field ".concat(r.typeName,".").concat(n.name," to JSON"):"cannot encode message ".concat(r.typeName," to JSON"),l=e instanceof Error?e.message:String(e);throw new Error(f+(l.length>0?": ".concat(l):""))}return i},readScalar:Hi,writeScalar:Wi,debug:zi},ha=Object.assign(Object.assign({},{makeReadOptions:Si,makeWriteOptions:Ei,listUnknownFields:function(e){var t;return null!==(t=e[_i])&&void 0!==t?t:[]},discardUnknownFields:function(e){delete e[_i]},writeUnknownFields:function(e,t){var n=e[_i];if(n){var r,i=wi(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.tag(a.no,a.wireType).raw(a.data)}}catch(e){i.e(e)}finally{i.f()}}},onUnknownField:function(e,t,n,r){var i=e;Array.isArray(i[_i])||(i[_i]=[]),i[_i].push({no:t,wireType:n,data:r})},readMessage:function(e,t,n,r){for(var i=e.getType(),a=void 0===n?t.len:t.pos+n;t.pos<a;){var o=S(t.tag(),2),u=o[0],s=o[1],c=i.fields.find(u);if(c){var f=e,l=c.repeated,d=c.localName;switch(c.oneof&&((f=f[c.oneof.localName]).case!=d&&delete f.value,f.case=d,d="value"),c.kind){case"scalar":case"enum":var v="enum"==c.kind?ai.INT32:c.T;if(l){var p=f[d];if(s==oi.LengthDelimited&&v!=ai.STRING&&v!=ai.BYTES)for(var h=t.uint32()+t.pos;t.pos<h;)p.push(Ti(t,v));else p.push(Ti(t,v))}else f[d]=Ti(t,v);break;case"message":var g=c.T;l?f[d].push(g.fromBinary(t.bytes(),r)):f[d]instanceof Dr?f[d].fromBinary(t.bytes(),r):(f[d]=g.fromBinary(t.bytes(),r),!g.fieldWrapper||c.oneof||c.repeated||(f[d]=g.fieldWrapper.unwrapField(f[d])));break;case"map":var m=S(Oi(c,t,r),2),y=m[0],w=m[1];f[d][y]=w}}else{var b=t.skip(s);r.readUnknownFields&&this.onUnknownField(e,u,s,b)}}}}),{writeMessage:function(e,t,n){var r,i=ji(e.getType().fields.byNumber());try{for(i.s();!(r=i.n()).done;){var a=r.value,o=void 0,u=a.repeated,s=a.localName;if(a.oneof){var c=e[a.oneof.localName];if(c.case!==s)continue;o=c.value}else o=e[s];switch(a.kind){case"scalar":case"enum":var f="enum"==a.kind?ai.INT32:a.T;if(u)if(a.packed)Ri(t,f,a.no,o);else{var l,d=ji(o);try{for(d.s();!(l=d.n()).done;){var v=l.value;Ni(t,f,a.no,v,!0)}}catch(e){d.e(e)}finally{d.f()}}else void 0!==o&&Ni(t,f,a.no,o,!!a.oneof||a.opt);break;case"message":if(u){var p,h=ji(o);try{for(h.s();!(p=h.n()).done;){var g=p.value;Pi(t,n,a.T,a.no,g)}}catch(e){h.e(e)}finally{h.f()}}else Pi(t,n,a.T,a.no,o);break;case"map":for(var m=0,y=Object.entries(o);m<y.length;m++){var w=S(y[m],2);Ai(t,n,a,w[0],w[1])}}}}catch(e){i.e(e)}finally{i.f()}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),ga=Object.assign(Object.assign({},{setEnumType:ci,initPartial:function(e,t){if(void 0!==e){var n,r=Gi(t.getType().fields.byMember());try{var i=function(){var r=n.value,i=r.localName,a=t,o=e;if(void 0===o[i])return"continue";switch(r.kind){case"oneof":var u=o[i].case;if(void 0===u)return"continue";var s=r.findField(u),c=o[i].value;!s||"message"!=s.kind||c instanceof s.T||(c=new s.T(c)),a[i]={case:u,value:c};break;case"scalar":case"enum":a[i]=o[i];break;case"map":switch(r.V.kind){case"scalar":case"enum":Object.assign(a[i],o[i]);break;case"message":for(var f=r.V.T,l=0,d=Object.keys(o[i]);l<d.length;l++){var v=d[l],p=o[i][v];f.fieldWrapper||(p=new f(p)),a[i][v]=p}}break;case"message":var h=r.T;if(r.repeated)a[i]=o[i].map((function(e){return e instanceof h?e:new h(e)}));else if(void 0!==o[i]){var g=o[i];h.fieldWrapper?a[i]=g:a[i]=g instanceof h?g:new h(g)}}};for(r.s();!(n=r.n()).done;)i()}catch(e){r.e(e)}finally{r.f()}}},equals:function(e,t,n){return t===n||!(!t||!n)&&e.fields.byMember().every((function(e){var r=t[e.localName],i=n[e.localName];if(e.repeated){if(r.length!==i.length)return!1;switch(e.kind){case"message":return r.every((function(t,n){return e.T.equals(t,i[n])}));case"scalar":return r.every((function(t,n){return gi(e.T,t,i[n])}));case"enum":return r.every((function(e,t){return gi(ai.INT32,e,i[t])}))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":return e.T.equals(r,i);case"enum":return gi(ai.INT32,r,i);case"scalar":return gi(e.T,r,i);case"oneof":if(r.case!==i.case)return!1;var a=e.findField(r.case);if(void 0===a)return!0;switch(a.kind){case"message":return a.T.equals(r.value,i.value);case"enum":return gi(ai.INT32,r.value,i.value);case"scalar":return gi(a.T,r.value,i.value)}throw new Error("oneof cannot contain ".concat(a.kind));case"map":var o=Object.keys(r).concat(Object.keys(i));switch(e.V.kind){case"message":var u=e.V.T;return o.every((function(e){return u.equals(r[e],i[e])}));case"enum":return o.every((function(e){return gi(ai.INT32,r[e],i[e])}));case"scalar":var s=e.V.T;return o.every((function(e){return gi(s,r[e],i[e])}))}}}))},clone:function(e){var t,n=e.getType(),r=new n,i=r,a=Gi(n.fields.byMember());try{var o=function(){var n,r=t.value,a=e[r.localName];if(r.repeated)n=a.map((function(e){return $i(0,e)}));else if("map"==r.kind){n=i[r.localName];for(var o=0,u=Object.entries(a);o<u.length;o++){var s=S(u[o],2),c=s[0],f=s[1];n[c]=$i(r.V,f)}}else if("oneof"==r.kind){var l=r.findField(a.case);n=l?{case:a.case,value:$i(0,a.value)}:{case:void 0}}else n=$i(0,a);i[r.localName]=n};for(a.s();!(t=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return r}}),{newFieldList:function(e){return new ea(e,ba)},initFields:function(e){var t,n=la(e.getType().fields.byMember());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!r.opt){var i=r.localName,a=e;if(r.repeated)a[i]=[];else switch(r.kind){case"oneof":a[i]={case:void 0};break;case"enum":a[i]=0;break;case"map":a[i]={};break;case"scalar":a[i]=mi(r.T)}}}}catch(e){n.e(e)}finally{n.f()}}}),{syntax:va,json:pa,bin:ha,util:ga,makeMessageType:function(e,t,n){return function(e,t,n,i){var a,o=null!==(a=null==i?void 0:i.localName)&&void 0!==a?a:t.substring(t.lastIndexOf(".")+1),u=r({},o,(function(t){e.util.initFields(this),e.util.initPartial(t,this)}))[o];return Object.setPrototypeOf(u.prototype,new Dr),Object.assign(u,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:function(e,t){return(new u).fromBinary(e,t)},fromJson:function(e,t){return(new u).fromJson(e,t)},fromJsonString:function(e,t){return(new u).fromJsonString(e,t)},equals:function(t,n){return e.util.equals(u,t,n)}}),u}(this,e,t,n)},makeEnum:li,makeEnumType:fi,getEnumType:si});function ba(e){var t,n,r,i,a,o=[],u=la("function"==typeof e?e():e);try{for(u.s();!(a=u.n()).done;){var s=a.value,c=s;if(c.localName=ta(s.name,void 0!==s.oneof),c.jsonName=null!==(t=s.jsonName)&&void 0!==t?t:ra(s.name),c.repeated=null!==(n=s.repeated)&&void 0!==n&&n,c.packed=null!==(r=s.packed)&&void 0!==r?r:"enum"==s.kind||"scalar"==s.kind&&s.T!=ai.BYTES&&s.T!=ai.STRING,void 0!==s.oneof){var f="string"==typeof s.oneof?s.oneof:s.oneof.name;i&&i.name==f||(i=new fa(f)),c.oneof=i,i.addField(c)}o.push(c)}}catch(e){u.e(e)}finally{u.f()}return o}function _a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}var Ia=function(e){l(n,e);var t=_a(n);function n(e){var r;return i(this,n),(r=t.call(this)).seconds=ni.zero,r.nanos=0,wa.util.initPartial(e,u(r)),r}return o(n,[{key:"fromJson",value:function(e,t){if("string"!=typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(wa.json.debug(e)));var n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");var r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=ni.parse(r/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}},{key:"toJson",value:function(e){var t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");var n="Z";if(this.nanos>0){var r=(this.nanos+1e9).toString().substring(1);n="000000"===r.substring(3)?"."+r.substring(0,3)+"Z":"000"===r.substring(6)?"."+r.substring(0,6)+"Z":"."+r+"Z"}return new Date(t).toISOString().replace(".000Z",n)}},{key:"toDate",value:function(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}}],[{key:"now",value:function(){return n.fromDate(new Date)}},{key:"fromDate",value:function(e){var t=e.getTime();return new n({seconds:ni.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}},{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);function ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}Ia.runtime=wa,Ia.typeName="google.protobuf.Timestamp",Ia.fields=wa.util.newFieldList((function(){return[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]}));var Sa=function(e){l(n,e);var t=ka(n);function n(e){var r;return i(this,n),r=t.call(this),wa.util.initPartial(e,u(r)),r}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);function Ea(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}Sa.runtime=wa,Sa.typeName="google.protobuf.Empty",Sa.fields=wa.util.newFieldList((function(){return[]}));var Oa=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"string",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Oa,"runtime",wa),r(Oa,"typeName","core_sdk.v1.Value"),r(Oa,"fields",wa.util.newFieldList((function(){return[{no:1,name:"string",kind:"scalar",T:9}]})));var Ta=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"name",""),r(u(a),"version",""),r(u(a),"platform",""),r(u(a),"properties",{}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Ta,"runtime",wa),r(Ta,"typeName","core_sdk.v1.LibraryInfo"),r(Ta,"fields",wa.util.newFieldList((function(){return[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"platform",kind:"scalar",T:9},{no:4,name:"properties",kind:"map",K:9,V:{kind:"message",T:Oa}}]})));var Aa=function(e){l(n,e);var t=Ea(n);function n(e){var r;return i(this,n),r=t.call(this),wa.util.initPartial(e,u(r)),r}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Aa,"runtime",wa),r(Aa,"typeName","core_sdk.v1.ApplicationInfo"),r(Aa,"fields",wa.util.newFieldList((function(){return[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"identifier",kind:"scalar",T:9,opt:!0},{no:3,name:"version_string",kind:"scalar",T:9,opt:!0}]})));var Pa=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"platformVersion",""),r(u(a),"browserVersion",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Pa,"runtime",wa),r(Pa,"typeName","core_sdk.v1.UserAgentClientHintsInfo"),r(Pa,"fields",wa.util.newFieldList((function(){return[{no:1,name:"platform_version",kind:"scalar",T:9},{no:2,name:"browser_version",kind:"scalar",T:9},{no:3,name:"model",kind:"scalar",T:9,opt:!0}]})));var Na=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"model",""),r(u(a),"platform",""),r(u(a),"type",Ra.UNKNOWN_UNSPECIFIED),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Na,"runtime",wa),r(Na,"typeName","core_sdk.v1.DeviceInfo"),r(Na,"fields",wa.util.newFieldList((function(){return[{no:1,name:"model",kind:"scalar",T:9},{no:2,name:"platform",kind:"scalar",T:9},{no:3,name:"user_agent",kind:"scalar",T:9,opt:!0},{no:4,name:"type",kind:"enum",T:wa.getEnumType(Ra)},{no:5,name:"carrier",kind:"scalar",T:9,opt:!0},{no:6,name:"vendor_id",kind:"scalar",T:9,opt:!0},{no:7,name:"advertiser_id",kind:"scalar",T:9,opt:!0},{no:13,name:"uach",kind:"message",T:Pa,opt:!0}]})));var Ra=function(e){return e[e.UNKNOWN_UNSPECIFIED=0]="UNKNOWN_UNSPECIFIED",e[e.MOBILE=1]="MOBILE",e[e.TABLET=2]="TABLET",e[e.DESKTOP=3]="DESKTOP",e[e.TV=4]="TV",e[e.WATCH=5]="WATCH",e[e.AUTOMOTIVE=6]="AUTOMOTIVE",e}({});wa.util.setEnumType(Ra,"core_sdk.v1.DeviceInfo.DeviceType",[{no:0,name:"DEVICE_TYPE_UNKNOWN_UNSPECIFIED"},{no:1,name:"DEVICE_TYPE_MOBILE"},{no:2,name:"DEVICE_TYPE_TABLET"},{no:3,name:"DEVICE_TYPE_DESKTOP"},{no:4,name:"DEVICE_TYPE_TV"},{no:5,name:"DEVICE_TYPE_WATCH"},{no:6,name:"DEVICE_TYPE_AUTOMOTIVE"}]);var ja=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"id",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(ja,"runtime",wa),r(ja,"typeName","core_sdk.v1.SessionInfo"),r(ja,"fields",wa.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"time",kind:"message",T:Ia},{no:3,name:"referrer",kind:"scalar",T:9,opt:!0},{no:4,name:"search_keyword",kind:"scalar",T:9,opt:!0},{no:5,name:"utm",kind:"message",T:xa,opt:!0},{no:6,name:"initial_pageview_info",kind:"message",T:Ca,opt:!0}]})));var Ca=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"id",""),r(u(a),"sourceProperties",{}),r(u(a),"properties",{}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Ca,"runtime",wa),r(Ca,"typeName","core_sdk.v1.PageviewInfo"),r(Ca,"fields",wa.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"time",kind:"message",T:Ia},{no:3,name:"component_or_class_name",kind:"scalar",T:9,opt:!0},{no:4,name:"title",kind:"scalar",T:9,opt:!0},{no:5,name:"url",kind:"message",T:Ba,opt:!0},{no:6,name:"source_properties",kind:"map",K:9,V:{kind:"message",T:Oa}},{no:7,name:"previous_page",kind:"scalar",T:9,opt:!0},{no:8,name:"properties",kind:"map",K:9,V:{kind:"message",T:Oa}}]})));var Ba=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"domain",""),r(u(a),"path",""),r(u(a),"query",""),r(u(a),"hash",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Ba,"runtime",wa),r(Ba,"typeName","core_sdk.v1.PageviewInfo.Url"),r(Ba,"fields",wa.util.newFieldList((function(){return[{no:1,name:"domain",kind:"scalar",T:9},{no:2,name:"path",kind:"scalar",T:9},{no:3,name:"query",kind:"scalar",T:9},{no:4,name:"hash",kind:"scalar",T:9}]})));var xa=function(e){l(n,e);var t=Ea(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"source",""),r(u(a),"medium",""),r(u(a),"term",""),r(u(a),"content",""),r(u(a),"campaign",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);function Da(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}r(xa,"runtime",wa),r(xa,"typeName","core_sdk.v1.Utm"),r(xa,"fields",wa.util.newFieldList((function(){return[{no:1,name:"source",kind:"scalar",T:9},{no:2,name:"medium",kind:"scalar",T:9},{no:3,name:"term",kind:"scalar",T:9},{no:4,name:"content",kind:"scalar",T:9},{no:5,name:"campaign",kind:"scalar",T:9}]})));var Ma=function(e){l(n,e);var t=Da(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"envId",""),r(u(a),"userId",""),r(u(a),"properties",{}),r(u(a),"sessionReplay",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Ma,"runtime",wa),r(Ma,"typeName","core_sdk.v1.UserProperties"),r(Ma,"fields",wa.util.newFieldList((function(){return[{no:1,name:"env_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"properties",kind:"map",K:9,V:{kind:"message",T:Oa}},{no:4,name:"initial_device",kind:"message",T:Na},{no:5,name:"initial_application",kind:"message",T:Aa},{no:6,name:"library",kind:"message",T:Ta},{no:7,name:"initial_session_info",kind:"message",T:ja},{no:8,name:"session_replay",kind:"scalar",T:9}]})));var La=function(e){l(n,e);var t=Da(n);function n(e){var r;return i(this,n),r=t.call(this),wa.util.initPartial(e,u(r)),r}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(La,"runtime",wa),r(La,"typeName","core_sdk.v1.PostMobileAddUserPropertiesRequest"),r(La,"fields",wa.util.newFieldList((function(){return[{no:1,name:"user_properties",kind:"message",T:Ma}]})));var Ua=function(e){l(n,e);var t=Da(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"status",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);function Fa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}r(Ua,"runtime",wa),r(Ua,"typeName","core_sdk.v1.PostMobileAddUserPropertiesResponse"),r(Ua,"fields",wa.util.newFieldList((function(){return[{no:2,name:"status",kind:"scalar",T:9}]})));var Ja=function(e){l(n,e);var t=Fa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"envId",""),r(u(a),"userId",""),r(u(a),"identity",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);function qa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}r(Ja,"runtime",wa),r(Ja,"typeName","core_sdk.v1.UserIdentification"),r(Ja,"fields",wa.util.newFieldList((function(){return[{no:1,name:"env_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"identity",kind:"scalar",T:9},{no:4,name:"time",kind:"message",T:Ia},{no:5,name:"library",kind:"message",T:Ta}]})));var Va=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"csPid",""),r(u(a),"csPvid",""),r(u(a),"csSn",""),r(u(a),"csTs",""),r(u(a),"csUu",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Va,"runtime",wa),r(Va,"typeName","core_sdk.v1.CSProperties"),r(Va,"fields",wa.util.newFieldList((function(){return[{no:1,name:"cs_pid",kind:"scalar",T:9},{no:2,name:"cs_pvid",kind:"scalar",T:9},{no:3,name:"cs_sn",kind:"scalar",T:9},{no:4,name:"cs_ts",kind:"scalar",T:9},{no:5,name:"cs_uu",kind:"scalar",T:9}]})));var za=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"platform",Ha.UNSPECIFIED),r(u(a),"urlMetadata",{}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(za,"runtime",wa),r(za,"typeName","core_sdk.v1.SessionReplayInfo"),r(za,"fields",wa.util.newFieldList((function(){return[{no:1,name:"platform",kind:"enum",T:wa.getEnumType(Ha)},{no:2,name:"time",kind:"message",T:Ia},{no:3,name:"url_metadata",kind:"map",K:9,V:{kind:"message",T:Oa}}]})));var Ha=function(e){return e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.AURYC=1]="AURYC",e[e.LOGROCKET=2]="LOGROCKET",e}({});wa.util.setEnumType(Ha,"core_sdk.v1.SessionReplayInfo.SessionReplayPlatform",[{no:0,name:"SESSION_REPLAY_PLATFORM_UNSPECIFIED"},{no:1,name:"SESSION_REPLAY_PLATFORM_AURYC"},{no:2,name:"SESSION_REPLAY_PLATFORM_LOGROCKET"}]);var Ka=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"id",""),r(u(a),"identity",""),r(u(a),"properties",{}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Ka,"runtime",wa),r(Ka,"typeName","core_sdk.v1.User"),r(Ka,"fields",wa.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"initial_referrer",kind:"scalar",T:9,opt:!0},{no:4,name:"initial_search_keyword",kind:"scalar",T:9,opt:!0},{no:5,name:"initial_utm",kind:"message",T:xa,opt:!0},{no:6,name:"initial_pageview_info",kind:"message",T:Ca},{no:7,name:"properties",kind:"map",K:9,V:{kind:"message",T:Oa}}]})));var Qa=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"attributes",{}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Qa,"runtime",wa),r(Qa,"typeName","core_sdk.v1.ElementNode"),r(Qa,"fields",wa.util.newFieldList((function(){return[{no:1,name:"node_name",kind:"scalar",T:9,opt:!0},{no:2,name:"node_html_class",kind:"scalar",T:9,opt:!0},{no:3,name:"node_id",kind:"scalar",T:9,opt:!0},{no:4,name:"node_text",kind:"scalar",T:9,opt:!0},{no:5,name:"href",kind:"scalar",T:9,opt:!0},{no:6,name:"accessibility_label",kind:"scalar",T:9,opt:!0},{no:7,name:"referencing_property_name",kind:"scalar",T:9,opt:!0},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:Oa}}]})));var Wa=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"kind",{case:void 0}),r(u(a),"nodes",[]),r(u(a),"sourceProperties",{}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Wa,"runtime",wa),r(Wa,"typeName","core_sdk.v1.Interaction"),r(Wa,"fields",wa.util.newFieldList((function(){return[{no:1,name:"callback_name",kind:"scalar",T:9,opt:!0},{no:2,name:"custom",kind:"scalar",T:9,oneof:"kind"},{no:3,name:"builtin",kind:"enum",T:wa.getEnumType(Ga),oneof:"kind"},{no:4,name:"hierarchy",kind:"scalar",T:9,opt:!0},{no:5,name:"nodes",kind:"message",T:Qa,repeated:!0},{no:6,name:"source_properties",kind:"map",K:9,V:{kind:"message",T:Oa}}]})));var Ga=function(e){return e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.CLICK=1]="CLICK",e[e.TOUCH=2]="TOUCH",e[e.CHANGE=3]="CHANGE",e[e.SUBMIT=4]="SUBMIT",e}({});wa.util.setEnumType(Ga,"core_sdk.v1.Interaction.BuiltinKind",[{no:0,name:"BUILTIN_KIND_UNSPECIFIED"},{no:1,name:"BUILTIN_KIND_CLICK"},{no:2,name:"BUILTIN_KIND_TOUCH"},{no:3,name:"BUILTIN_KIND_CHANGE"},{no:4,name:"BUILTIN_KIND_SUBMIT"}]);var Ya=function(e){l(n,e);var t=qa(n);function n(e){var r;return i(this,n),r=t.call(this),wa.util.initPartial(e,u(r)),r}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Ya,"runtime",wa),r(Ya,"typeName","core_sdk.v1.VersionChange"),r(Ya,"fields",wa.util.newFieldList((function(){return[{no:1,name:"previous_version",kind:"message",T:Aa,opt:!0},{no:2,name:"current_version",kind:"message",T:Aa}]})));var $a=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"invisibleToVisible",[]),r(u(a),"visibleToInvisible",[]),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r($a,"runtime",wa),r($a,"typeName","core_sdk.v1.ComponentTransition"),r($a,"fields",wa.util.newFieldList((function(){return[{no:1,name:"invisible_to_visible",kind:"message",T:Qa,repeated:!0},{no:2,name:"visible_to_invisible",kind:"message",T:Qa,repeated:!0}]})));var Xa=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"kind",{case:void 0}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(Xa,"runtime",wa),r(Xa,"typeName","core_sdk.v1.Event"),r(Xa,"fields",wa.util.newFieldList((function(){return[{no:1,name:"custom",kind:"message",T:eo,oneof:"kind"},{no:2,name:"interaction",kind:"message",T:Wa,oneof:"kind"},{no:3,name:"version_change",kind:"message",T:Ya,oneof:"kind"},{no:4,name:"component_transition",kind:"message",T:$a,oneof:"kind"},{no:20,name:"app_visibility_state",kind:"enum",T:wa.getEnumType(Za),opt:!0}]})));var Za=function(e){return e[e.UNKNOWN_UNSPECIFIED=0]="UNKNOWN_UNSPECIFIED",e[e.BACKGROUNDED=1]="BACKGROUNDED",e[e.FOREGROUNDED=2]="FOREGROUNDED",e}({});wa.util.setEnumType(Za,"core_sdk.v1.Event.AppVisibility",[{no:0,name:"APP_VISIBILITY_UNKNOWN_UNSPECIFIED"},{no:1,name:"APP_VISIBILITY_BACKGROUNDED"},{no:2,name:"APP_VISIBILITY_FOREGROUNDED"}]);var eo=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"name",""),r(u(a),"properties",{}),r(u(a),"sourceProperties",{}),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(eo,"runtime",wa),r(eo,"typeName","core_sdk.v1.Event.Custom"),r(eo,"fields",wa.util.newFieldList((function(){return[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"properties",kind:"map",K:9,V:{kind:"message",T:Oa}},{no:3,name:"source_properties",kind:"map",K:9,V:{kind:"message",T:Oa}}]})));var to=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"id",""),r(u(a),"envId",""),r(u(a),"userId",""),r(u(a),"identity",""),r(u(a),"properties",{}),r(u(a),"kind",{case:void 0}),r(u(a),"activeContexts",[]),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(to,"runtime",wa),r(to,"typeName","core_sdk.v1.Message"),r(to,"fields",wa.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"env_id",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:19,name:"identity",kind:"scalar",T:9},{no:4,name:"time",kind:"message",T:Ia},{no:5,name:"base_library",kind:"message",T:Ta},{no:6,name:"source_library",kind:"message",T:Ta,opt:!0},{no:7,name:"application",kind:"message",T:Aa,opt:!0},{no:8,name:"device",kind:"message",T:Na},{no:9,name:"session_info",kind:"message",T:ja},{no:10,name:"pageview_info",kind:"message",T:Ca,opt:!0},{no:11,name:"properties",kind:"map",K:9,V:{kind:"message",T:Oa}},{no:12,name:"session",kind:"message",T:Sa,oneof:"kind"},{no:13,name:"pageview",kind:"message",T:Sa,oneof:"kind"},{no:14,name:"event",kind:"message",T:Xa,oneof:"kind"},{no:15,name:"user",kind:"message",T:Ka,oneof:"kind"},{no:16,name:"session_replay_info",kind:"message",T:za,opt:!0},{no:17,name:"session_replay",kind:"scalar",T:9,opt:!0},{no:18,name:"active_contexts",kind:"message",T:Qa,repeated:!0},{no:20,name:"cs_properties",kind:"message",T:Va}]})));var no=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"events",[]),r(u(a),"ipOverride",""),r(u(a),"timeOverride",!1),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(no,"runtime",wa),r(no,"typeName","core_sdk.v1.MessageBatch"),r(no,"fields",wa.util.newFieldList((function(){return[{no:1,name:"events",kind:"message",T:to,repeated:!0},{no:2,name:"ip_override",kind:"scalar",T:9},{no:3,name:"time_override",kind:"scalar",T:8}]})));var ro=function(e){l(n,e);var t=qa(n);function n(e){var r;return i(this,n),r=t.call(this),wa.util.initPartial(e,u(r)),r}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);r(ro,"runtime",wa),r(ro,"typeName","core_sdk.v1.PostMobileTrackRequest"),r(ro,"fields",wa.util.newFieldList((function(){return[{no:1,name:"message_batch",kind:"message",T:no}]})));var io=function(e){l(n,e);var t=qa(n);function n(e){var a;return i(this,n),r(u(a=t.call(this)),"status",""),wa.util.initPartial(e,u(a)),a}return o(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return wa.util.equals(n,e,t)}}]),n}(Dr);function ao(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ao(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ao(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}r(io,"runtime",wa),r(io,"typeName","core_sdk.v1.PostMobileTrackResponse"),r(io,"fields",wa.util.newFieldList((function(){return[{no:1,name:"status",kind:"scalar",T:9}]})));var uo,so=function(e){return e[e.Track=0]="Track",e[e.Identify=1]="Identify",e[e.AUP=2]="AUP",e}({}),co=function(e){return e[e.Event=0]="Event",e[e.Meta=1]="Meta",e}({}),fo=function(e){try{switch(e.type){case y.CORE_TRACK:return So(e);case m.METADATA_SESSION:case m.METADATA_PAGEVIEW:return _o(e);case m.METADATA_USER:case y.CORE_ADD_USER_PROPERTIES:return wo(e);case y.CORE_IDENTIFY_v3:return bo(e);default:return k.error("Found invalid message type"),null}}catch(t){return k.error("Failed to verify message",e),null}},lo=function(e){if(void 0!==e){var t=Math.floor(e/1e3),n=1e6*(e-1e3*t);return new Ia({seconds:ni.parse(t),nanos:n})}},vo=function(e){if(null!=e)return Object.entries(e).reduce((function(e,t){var n=S(t,2),r=n[0],i=n[1];return e[r]=new Oa({string:null==i?void 0:i.toString()}),e}),{})},po=function(e){return new Ta({name:null==e?void 0:e.name,version:null==e?void 0:e.version,platform:null==e?void 0:e.platform,properties:vo(null==e?void 0:e.properties)})},ho=function(e){var t,n,r;return new Na({userAgent:null==e?void 0:e.user_agent,uach:new Pa({browserVersion:null==e||null===(t=e.uach)||void 0===t?void 0:t.browser_version,platformVersion:null==e||null===(n=e.uach)||void 0===n?void 0:n.platform_version,model:null==e||null===(r=e.uach)||void 0===r?void 0:r.model})})},go=function(e){return new Ca(oo(oo({},e),{},{id:null==e?void 0:e.id,url:(t=null==e?void 0:e.url,t?new Ba(t):void 0),previousPage:null==e?void 0:e.previous_page,time:lo(null==e?void 0:e.time),properties:vo(null==e?void 0:e.properties),sourceProperties:vo(null==e?void 0:e.source_properties)}));var t},mo=function(e){return new ja(oo(oo({},e),{},{utm:new xa(oo({},null==e?void 0:e.utm)),time:lo(null==e?void 0:e.time),initialPageviewInfo:go(null==e?void 0:e.initial_pageview_info)}))},yo=function(e){return new Va({csPid:null==e?void 0:e.cs_pid,csPvid:null==e?void 0:e.cs_pvid,csSn:null==e?void 0:e.cs_sn,csTs:null==e?void 0:e.cs_ts,csUu:null==e?void 0:e.cs_uu})},wo=function(e){var t=e.type,n=e.data;return{payload:new Ma(oo({envId:n.env_id,userId:n.user_id,initialDevice:ho(n.device)},t===m.METADATA_USER?{library:po(n.base_library),initialApplication:new Aa(n.application),initialSessionInfo:mo(n.user.initial_session_info),sessionReplay:n.session_replay}:{library:po(n.library),properties:vo(n.properties)})),type:so.AUP,timestamp:+new Date}},bo=function(e){var t=e.data;return{payload:new Ja({envId:t.env_id,userId:t.user_id,identity:t.identity,library:po(t.library),time:lo(t.time)}),type:so.Identify,timestamp:+new Date}},_o=function(e){var t=e.data,n={id:t.id,envId:Rr.getInstance().getEnvironmentId(),userId:t.user_id,identity:t.identity,time:lo(t.time),baseLibrary:po(t.base_library),sessionInfo:mo(t.session_info),application:new Aa(oo({},t.application)),device:ho(t.device),sessionReplay:t.session_replay,csProperties:yo(t.cs_properties)};switch(e.type){case m.METADATA_PAGEVIEW:n.pageviewInfo=go(t.pageview_info),n.kind={case:"pageview",value:new Sa},n.properties=vo(t.properties);break;case m.METADATA_SESSION:n.kind={case:"session",value:new Sa}}return{payload:new to(n),type:so.Track,kind:co.Meta,timestamp:+new Date}},Io={BUILTIN_KIND_UNSPECIFIED:Ga.UNSPECIFIED,BUILTIN_KIND_CLICK:Ga.CLICK,BUILTIN_KIND_TOUCH:Ga.TOUCH,BUILTIN_KIND_CHANGE:Ga.CHANGE,BUILTIN_KIND_SUBMIT:Ga.SUBMIT},ko=function(e){return"interaction"in e?function(e){return new Xa({kind:{case:"interaction",value:new Wa({kind:{case:"builtin",value:Io[e.interaction.kind]},hierarchy:e.interaction.hierarchy,nodes:(t=e.interaction.nodes,t.map((function(e){var t=function(e){return e.reduce((function(e,t){var n=t.name,r=t.value;return e[n]=r,e}),{})}(e.attributes);return{nodeName:e.tagName||"",nodeHtmlClass:e.classes?e.classes.join(" "):"",nodeId:e.id||"",nodeText:e.targetText||"",href:e.href||"",attributes:vo(t)}}))),sourceProperties:vo(e.interaction.source_properties)})}});var t}(e):function(e){return new Xa({kind:{case:"custom",value:new eo({name:e.custom.name,properties:vo(e.custom.properties),sourceProperties:vo(e.custom.source_properties)})}})}(e)},So=function(e){var t=e.data;return{payload:new to(oo(oo(oo({id:t.id,envId:Rr.getInstance().getEnvironmentId(),userId:t.user_id,identity:t.identity,time:lo(t.time),baseLibrary:po(t.base_library)},t.source_library&&{sourceLibrary:po(t.source_library)}),{},{application:oo({},t.application),device:ho(t.device),sessionInfo:mo(t.session_info),pageviewInfo:go(t.pageview_info),sessionReplayInfo:t.session_replay_info,sessionReplay:t.session_replay,properties:vo(t.properties)},t.event&&{kind:{case:"event",value:ko(t.event)}}),{},{csProperties:yo(t.cs_properties)})),type:so.Track,kind:co.Event,timestamp:+new Date}},Eo=function(e,t){return e<+new Date-1e3*t},Oo=604800,To=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e6,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e7,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ft;i(this,e),this.maxLocalStorageBufferSize=t,this.maxOverflowBufferSize=n,this.storage=r;var a=Rr.getInstance().getEnvironmentId();this.bufferKey="_hp5_network_buffer.".concat(a),this.overflowBuffer=[],this.storage.getItem(this.bufferKey)||this.storage.setItem(this.bufferKey,JSON.stringify([]))}return o(e,[{key:"addMessages",value:function(e){k.trace("MessageBatcherBuffer -- Adding events to buffer",e),this.appendBuffer(e)}},{key:"peakBuffer",value:function(e){return this.getFullBuffer().slice(0,e)}},{key:"commitPop",value:function(e){var t=this.getPrimaryBuffer().primaryBuffer,n=Math.min(this.overflowBuffer.length,e);this.overflowBuffer.splice(0,n);var r=e-n;t.splice(0,r),this.storage.setItem(this.bufferKey,JSON.stringify(t))}},{key:"getBufferSize",value:function(){var e=this.getPrimaryBuffer().primaryBuffer;return this.overflowBuffer.length+e.length}},{key:"getFullBuffer",value:function(){var e,t=JSON.parse(null!==(e=this.storage.getItem(this.bufferKey))&&void 0!==e?e:"[]"),n=[],r=t.map((function(e){try{if(Eo(e.timestamp,Oo))throw new Error("Message is older than 7 days, discarding");switch(e.type){case so.Track:return{type:so.Track,payload:to.fromJson(e.payload),kind:e.kind,timestamp:e.timestamp};case so.AUP:return{type:so.AUP,payload:Ma.fromJson(e.payload),timestamp:e.timestamp};case so.Identify:return{type:so.Identify,payload:Ja.fromJson(e.payload),timestamp:e.timestamp};default:throw new Error("Unsupported message type")}}catch(t){return k.trace("MessageBatcherBuffer -- invalid message for network flush, removing from buffer",{message:e,error:t.message}),n.push(e),null}})).filter((function(e){return null!==e})),i=t.filter((function(e){return!n.includes(e)}));if(i.length!==t.length){k.trace("MessageBatcherBuffer -- failed to parse messages, removing from primary buffer");var a=JSON.stringify(i);this.storage.setItem(this.bufferKey,a)}return r.concat(this.overflowBuffer)}},{key:"getPrimaryBuffer",value:function(){var e,t,n=(null!==(e=this.storage.getItem(this.bufferKey))&&void 0!==e?e:"").length;return{primaryBuffer:JSON.parse(null!==(t=this.storage.getItem(this.bufferKey))&&void 0!==t?t:"[]"),primaryBufferSizeInBytes:n}}},{key:"appendOverflowBuffer",value:function(e,t){var n;t+JSON.stringify(this.overflowBuffer).length>this.maxOverflowBufferSize?k.warn("MessageBatcherBuffer -- overflow buffer is too large, dropping messages",e):(n=this.overflowBuffer).push.apply(n,h(e))}},{key:"appendBuffer",value:function(e){var t=this.getPrimaryBuffer(),n=t.primaryBuffer,r=t.primaryBufferSizeInBytes,i=JSON.stringify(e);if(r+i.length>this.maxLocalStorageBufferSize)k.trace("MessageBatcherBuffer -- using overflow buffer",e),this.appendOverflowBuffer(e,i.length);else{n.push.apply(n,h(e));var a=JSON.stringify(n);k.trace("Saving primary buffer",a);try{this.storage.setItem(this.bufferKey,a)}catch(t){k.trace("Failed to save to primary buffer, using overflow buffer",{e:t}),this.appendOverflowBuffer(e,i.length)}}}}],[{key:"deleteQueue",value:function(){var e=Rr.getInstance();(new ft).removeItem("_hp5_network_buffer.".concat(e.getEnvironmentId()))}}]),e}(),Ao=To,Po=function(e){var t=e.map((function(e){return new to(e.payload)}));return new no({events:t}).toBinary()},No=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e6,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ft;i(this,e),this.maxLocalStorageBufferSize=t,this.storage=n;var r=Rr.getInstance().getEnvironmentId();this.bufferKey="_hp5_retry_buffer.".concat(r),this.storage.getItem(this.bufferKey)||this.storage.setItem(this.bufferKey,JSON.stringify([]))}return o(e,[{key:"addMessages",value:function(e){k.debug("RetryMessageBuffer -- Adding events to buffer after failed retries",e),this.appendBuffer(e)}},{key:"commitPop",value:function(e){var t=this.getPrimaryBuffer().primaryBuffer,n=t.splice(0,e);k.trace("RetryMessageBuffer -- removing messages from the buffer",{removedMessages:n}),this.storage.setItem(this.bufferKey,JSON.stringify(t))}},{key:"peakBuffer",value:function(e){var t=this.getPrimaryBuffer().primaryBuffer,n=t.splice(0,e),r=[],i=n.map((function(e){try{switch(e.type){case so.Track:return{type:so.Track,payload:to.fromJson(e.payload),kind:e.kind,timestamp:e.timestamp};case so.AUP:return{type:so.AUP,payload:Ma.fromJson(e.payload),timestamp:e.timestamp};case so.Identify:return{type:so.Identify,payload:Ja.fromJson(e.payload),timestamp:e.timestamp};default:throw new Error("Unsupported message type")}}catch(t){return k.trace("RetryMessageBatcher -- Failed to parse the following message for network flush, dropping the message",{message:e,error:t.message}),r.push(e),null}})).filter((function(e){return null!==e})),a=t.filter((function(e){return!r.includes(e)}));if(a.length!==t.length){k.trace("RetryMessageBatcher -- failed to parse messages, removing from primary buffer");var o=JSON.stringify(a);this.storage.setItem(this.bufferKey,o)}return i}},{key:"getBufferSize",value:function(){return this.getPrimaryBuffer().primaryBuffer.length}},{key:"getPrimaryBuffer",value:function(){var e,t,n=(null!==(e=this.storage.getItem(this.bufferKey))&&void 0!==e?e:"").length;return{primaryBuffer:JSON.parse(null!==(t=this.storage.getItem(this.bufferKey))&&void 0!==t?t:"[]"),primaryBufferSizeInBytes:n}}},{key:"appendBuffer",value:function(e){var t=this,n=this.getPrimaryBuffer(),r=n.primaryBuffer,i=n.primaryBufferSizeInBytes;e.forEach((function(e){var n=JSON.stringify(e),a=i+n.length;a>t.maxLocalStorageBufferSize?k.trace("RetryMessageBuffer -- capped out on failed messages, no longer adding"):(r.push(e),i=a)}));var a=JSON.stringify(r);k.trace("RetryMessageBuffer -- Saving primary buffer",a);try{this.storage.setItem(this.bufferKey,a)}catch(e){k.trace("RetryMessageBuffer -- Failed to save to primary buffer",{e:e})}}}],[{key:"deleteQueue",value:function(){var e=Rr.getInstance();(new ft).removeItem("_hp5_retry_buffer.".concat(e.getEnvironmentId()))}}]),e}(),Ro=No,jo=function(){function e(t){var n=this,a=t.client,o=t.flushInterval,u=void 0===o?3e3:o,s=t.maxBufferSize,c=void 0===s?10:s,f=t.initialRetryDelay,l=void 0===f?2e3:f,d=t.maxRetryDelay,v=void 0===d?5e3:d,p=t.maxRetries,h=void 0===p?3:p,g=t.maxLifetimeOfRequestsInSeconds,m=void 0===g?Oo:g,y=t.maxBatchSize,w=void 0===y?10:y;i(this,e),r(this,"backlogFailedRequests",(function(e){var t=e.originalBufferedMessages.filter((function(e){return!Eo(e.timestamp,n.maxLifetimeOfRequestsInSeconds)}));n.retryBuffer.addMessages(t)})),k.trace("Creating network."),e.instance=this,this.client=a,this.batchBuffer=new Ao,this.retryBuffer=new Ro,this.flushInterval=u,this.maxBufferSize=c,this.flushTimeout=null,this.maxRetryDelay=v,this.initialRetryDelay=l,this.maxRetries=h,this.maxLifetimeOfRequestsInSeconds=m,this.maxBatchSize=w,this.sendStatus={isSending:!1,numMessagesSending:null},this.flushRetryBuffer(),this.flushBufferOnInterval(),k.trace("Initialized network")}var t,a,u,s,c;return o(e,[{key:"getBufferSize",value:function(){return this.batchBuffer.getBufferSize()}},{key:"addMessages",value:function(e){var t=e.map(fo).filter((function(e){return null!==e}));k.trace("MessageBatcherBuffer -- schematized messages",{before:e,after:t}),this.batchBuffer.addMessages(t);var n=e.some((function(e){return e.type===m.METADATA_SESSION||e.type===m.METADATA_USER||e.type===m.METADATA_PAGEVIEW}));(this.batchBuffer.getBufferSize()>=this.maxBufferSize&&!this.sendStatus.isSending||n)&&this.flushBuffer()}},{key:"flushBuffer",value:(c=ue(ce().mark((function e(){var t,n;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==this.batchBuffer.getBufferSize()&&!this.sendStatus.isSending){e.next=5;break}return this.flushBufferOnInterval(),e.abrupt("return");case 5:return this.sendStatus={isSending:!0,numMessagesSending:null},this.flushTimeout&&window.clearTimeout(this.flushTimeout),this.sendStatus.numMessagesSending=this.batchBuffer.getBufferSize(),t=this.batchBuffer.peakBuffer(this.sendStatus.numMessagesSending),k.trace("Network -- flushing buffer",t),n=this.formRequests(t),e.next=13,this.retryAllRequestsUntilSuccess(n);case 13:this.batchBuffer.commitPop(this.sendStatus.numMessagesSending),this.sendStatus={isSending:!1,numMessagesSending:null},e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),k.error("Network -- error flushing buffer",{exception:e.t0});case 20:return e.prev=20,this.flushBufferOnInterval(),e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[0,17,20,23]])}))),function(){return c.apply(this,arguments)})},{key:"flushRetryBuffer",value:(s=ue(ce().mark((function e(){var t,n,r,i=this;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==(t=this.retryBuffer.getBufferSize())){e.next=4;break}return e.abrupt("return");case 4:return n=this.retryBuffer.peakBuffer(t),k.debug("Network -- flushing retry buffer on initial page load",n),r=this.formRequests(n),e.next=9,Promise.all(r.map((function(e){return i.sendSingleRequestWithBackoff(e,i.initialRetryDelay,Number.MAX_VALUE)})));case 9:k.trace("Network -- successfully flushed "),this.retryBuffer.commitPop(t),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),k.error("Network -- error flushing retry buffer, discarding messages",{exception:e.t0});case 16:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(){return s.apply(this,arguments)})},{key:"flushBufferOnUnload",value:function(){try{var e=this.batchBuffer.getBufferSize();if(0===e)return void k.trace("Network -- no messages to flush on unload");var t=this.batchBuffer.peakBuffer(e);this.formRequests(t).map((function(e){return(0,e.sendFunction)(e.payload,!0)})),k.debug("Network -- attempted to send requests on unload")}catch(e){k.warn("Network -- error flushing buffer on unload",{exception:e})}}},{key:"retryAllRequestsUntilSuccess",value:(u=ue(ce().mark((function e(t){var n=this;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return n.sendSingleRequestWithBackoff(e,n.initialRetryDelay,0)})));case 2:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"sendSingleRequestWithBackoff",value:(a=ue(ce().mark((function e(t,n,r){var i;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.sendSingleRequest(t);case 3:e.next=15;break;case 5:if(e.prev=5,e.t0=e.catch(0),!(r>=this.maxRetries)){e.next=10;break}return this.backlogFailedRequests(t),e.abrupt("return");case 10:return e.next=12,new Promise((function(e){return window.setTimeout(e,n)}));case 12:return i=Math.min(Math.pow(n,2),this.maxRetryDelay),k.error("Network -- Retrying request",{exception:e.t0}),e.abrupt("return",this.sendSingleRequestWithBackoff(t,i,r+1));case 15:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,t,n){return a.apply(this,arguments)})},{key:"sendSingleRequest",value:(t=ue(ce().mark((function e(t){var n,r,i,a,o;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,r=t.sendFunction,e.next=3,r(n);case 3:if(i=e.sent,a=i.ok,o=i.statusCode,a){e.next=8;break}throw new Error("Request failed with status code ".concat(o));case 8:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"formRequests",value:function(t){var n,i=this,a=e.groupByMessageType(t);k.debug("Network -- Messages being sent to server",t);var o=function(e,t){return e.reduce((function(e,n,r){var i=Math.floor(r/t);return e[i]||(e[i]=[]),e[i].push(n),e}),[])}(a[so.Track],this.maxBatchSize),u=(r(n={},so.Track,o.map((function(e){return{payload:Po(e),sendFunction:i.client.sendEvent,originalBufferedMessages:e}}))),r(n,so.AUP,a[so.AUP].map((function(e){return{payload:(t=e,n=t.payload,new Ma(n).toBinary()),sendFunction:i.client.sendAUP,originalBufferedMessages:[e]};var t,n}))),r(n,so.Identify,a[so.Identify].map((function(e){return{payload:(t=e,n=t.payload,new Ja(n).toBinary()),sendFunction:i.client.sendIdentify,originalBufferedMessages:[e]};var t,n}))),n),s=[].concat(h(u[so.AUP]),h(u[so.Track]),h(u[so.Identify]));return k.trace("Network -- Formed requests",s),s}},{key:"flushBufferOnInterval",value:function(){var e=this;this.flushTimeout&&window.clearTimeout(this.flushTimeout),Q.getInstance().getShouldStopTracking()||(this.flushTimeout=n.g.setTimeout(ue(ce().mark((function t(){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.flushBuffer();case 2:case"end":return t.stop()}}),t)}))),this.flushInterval))}}],[{key:"getInstance",value:function(t){if(!t&&!e.instance)throw new Error("Network instance not initialized");return e.instance?e.instance:new e(t)}},{key:"groupByMessageType",value:function(e){var t;return e.reduce((function(e,t){var n=t.type;return e[n]||(e[n]=[]),e[n].push(t),e}),(r(t={},so.Track,[]),r(t,so.AUP,[]),r(t,so.Identify,[]),t))}}]),e}(),Co=jo,Bo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return xr.getInstance().getMessagesToProcess(e)},xo=function(){return xr.getInstance().getAndClearAllMessages()},Do=function(e,t){if(e&&e.length){k.debug("Queue - enqueueing messages for networking and dequeueing from event processing after transformation",e);var n=Co.getInstance();xr.getInstance().dequeueMessages(e),n.addMessages(e),t&&t(e)}},Mo=function(){xr.getInstance().clearBuffer()},Lo=["undefined","anonymous","true","false","not_authenticated","NaN","NA","Na","unique_identifier","0","",'""',"[object Object]","{{ customer.email }}","{{ email }}",/^email$/i,/^none$/i,/^unknown$/i,/^guest$/i,/^null$/i],Uo=function(e){return!(!e||!j(e)&&!C(e)||C(e)&&!isFinite(e)||function(e){for(var t=0,n=Lo;t<n.length;t++){var r=n[t];if("string"==typeof r&&e===r)return!0;if(r instanceof RegExp&&r.test(e))return!0}return!1}("".concat(e)))},Fo=function(e,t){return"heap_autotrack"===e&&!j(t)&&"autotrack"===(null==t?void 0:t.name)},Jo=function(e,t,n){return!!Fo(e,n)||!(e&&!function(e){return!(!j(e)||!M(e,A))}(e)||t&&!function(e){return!!x(e)}(t)||n&&!function(e){return j(e)?!!M(e,A):!(!j(e.name)||!M(e.name,A)||e.version&&!j(e.version)||e.version&&!M(e.version,A)||e.platform&&!j(e.platform)||e.platform&&!M(e.platform,A))}(n))},qo=(r(uo={},so.Identify,"/api/capture/v2/identify"),r(uo,so.Track,"/api/capture/v2/track"),r(uo,so.AUP,"/api/capture/v2/add_user_properties"),uo),Vo=function(){function e(t){var n=this;i(this,e),r(this,"sendEvent",(function(e,t){return n.sendRequest(e,n.fullUrlPath(qo[so.Track]),t)})),r(this,"sendAUP",(function(e,t){return n.sendRequest(e,n.fullUrlPath(qo[so.AUP]),t)})),r(this,"sendIdentify",(function(e,t){return n.sendRequest(e,n.fullUrlPath(qo[so.Identify]),t)})),r(this,"sendRequest",function(){var e=ue(ce().mark((function e(t,n,r){var i,a,o;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.trace("CollectorNetworkClient -- Attempting send to ".concat(n)),e.prev=1,!r){e.next=6;break}return fetch(n,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:t}),k.trace("CollectorNetworkClient -- Fired off a request before unload",{payload:t}),e.abrupt("return",{ok:!1,statusCode:null});case 6:return e.next=8,fetch(n,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:t});case 8:return i=e.sent,a=i.ok,400===i.status&&(k.warn("CollectorNetworkClient -- Bad request to ".concat(n),{payload:t}),a=!0),o={ok:a,statusCode:i.status},k.trace("CollectorNetworkClient -- Response for send to ".concat(n),o),e.abrupt("return",o);case 16:return e.prev=16,e.t0=e.catch(1),e.abrupt("return",{ok:!1,statusCode:null});case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t,n,r){return e.apply(this,arguments)}}()),this.apiUrl=t}return o(e,[{key:"fullUrlPath",value:function(e){return"".concat(this.apiUrl).concat(e)}}]),e}(),zo=Vo,Ho=function(e,t){k.debug("enqueueing Heap API call because heap is not loaded");var n={name:e,fn:t};Oe.getInstance().enqueueHeapApi(n)},Ko=function(){var e;!function(){var e=Q.getInstance(),t=e.getIntegrations(),n=e.isSessionReplayDisabled();if(t&&0!==t.length){k.trace("Integrations -- loading");var r=Ne.getInstance().dependencies;t.forEach((function(e){try{if(n&&Ee.includes(e.name))return void k.trace("Integrations -- Skipping session replay adapter: ",{integration:e.name});e.fn(r),k.trace("Integrations -- executed ".concat(e.name))}catch(t){k.trace("Integrations -- Error executing ".concat(e.name))}}))}}(),(e=Ne.getInstance()).getAdaptersToRerunOnNewPageview().forEach((function(t){try{t.adapterFn(e.dependencies),k.trace("Adapters -- executed ".concat(t.name))}catch(e){k.trace("Adapters -- Error executing ".concat(t.name))}}))};function Qo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Wo=function(){vu.loaded&&wr()},Go=function(){Rr.getInstance().createNewSessionIfNeeded()},Yo=function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Rr.getInstance();a.clearPageviewMetadata(),Ko(),a.createNewPageviewIfNeeded({pageviewInfo:i}),t=null==i||null===(e=i.url)||void 0===e?void 0:e.path,nt()&&(k.debug("Contentsquare -- tracking cs pageview"),null===(n=window._uxa)||void 0===n||null===(r=n.push)||void 0===r||r.call(n,["trackPageview",t].filter(Boolean)))},$o=function(){var e=Rr.getInstance();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qo(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({envId:e.getEnvironmentId()},e.getMetadata())},Xo=function(){vu.loaded&&(Re.getInstance().setShouldIgnoreBlockingTransformers(!0),Wo(),iu(!0))},Zo=function(e){if(vu.loaded){var t=Rr.getInstance();t.getMetadata().lastEventTime+N<(new Date).getTime()?k.trace("updateLastEventTime -- session expired, ignoring"):t.updateLastEventTime(e)}},eu=function(e){var t=Rr.getInstance(),n=q(e);n&&t.addCustomPageviewProperties(n)},tu=function(e){Rr.getInstance().setMetadata({sessionProperties:{referrer:e}})},nu=!1,ru=function(){var e=function(){vu.loaded&&!nu&&(k.debug("Unload -- processing all messages in event processing queue"),Xo())};document.addEventListener("beforeunload",e,!0),document.addEventListener("visibilitychange",e,!0),document.addEventListener("pagehide",e,!0)},iu=function(e){var t=Co.getInstance();if(k.trace("flushNetworkQueue -- number of buffered network events is ".concat(t.getBufferSize())),t.flushBufferOnUnload(),e&&(nu=!0,t.getBufferSize())){var n=(new Date).getTime(),r=n;do{r=(new Date).getTime()}while(r<n+200)}};function au(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ou(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?au(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):au(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var uu=function(e){try{var t=new URL(e);return{domain:t.hostname,path:t.pathname,query:ct(t.search),hash:ct(t.hash)}}catch(t){return void k.warn("Error parsing URL ".concat(e,":"),t)}},su="_cs_optout",cu=function(){return(new ie).getItem(su)?(k.debug("".concat(su," was found in cookies")),!0):new URLSearchParams(window.location.search).has(su)?(k.debug("".concat(su," was found in query")),!0):!!window.location.hash.includes(su)&&(k.debug("".concat(su," was found in hash")),!0)};function fu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fu(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var du={addAdapter:function(e,t){!function(e){return!!e&&!(!j(e.name)||!D(e.fn))}(e)?k.warn("addAdapter called with an invalid adapter",{adapter:e}):!t||x(t)?(k.info("Adding adapter to registry",{adapter:e,config:t}),Ne.getInstance().registerAdapter(e,t)):k.warn("addAdapter called with an invalid configuration",{config:t})},markAdapterAsResolved:function(e){e&&j(e)?Ne.getInstance().markAdapterAsResolved(e):k.warn("markAdapterAsResolved called with an invalid adapterName",{adapterName:e})},addTransformer:function(e,t){!function(e){return!!e&&!!(j(e.name)&&D(e.getTarget)&&D(e.transform)&&D(e.transformFn))}(e)?k.warn("addTransformer called with an invalid transformer",{transformer:e}):!t||[Me.GENERAL,Me.METADATA].includes(t)?(k.info("Adding transformer to registry",{transformer:e,pipelineName:t}),an.getInstance().registerTransformer(e,t)):k.warn("addTransformer called with an invalid pipeline, can only be general or metadata",{pipelineName:t})},addTransformerFn:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Me.GENERAL,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&t&&j(e)&&D(t)?!n||[Me.GENERAL,Me.METADATA].includes(n)?(k.info("Adding transformer function to registry",{name:e,transformerFn:t,pipelineName:n}),r?an.getInstance().registerTransformerFnAsync(e,t,n):an.getInstance().registerTransformerFn(e,t,n)):k.warn("addTransformerFn called with an invalid pipeline, can only be general or metadata",{pipelineName:n}):k.warn("Transformer function must have a valid name and a function",{name:e,transformerFn:t})},removeTransformer:function(e){e&&j(e)?an.getInstance().removeTransformer(e):k.warn("removeTransformer called with an invalid transformer name",{transformerName:e})},resetTransformers:function(){an.getInstance().resetTransformers()},addNetworkClient:function(e){}},vu=lu(lu({appid:"",loaded:!1,config:{}},du),{},{init:function(e,t,n){try{if(vu.loaded)return void k.debug("heap.init was called multiple times. duplicate calls will have no effect");var r=k.getLogLevelFromStorage(e);if(r?k.setLogLevel(r):null!=t&&t.logLevel&&k.setLogLevel(t.logLevel),k.trace("Initializing heap"),!e||!j(e))return void k.error("heap.init was called with an invalid environment ID: ".concat(e));var i=Q.getInstance();i.setConfig(i.resolveConfig(t,n));var a=Rr.getInstance();a.setEnvironmentId(e);var o=Oe.getInstance();if(o.executeStopTrackingAndStopRecording(),Q.getInstance().getShouldStopTracking())return void k.info("Heap has been disabled for this client, preventing initialization");if(cu())return void k.debug("Terminating heap initialization");vu.loaded=!0,vu.appid=e,vu.config=i.getConfig(),function(){k.trace("initNetwork");var e,t=Q.getInstance().getIngestServer(),n=new zo((e=t).startsWith("http://")||e.startsWith("https://")?e:"https://".concat(e));new Co({client:n})}(),Ir(),wt(),function(){var e=Rr.getInstance(),t=e.getEnvironmentId(),n=Q.getInstance().getMetadataStorageType()===w.COOKIES?w.LOCAL_STORAGE:w.COOKIES,r=new Rr(t,n),i=e.getMetadata(),a=r.getMetadata(),o=i.lastEventTime,u=a.lastEventTime;o&&u?u>o&&e.setMetadata(a):u&&e.setMetadata(a),r.deleteMetadata()}(),u=kt.getInstance(),s=Q.getInstance().getEventPropertiesStorageType()===w.COOKIES?w.LOCAL_STORAGE:w.COOKIES,c=new kt(s),f=u.getProperties(),l=ou(ou({},c.getProperties()),f),u.addProperties(l),c.clearProperties(!1),o.executeHeapApiQueue(),a.setMetadataStateFromCrossDomainContextIfPresent(),a.createNewUserIfNeeded(),a.createNewSessionIfNeeded(),a.createNewPageviewIfNeeded(),Ne.getInstance().initializeAdapters({getSnapshotProperties:Yn,getSnapshotDefinitions:Qn,track:vu.track,logger:k,getConfig:vu.getConfig,getSessionMetadata:$o,createNewSessionIfNeeded:Go,createNewPageview:Yo,flushQueueOnUnload:Xo,flushEventQueue:Wo,addTransformerFn:du.addTransformerFn,addPageviewProperties:eu,setReferrer:tu,updateLastEventTime:Zo,onReady:vu.onReady}),k.debug("Heap initialization is complete"),Ne.getInstance().shouldBlockEventProcessing()||o.getOnReadyQueueHasBeenFlushed()||o.executeOnReadyQueue(),ru()}catch(e){vu.loaded=!1,k.error("Failed to initialize heap",e)}var u,s,c,f,l},startRecording:function(e,t){},stopRecording:function(){},stopTracking:function(e){k.debug("heap.stopTracking was called"),vu.loaded=!1,Q.getInstance().setShouldStopTracking(!0),n.g.clearInterval(mr),e&&(k.debug("heap.stopTracking -- clearing state"),Rr.getInstance().clearMetadata(),kt.getInstance().clearProperties(),Ao.deleteQueue(),Ro.deleteQueue(),bt.deleteV4Cookies())},track:function(e,t,n){if(Jo(e,t,n))if(vu.loaded){var r,i=O(),a=j(n)?{name:n,version:"0.0.0",platform:"web"}:n;(r=[{id:i,type:y.CORE_TRACK,info:{event:e,properties:t,source:a,isAutotrack:Fo(e,a)},data:{id:i,time:(new Date).getTime()}}])&&r.length&&(k.debug("".concat(jr.EVENT_PROCESSING_QUEUE," - enqueueing messages from adapters to EPQ"),r),xr.getInstance().enqueueMessages(r))}else Ho("track",(function(){vu.track(e,t,n)}));else k.debug("heap.track was called with bad arguments.",{event:e,properties:t,sourceInfo:n})},trackPageview:function(e){if(vu.loaded){wr();var t=function(e){if(e){var t,n,r,i,a;e.url&&j(e.url)&&(t=uu(e.url)),e.properties&&(n=q(e.properties)),e.source_properties&&(r=q(e.source_properties)),e.previous_page&&j(e.previous_page)&&(i=e.previous_page),e.title&&(a=J(e.title,T));var o=V({title:a,url:t,source_properties:r,properties:n,previous_page:i});return k.info("Validating pageview properties -- ",{before:e,after:o}),o}}(e);Yo(t)}else Ho("trackPageview",(function(){vu.trackPageview(e)}))},identify:function(e){if(Uo(e))if(vu.loaded){var t=Rr.getInstance(),n=t.getIdentity(),r=J("".concat(e),T);n!==r?n?(wr(),k.info("Clearing current identity ".concat(n," and creating a new user")),t.clearMetadata(),t.createNewUserIfNeeded({identity:r,heapDrives:!0})):(t.createNewSessionIfNeeded({heapDrives:!0}),_r(r)):k.info("heap.identify was called with the existing identity: ".concat(n))}else Ho("identify",(function(){vu.identify(e)}));else k.info("heap.identify was called with a bad identity",{identity:e})},resetIdentity:function(){if(vu.loaded){var e=Rr.getInstance(),t=e.getIdentity();t?(wr(),k.info("Clearing current identity ".concat(t," and creating a new user")),e.clearMetadata(),e.createNewUserIfNeeded({heapDrives:!0})):k.info("heap.resetIdentity called on an anonymous user - no action")}else Ho("resetIdentity",(function(){vu.resetIdentity()}))},addUserProperties:function(e){!function(e){return!(!x(e)||0===Object.keys(e).length)}(e)?k.info("heap.addUserProperties was called with bad properties: ".concat(e)):vu.loaded?function(e){Q.getInstance().getShouldStopTracking()||yr.getInstance().transformAndRelay([{type:y.CORE_ADD_USER_PROPERTIES,id:O(),info:{properties:e,time:(new Date).getTime()}}],Me.ADD_USER_PROPERTIES)}(e):Ho("addUserProperties",(function(){vu.addUserProperties(e)}))},addEventProperties:function(e){if(x(e))if(vu.loaded){var t=q(e);kt.getInstance().addProperties(t)}else Ho("addEventProperties",(function(){vu.addEventProperties(e)}));else k.info("heap.addEventProperties was called with bad properties: ".concat(e))},removeEventProperty:function(e){j(e)?vu.loaded?kt.getInstance().removeEventProperty(e):Ho("removeEventProperty",(function(){vu.removeEventProperty(e)})):k.info("heap.removeEventProperty was called with a bad value: ".concat(e))},clearEventProperties:function(){vu.loaded?kt.getInstance().clearProperties():Ho("clearEventProperties",(function(){vu.clearEventProperties()}))},addPageviewProperties:function(e){if(x(e))if(vu.loaded){var t=Rr.getInstance(),n=q(e);n&&t.addCustomPageviewProperties(n)}else Ho("addPageviewProperties",(function(){vu.addPageviewProperties(e)}));else k.info("heap.addPageviewProperties was called with bad properties: ".concat(e))},removePageviewProperty:function(e){j(e)?vu.loaded?Rr.getInstance().removeCustomPageviewProperty(e):Ho("removePageviewProperty",(function(){vu.removePageviewProperty(e)})):k.info("heap.removePageviewProperty was called with a bad value: ".concat(e))},clearPageviewProperties:function(){vu.loaded?Rr.getInstance().clearCustomPageviewProperties():Ho("clearPageviewProperties",(function(){vu.clearPageviewProperties()}))},getSessionId:function(e){var t=Rr.getInstance();if(t.hasSessionExpired())return k.debug("heap.getSessionId - session has expired"),e&&e(null),null;if(t.getHasSessionBeenQueued()){var r=t.getSessionId();return e&&e(r),r}if(k.debug("heap.getSessionId - session has not been instantiated"),e){var i=n.g.setInterval((function(){if(k.trace("heap.getSessionId - checking if session has been created"),t.getHasSessionBeenQueued()){n.g.clearInterval(i);var r=t.getSessionId();e(r)}}),200);n.g.setTimeout((function(){n.g.clearInterval(i)}),3e3)}return null},getUserId:function(e){var t=Rr.getInstance();if(t.getHasUserBeenQueued()){var r=t.getUserId();return e&&e(r),r}if(k.debug("heap.getUserId - user has not been instantiated"),e){var i=n.g.setInterval((function(){if(k.trace("heap.getUserId - checking if user has been created"),t.getHasUserBeenQueued()){n.g.clearInterval(i);var r=t.getUserId();e(r)}}),200);n.g.setTimeout((function(){n.g.clearInterval(i)}),3e3)}return null},getIdentity:function(e){var t=Rr.getInstance().getIdentity()||null;return e&&e(t),t},getConfig:function(){return Q.getInstance().getConfig()},setLogLevel:function(e){Object.values(g).includes(e)&&k.setLogLevel(e,vu.appid)},onReady:function(e){!vu.loaded||Ne.getInstance().shouldBlockEventProcessing()?function(e){k.debug("enqueueing onReady callback because heap is not loaded");var t={name:"onReady",fn:e};Oe.getInstance().enqueueOnReady(t)}(e):(k.debug("heap.onReady -- heap is already loaded, executing function",{callback:e}),e())},getReplayId:function(){return function(){if(!window.auryc)return"Auryc object is not present in this window";var e=window.auryc.getSessionMetadata(),t=e.replayUrl,n=e.siteId,r=e.sessionId,i=e.sampled,a=e.isOver;return i&&!a?{aurycParams:encodeURIComponent("".concat(n,"/").concat(r,"/").concat((new Date).getTime())),replayUrl:t}:"Session Replay is not active or is over for this session."}()},setPath:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.UserSession;if(j(e)&&Object.values(ut).includes(t))if(vu.loaded){var n=window.location.origin+e,r=uu(n);if(r&&r.path)Rr.getInstance().setMetadata({setPath:{path:r.path,query:null==r?void 0:r.query,hash:null==r?void 0:r.hash,lifespan:t}})}else Ho("setPath",(function(){vu.setPath(e,t)}));else k.info("heap.setPath was called with a bad value:",{path:e,lifespan:t})}}),pu=function(e){return e?e.replace(/[[\];|\n]/g,""):e},hu=function(e,t){return e.map((function(e){return{name:pu(e.name),value:e.value&&e.value.length<=t?pu(e.value):""}}))},gu=1024,mu="****",yu=["heap-ignore","data-cs-encrypt"],wu=["data-heap-redact-text","data-cs-mask"],bu=["class","data-com.agilebits.onepassword.initial-value","data-com.onepassword.iv","data-ember-action","data-initial-value","data-previous-value","data-react-checksum","data-reactid","id","maxlength","onclick","onsubmit","style"];function _u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Iu=function(e,t){return An(e)?(ku(e)||[]).filter((function(e){return e.name.length<t&&(e.name.includes("data-")||"aria-label"===e.name)})):(ku(e)||[]).filter((function(n){return n.name.length<t&&!("INPUT"===e.tagName&&"value"===n.name)}))},ku=function(e){for(var t=[],n=0;n<e.attributes.length;n++){var r=e.attributes[n],i=r.name,a=r.value;e.value&&a===e.value&&"value"!==i&&(a="heap_redacted"),t.push({name:i,value:a})}return t},Su=function(e){var t=e.getAttribute("data-heap-redact-attributes");return t?t.split(","):[]},Eu=function(e){var t;return((null===(t=window.UXAnalytics)||void 0===t?void 0:t.Sensitive.getSensitiveAttributes(e))||[]).map((function(e){return e.name}))},Ou=function(e){var t=h(bu);return e.map((function(e){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_u(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return t.push.apply(t,h(e.heapRedactedAttributes)),n.attributes=e.attributes.filter((function(e){return-1===t.indexOf(e.name)})),n}))};function Tu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Au(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Au(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function Au(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pu=function(e,t){if(!On(e)||(n=t,"[object Number]"!==Object.prototype.toString.call(n)))return e;var n,r,i="",a=0,o=Tu(e);try{for(o.s();!(r=o.n()).done;){var u=r.value,s=u.codePointAt(0),c=s&&s>65535?2:1;if(!(a+c<=t))break;i+=u,a+=c}}catch(e){o.e(e)}finally{o.f()}return i},Nu=function(e,t){if(Cu(e)||ot()&&function(e){var t;return null===(t=window.UXAnalytics)||void 0===t?void 0:t.Sensitive.isNodeSensitive(e)}(e))return mu;var n=Ln(e),r=Ru(e),i=ju(r);return Bu(n,i,t)},Ru=function(e){var t=yu.map((function(e){return"[".concat(e,"]")})),n=Array.prototype.slice.call(e.querySelectorAll(t.join(","))),r=wu.map((function(e){return"[".concat(e,"]")})),i=Array.prototype.slice.call(e.querySelectorAll(r.join(",")));return n.concat(i)},ju=function(e){return e.map(Ln)},Cu=function(e){return!!Mn(e,(function(e){return wu.some((function(t){return e.hasAttribute(t)}))}))},Bu=function(e,t,n){var r=t.map((function(e){return e.trim()})),i=r.sort((function(e,t){return e.length>=t.length?-1:1})),a=e;if(i.forEach((function(e){var t;e&&(a=(t={originalText:a,substringToReplace:e,replacementText:mu}).originalText.replace(new RegExp(t.substringToReplace.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),"g"),t.replacementText))})),ot()){var o=new Ze,u=o.anonymizePII(a);a=o.anonymizeCreditCard(u)}return a=function(e,t){return On(e)?e=Pu(e.trim(),t):e}(a,n),a},xu=function(e,t){return e.findIndex((function(e){return e.name===t}))};function Du(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function Mu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Lu=function(e){var t;return e.length>1?(null===(t=pe.getInstance().coreAPIs)||void 0===t||t.logger.trace("Autocapture -- removing BODY node"),e.filter((function(e){return"body"!==e.tagName.toLowerCase()}))):e},Uu=function(e,t,n){var r=Lu(e);if(0===r.length)return r;var i=function(e){for(var t=-1,n=-1,r=0;r<e.length;r++){var i=e[r],a=xu(i.attributes,"href")>-1;if(-1===t&&a&&(t=r),(n=i.heapRedactedAttributes.indexOf("href")>-1?r:-1)>-1)break}return function(){if(-1!==t){if(n>=t)return mu;var r=e[t].attributes;return r[xu(r,"href")].value}}()}(r);r[0].href=Pu(i,gu);var a=function(e,t){var n,r,i=e,a=null===(n=pe.getInstance().coreAPIs)||void 0===n?void 0:n.getConfig();return!(null!=a&&null!==(r=a.privacy)&&void 0!==r&&r.disableTextCapture)&&"change"!==t&&!i.isContentEditable&&"textarea"!==i.tagName.toLowerCase()&&On(Ln(i))}(t,n);return r[0].targetText=a?Nu(t,64):"",r},Fu=function(e){for(var t,n=e.maxAttributeLength,r=e.targetElement,i=[];r&&"HTML"!==r.tagName;){var a=Tn(t=r)||An(t)?Iu(r,n):[],o=Ju(r),u=qu(r),s=Su(r);if(ot()){var c,f=null!==(c=Eu(r))&&void 0!==c?c:[];s=[].concat(h(s),h(f))}var l={tagName:r.tagName.toLowerCase(),id:pu(o),classes:u.map(pu),attributes:hu(a,n),heapRedactedAttributes:s};i.push(l),r=En(r.parentNode)?r.parentNode.host:r.parentElement}return i.reverse()},Ju=function(e){return Hu(e,"id")||null},qu=function(e){return zu(e)?zu(e).split(/\s+/):[]},Vu=function(e){var t,n=e.topFirstDecomposedHierarchy,r=e.maxHierarchyLength,i="",a=Du(Lu(n).reverse());try{for(a.s();!(t=a.n()).done;){var o=t.value,u="";u="@".concat(o.tagName,";"),u+=o.id?"#".concat(o.id,";"):"",u+=o.classes.length>0?".".concat(o.classes.sort().join(";."),";"):"";var s=o.attributes.map((function(e){return"[".concat(e.name,"=").concat(e.value,"]")})).sort();if(u+=s.length>0?"".concat(s.join(";"),";"):"",(u+="|").length+i.length>r){var c;null===(c=pe.getInstance().coreAPIs)||void 0===c||c.logger.debug("Autocapture -- truncating hierarchy string as it exceeds ".concat(r));break}i=u+i}}catch(e){a.e(e)}finally{a.f()}return i},zu=function(e){return((An(e)?e.className?e.className.baseVal:e.getAttribute("class"):e.className)||"").trim()},Hu=function(e,t){return"form"===e.tagName.toLowerCase()?e.getAttribute(t)||"":e[t]},Ku=function(e){return e.BUILTIN_KIND_CLICK="BUILTIN_KIND_CLICK",e.BUILTIN_KIND_CHANGE="BUILTIN_KIND_CHANGE",e.BUILTIN_KIND_SUBMIT="BUILTIN_KIND_SUBMIT",e}({}),Qu=function(){function e(){i(this,e),r(this,"eventHistory",[]),r(this,"clickEventHistory",[])}return o(e,[{key:"addClickEvent",value:function(t){if(e.isClickEvent(t)){var n=t;this.clickEventHistory.length>e.MAX_CLICK_HISTORY_SIZE&&this.clickEventHistory.shift(),this.clickEventHistory.push({coordinates:{X:n.clientX,Y:n.clientY},time:t.timeStamp})}}},{key:"addEvent",value:function(t){this.eventHistory.length>e.MAX_HISTORY_SIZE&&this.eventHistory.shift(),this.eventHistory.push(t),this.addClickEvent(t)}},{key:"hasMatchingEvent",value:function(e){return this.eventHistory.includes(e)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"resetEventHistory",value:function(){e.instance=new e}},{key:"isClickEvent",value:function(e){return e instanceof PointerEvent}}]),e}();r(Qu,"MAX_HISTORY_SIZE",20),r(Qu,"MAX_CLICK_HISTORY_SIZE",5);var Wu=function(){var e=Qu.getInstance().clickEventHistory,t=e[e.length-1],n=e[0];return!(t.time-n.time>3e3)},Gu=function(){for(var e=Qu.getInstance().clickEventHistory,t=0,n=0;n<e.length-1;n++)for(var r=n+1;r<=e.length-1;r++){var i=Math.round(Math.sqrt(Math.pow(e[n].coordinates.X-e[r].coordinates.X,2)+Math.pow(e[n].coordinates.Y-e[r].coordinates.Y,2)));if(i>t&&(t=i),i>100)return!1}return!0},Yu=function(e){var t=Qu.getInstance().clickEventHistory;return!!(Qu.isClickEvent(e)&&t.length>=5)&&(Wu()&&Gu())},$u=function(e){return{click:Ku.BUILTIN_KIND_CLICK,change:Ku.BUILTIN_KIND_CHANGE,submit:Ku.BUILTIN_KIND_SUBMIT}[e]},Xu=function(e){var t={};return Yu(e)&&(t.rage_click=!0),t},Zu=function(e){var t,n,r=Sn(e),i="mouseup"===e.type?"click":e.type,a=function(e){var t=e.targetElement,n=e.type,r=e.maxAttributeLength,i=e.maxHierarchyLength,a=Fu({targetElement:t,maxAttributeLength:r}),o=JSON.parse(JSON.stringify(a)),u=Ou(a),s=Vu({topFirstDecomposedHierarchy:u,maxHierarchyLength:i}),c=Uu(o.reverse(),t,n);return{hierarchyString:s,topFirstNodes:Ou(c.reverse())}}({targetElement:r,type:i,maxAttributeLength:255,maxHierarchyLength:gu}),o=a.hierarchyString,u=a.topFirstNodes,s=null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.getSnapshotDefinitions(i,o),c=null===(n=pe.getInstance().coreAPIs)||void 0===n?void 0:n.getSnapshotProperties(s,e),f=function(e,t){if(JSON.stringify(e).length<=t)return e;for(var n=[],r="",i=0;i<e.length;i++){var a=e[i],o=JSON.stringify(a);if(r.length+o.length>t)break;n.push(a),r+=o}return n}(u.reverse(),2048);return{kind:$u(i),hierarchy:o,nodes:f,source_properties:Xu(e),snapshotProperties:c}},es=function(e){var t,n=null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.logger,r=e.target;if("mousedown"===e.type||"mousemove"===e.type)return!0;if(!r)return null==n||n.trace("Autocapture -- event missing a target, ignoring",{event:e}),!0;if(!r.tagName)return null==n||n.trace("Autocapture -- event target is missing a tagName, ignoring",{event:e}),!0;if(3===r.nodeType)return null==n||n.trace("Autocapture -- event target is a text node, ignoring",{event:e}),!0;var i,a,o;return ot()&&((i=r).firstChild&&(null===(a=window.UXAnalytics)||void 0===a||null===(o=a.Encryption)||void 0===o?void 0:o.shouldEncrypt(i.firstChild)))?(null==n||n.trace("Autocapture -- event target is encrypted, ignoring",{event:e}),!0):!!Mn(r,(function(e){return yu.some((function(t){return e.hasAttribute(t)}))}))&&(null==n||n.trace("Autocapture -- event is under an ignored attribute element, ignoring",{event:e}),!0)},ts=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.logger;if(!es(e)){var a=Qu.getInstance();if(a.hasMatchingEvent(e)){var o;null==i||null===(o=i.trace)||void 0===o||o.call(i,"".concat(e.type," event has already been seen, ignoring"),{event:e,clickEventHistory:a.eventHistory})}else{a.addEvent(e);var u,s=Zu(e);if(r)return null===(u=pe.getInstance().coreAPIs)||void 0===u?void 0:u.track(e.type,s);s.hierarchy||s.nodes&&0!==s.nodes.length?(null===(n=pe.getInstance().coreAPIs)||void 0===n||n.logger.trace("Autocapture -- queuing event",{event:e,props:s}),function(e){var t;null===(t=pe.getInstance().coreAPIs)||void 0===t||t.track("heap_autotrack",e,{name:"autotrack"})}(s)):null==i||i.debug("Autocapture -- discarding event, missing hierarchy",{event:e,props:s})}}},ns=function(e){ts(e,!0)},rs=function(e){var t,n,r=((null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.getConfig().disableInteractionEvents)||[]).includes(e);r&&(null===(n=pe.getInstance().coreAPIs)||void 0===n||n.logger.info("Autocapture -- ".concat(e," capture has been disabled")));return r},is="change",as=function(){return navigator.appVersion},os=function(){return as().indexOf("Safari")>-1},us=function(){var e=navigator.userAgent,t=e.match(/iPad/i)||e.match(/iPhone/i),n=e.match(/WebKit/i);return t&&n&&!e.match(/CriOS/i)},ss=function(e){var t=e.tagName.toLowerCase(),n=On(e.type)?e.type.toLowerCase():e.type;return null!==Un(e)&&("input"===t&&["submit","image"].includes(n)||"button"===t&&!["reset","button"].includes(n))},cs=function(e){return fs(e)?e.animVal:e},fs=function(e){return"string"==typeof e.animVal},ls=function(e,t){return e.hasAttribute?e.hasAttribute(t):function(e,t){var n=e.getAttributeNode(t);return!(!n||!n.specified&&!n.nodeValue)}(e,t)},ds=function(e){if(!e||!e.href)return!1;if(function(e){return ls(e,"data-turbo-frame")||ls(e,"data-heap-turbo")}(e))return!1;var t=cs(e.href),n=ls(e,"download"),r=new RegExp("^\\s*("+window.location.href.split(window.location.hash||"#")[0].replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")+")?#").test(t),i=/^\s*javascript:/.test(t),a=/^\s*(mailto|tel):/.test(t)&&os(),o="ar"===e.rel&&/\.usdz/i.test(t)&&os();return!(e.isContentEditable||n||r||i||a||o)},vs=function(e,t){window.addEventListener(e.type,(function n(r){window.removeEventListener(r.type,n),r!==e||r.defaultPrevented||t(r)}))},ps=function(e,t){var r,i;null===(r=pe.getInstance().coreAPIs)||void 0===r||r.logger.debug("Autocapture -- flushing queue before leaving page",{event:e});var a,o,u=(a=t,o=!1,function(){if(!o){o=!0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.apply(void 0,t)}});!function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(e),n.g.setTimeout(u,300),null===(i=pe.getInstance().coreAPIs)||void 0===i||i.flushQueueOnUnload()},hs=function(){function e(){i(this,e),this.clickedSubmitEventElements=[]}return o(e,[{key:"addEvent",value:function(e){this.clickedSubmitEventElements.push(e)}},{key:"getEvents",value:function(){return this.clickedSubmitEventElements}},{key:"clearEvents",value:function(){this.clickedSubmitEventElements=[]}},{key:"findLast",value:function(e){for(var t=this.clickedSubmitEventElements.length-1;t>=0;t--){var n=this.clickedSubmitEventElements[t];if(e(n))return n}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),gs="click",ms=function(e){var t,n,r,i=null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.logger;if(null==i||i.trace("Autocapture -- click event",{event:e}),"click"===e.type){var a=hs.getInstance();if(ts(e),r=1&(n=e).button?1:0,1===(n.which||void 0===n.button?n.which:r)){var o=Sn(e),u=Mn(o,ss),s=null!==u,c="__impl4cf1e782hg__"in e&&void 0!==e.__impl4cf1e782hg__;s?(a.addEvent([e,u]),null==i||i.trace("Autocapture -- clicked event is form submit click",{event:e,clickedSubmitEventElements:a.getEvents()})):!c&&function(e){return!(e.metaKey||e.shiftKey||e.ctrlKey||e.altKey)}(e)&&vs(e,(function(){null==i||i.trace("Autocapture -- event fully propagated");var t=function(e){for(;e&&(void 0===e.tagName||"a"!==e.tagName.toLowerCase()||!e.href);)e=e.parentNode;return e}(o);try{!function(e){var t,n,r,i,a=null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.logger,o=(null===(n=pe.getInstance().coreAPIs)||void 0===n?void 0:n.getConfig().supportedDomains)||[];if(e&&e.href){var u=new URL(document.location.href),s=new URL(e.href);if(u.hostname!==s.hostname)if(o.some((function(e){return s.hostname.includes(e)}))){null===(r=pe.getInstance().coreAPIs)||void 0===r||r.createNewSessionIfNeeded();var c=null===(i=pe.getInstance().coreAPIs)||void 0===i?void 0:i.getSessionMetadata();if(c){var f=c.envId,l=c.userId,d=c.sessionId,v=c.identity,p=c.sessionProperties.time,h="".concat(f,";").concat(l,";").concat(d,";").concat(null!=p?p:"",";").concat(null!=v?v:""),g=new URL(e.href);g.searchParams.set("_hp5_cdc",h),e.href=g.toString()}else null==a||a.error("decorateLink -- Unable to receive metadata from core API dependencies on decorator")}else null==a||a.trace("decorateLink -- Redirecting to unsupported domain, no need to decorate");else null==a||a.trace("decorateLink -- Redirecting to the same domain, no need to decorate")}}(t)}catch(e){null==i||i.trace("Autocapture CDT -- Failed to decorate link for CDT, continuing",{error:e})}if(ds(t)){var n=cs(t.href),r=t.target||(document.getElementsByTagName("base")[0]||{}).target;null==i||i.trace("Autocapture -- should intercept href",{target:r}),r&&"_self"!==cs(r).toLowerCase()?r.match(/^_(parent|top)$/i)&&ps(e,(function(){window.open(n,r)})):ps(e,(function(){document.location.href=n}))}}))}}},ys="submit",ws=function(t){var r,i=null===(r=pe.getInstance().coreAPIs)||void 0===r?void 0:r.logger,a=t||window.event;if(null==i||i.trace("Autocapture -- submit event",{event:a}),ts(a),o=as(),u=null,o&&(o.indexOf("MSIE 6.")>-1?u=6:o.indexOf("MSIE 7.")>-1?u=7:o.indexOf("MSIE 8.")>-1?u=8:o.indexOf("MSIE 9.")>-1&&(u=9)),!u){var o,u,s,c,f=a.target,l=hs.getInstance(),d=l.findLast((function(e){var t=e[1];return Un(t)===f}));l.clearEvents(),d&&(s=d[0],c=d[1]),vs(a,(function(){var t,r=(t=c)?["formAction","formEnctype","formMethod","formNoValidate","formTarget","name","type","value"].reduce((function(e,n){return ls(t,n)&&(e[n]=t[n]),e}),{}):{},o=(c||{}).tagName;"_blank"!==(null==f?void 0:f.target)&&ps(a,(function(){try{var t,a,u,l={};try{var d=(Array.from(f.querySelectorAll("input"))||[]).filter((function(e){if(!e.inputmask)return!1;var t=e.inputmask._valueSet&&e.inputmask._valueGet&&e.inputmask.unmaskedvalue,n=e.inputmask.userOptions&&e.inputmask.userOptions.removeMaskOnSubmit||e.inputmask.opts&&e.inputmask.opts.removeMaskOnSubmit;return t&&n})),v=d.map((function(e){return e.inputmask._valueGet()}));d.forEach((function(e){e.inputmask._valueSet(e.inputmask.unmaskedvalue())})),n.g.setTimeout((function(){d.forEach((function(e,t){e.inputmask._valueSet(v[t])}))}),0)}catch(e){null==i||i.error("Autocapture -- Error extracting values from form submission",{event:e})}if(c){var p=r.type,h=On(p)?p.toLowerCase():p;if("input"===o.toLowerCase()&&"image"===h){var g=r.name,m=function(e){var t=e,n=t.target||t.srcElement;if(0===t.screenX&&0===t.screenY||!n)return[0,0];var r=n instanceof Element&&n.getBoundingClientRect();if(!r)return[0,0];var i=Math.floor(t.clientX-r.left),a=Math.floor(t.clientY-r.top),o=!(void 0===t.offsetX&&void 0===t.offsetY||0===t.offsetX&&0===t.offsetY);return[o?t.offsetX:i,o?t.offsetY:a]}(s);(a=document.createElement("input")).type="hidden",a.name=g?g+".x":"x",a.value=m[0].toString(),(u=document.createElement("input")).type="hidden",u.name=g?g+".y":"y",u.value=m[1].toString(),f.appendChild(a),f.appendChild(u)}else{(t=document.createElement("input")).type="hidden","name"in r&&(t.name=r.name);var y=r.value;null!=y&&""!==y&&(t.value=r.value),f.appendChild(t)}["action","enctype","method","noValidate","target"].forEach((function(e){var t,n="form"+(0===(t=e).length?t:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase());n in r&&(l[e]=f[e],f[e]=r[n])}))}if("dialog"===f.method)try{var w=Mn(f,(function(e){return"dialog"===e.tagName.toLowerCase()})),b=s.target,_=s.target&&b.value;w&&w.close&&_&&w.close(_)}catch(e){null==i||i.warn("Failed to close dialog for a form submission with method=dialog")}var I=document.createElement("form");document.body.appendChild(I),I.submit.apply(f),document.body.removeChild(I),function(t){for(var n=0;n<(arguments.length<=1?0:arguments.length-1);n++){var r=n+1<1||arguments.length<=n+1?void 0:arguments[n+1];if(r&&"object"===e(r))for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}}(f,l),t&&f.removeChild(t),a&&u&&(f.removeChild(a),f.removeChild(u))}catch(e){null==i||i.error("Autocapture -- Error preventing form submission",{event:e})}}))}))}},bs=function(e){var t;if(e&&e.querySelectorAll){var n=(null===(t=pe.getInstance().coreAPIs)||void 0===t?void 0:t.flushQueueOnUnload)||function(){};e.querySelectorAll("a").forEach((function(e){e.addEventListener("click",n)})),e.querySelectorAll("form").forEach((function(e){e.addEventListener("submit",n)})),e.querySelectorAll("[onClick]").forEach((function(e){e.addEventListener("click",n)}))}};function _s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Is=function(){return window.location.pathname+window.location.hash+window.location.search},ks=Is(),Ss=function(){var e,t=pe.getInstance(),i=null===(e=t.coreAPIs)||void 0===e?void 0:e.logger,a=Is();if(ks!==a){var o;null==i||i.trace("recordPageview -- current path differs from last path",{lastPageviewPath:ks,currentPageviewPath:a}),null===(o=t.coreAPIs)||void 0===o||o.flushEventQueue();var u=ks;ks=a;var s=u&&un(u),c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:jt(!1)},s&&{previous_page:s});n.g.setTimeout((function(){var e;null===(e=t.coreAPIs)||void 0===e||e.createNewPageview(c)}),0)}},Es=function(){var e;(null===(e=pe.getInstance().coreAPIs)||void 0===e?void 0:e.getConfig().disablePageviewAutocapture)||(!function(){if(history.heappushstate=history.heapreplacestate=Ss,window.history.pushState){var e=function(e,t,n){var r=e[t];e[t]=function(){var t=r.apply(e,arguments);return D(e[n])&&e[n](),t}};e(window.history,"pushState","heappushstate"),e(window.history,"replaceState","heapreplacestate")}}(),window.addEventListener("popstate",Ss,!0),window.addEventListener("hashchange",Ss,!0))},Os=function(){var e,t=null===(e=pe.getInstance().coreAPIs)||void 0===e?void 0:e.getConfig();return((null==t?void 0:t.customEvents)||[]).filter((function(e){return e&&!["click","change","submit"].includes(e)}))};function Ts(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return As(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return As(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function As(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ps=function e(t){var n=[];if(t.shadowRoot){n.push(t.shadowRoot);var r,i=Ts(t.shadowRoot.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;n=n.concat(e(a))}}catch(e){i.e(e)}finally{i.f()}}var o,u=Ts(t.children);try{for(u.s();!(o=u.n()).done;){var s=o.value;n=n.concat(e(s))}}catch(e){u.e(e)}finally{u.f()}return n},Ns=function(e){try{if(!e)return!0;for(var t=e;t;){if("BODY"===t.tagName||"HTML"===t.tagName)return!1;if(En(t.parentNode)){if("open"!==t.parentNode.mode)return!0;t=t.parentNode.host}else t=t.parentElement}return!0}catch(e){var n,r;return null===(n=pe.getInstance().coreAPIs)||void 0===n||null===(r=n.logger)||void 0===r||r.error("Failed to determine closed context, defaulting to no capture"),!0}},Rs=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=rs("change"),i=rs("submit"),a=rs("click"),o=Ps(document.body).filter((function(e){return!n.includes(e)}));null===(e=pe.getInstance().coreAPIs)||void 0===e||null===(t=e.logger)||void 0===t||t.trace("attaching event listeners on shadow roots",{openShadowRoots:o});var u=Os();return o.forEach((function(e){try{r||e.addEventListener("change",ts,!0),i||e.addEventListener("submit",ws,!0),a||e.addEventListener("click",ms,!0),u.forEach((function(t){e.addEventListener(t,ns,!0)}))}catch(e){var t,n;null===(t=pe.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM error attaching event listeners",{e:e})}})),o},js=function(){var e,t=rs("change"),n=rs("submit"),r=rs("click"),i=Os(),a=function(){var e=HTMLElement.prototype.attachShadow;HTMLElement.prototype.attachShadow=function(){for(var a=this,o=arguments.length,u=new Array(o),s=0;s<o;s++)u[s]=arguments[s];var c=e.apply(this,u);if(this.shadowRoot&&"open"===this.shadowRoot.mode){var f=function(e){var t,n;Ns(e.target)?null===(t=pe.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping custom ".concat(e.type," event listener")):ns(e)};try{t||this.shadowRoot.addEventListener("change",(function(e){var t,n;Ns(e.target)?null===(t=pe.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping change event listener"):ts(e)}),!0),n||this.shadowRoot.addEventListener("submit",(function(e){var t,n;Ns(e.target)?null===(t=pe.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping submit event listener"):ws(e)}),!0),r||this.shadowRoot.addEventListener("click",(function(e){var t,n;Ns(e.target)?null===(t=pe.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping click event listener"):ms(e)}),!0),i.forEach((function(e){a.shadowRoot.addEventListener(e,f,!0)}))}catch(e){var l,d;null===(l=pe.getInstance().coreAPIs)||void 0===l||null===(d=l.logger)||void 0===d||d.trace("Shadow DOM error attaching event listeners",{e:e})}}return c}};if(null===(e=pe.getInstance().coreAPIs)||void 0===e?void 0:e.getConfig().salesforceAura){var o=[],u=!1,s=function(){var e=Rs(o);o=[].concat(h(o),h(e))},c=window.setInterval((function(){var e,t;HTMLElement.prototype.attachShadow.toString().includes("[native code]")||(null===(e=pe.getInstance().coreAPIs)||void 0===e||null===(t=e.logger)||void 0===t||t.trace("SFAura -- attachShadow overwritten for SFAura, overriding with heap handlers"),window.clearInterval(f),window.clearInterval(c),s(),a(),u=!0)}),200),f=window.setInterval(s,400);window.setTimeout((function(){var e,t,n,r;(window.clearInterval(f),window.clearInterval(c),u)?null===(e=pe.getInstance().coreAPIs)||void 0===e||null===(t=e.logger)||void 0===t||t.trace("SFAura -- 7 seconds passed but handler has been attached, nooping"):(null===(n=pe.getInstance().coreAPIs)||void 0===n||null===(r=n.logger)||void 0===r||r.trace("SFAura -- 7 seconds passed, clearing interval and attaching heap handler"),s(),a())}),7e3)}else Rs(),a()},Cs=function(){if(window.auryc&&!window._uxa){var e,t=(new Date).getTime();null===(e=pe.getInstance().coreAPIs)||void 0===e||e.updateLastEventTime(t)}},Bs=function(){["mousemove","mouseup","mousedown","keydown","keypress","keyup","mouseenter","scroll","resize","dblclick","touchstart","touchmove","touchend","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave"].forEach((function(e){try{window.addEventListener(e,(n=Cs,r=3e4,i=!1,function(){if(!i){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];n.apply(void 0,t),i=!0,window.setTimeout((function(){i=!1}),r)}}),!0)}catch(n){var t;null===(t=pe.getInstance().coreAPIs)||void 0===t||t.logger.warn("Autocapture -- Adding session replay event listener failed for ".concat(e))}var n,r,i}))},xs=function(e){pe.getInstance().setAPIDependencies(e),rs(is)||window.addEventListener(is,ts,!0),rs(gs)||window.addEventListener(gs,ms,!0),rs(ys)||window.addEventListener(ys,ws,!0),function(){if(us()){var e,t=(null===(e=pe.getInstance().coreAPIs)||void 0===e?void 0:e.flushQueueOnUnload)||function(){};addEventListener("blur",t,!0),addEventListener("pagehide",t,!0),bs(document),addEventListener("DOMNodeInserted",(function(e){bs(e.target)}),!1)}}(),Es(),Os().forEach((function(e){window.addEventListener(e,ns,!0)})),js(),Bs()},Ds=["onReady","identify","addUserProperties"];window.heap.appid||(window.heap=vu,window.heap.addAdapter({name:"autocapture",fn:xs},{isBlocking:!1}),function(){var e=window.heapReadyCb;if(e){var t=e.find((function(e){return"init"===e.name}));if(t&&e.splice(e.indexOf(t),1),e.length>0){var n=Oe.getInstance();e.forEach((function(e){Ds.includes(e.name)?n.enqueueOnReady(e):n.enqueueHeapApi(e)})),window.heapReadyCb=[]}t&&t.fn()}}())}()}();